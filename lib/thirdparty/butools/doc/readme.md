How to add new functions and packages to BuTools
================================================

1.  Write the implementation for all three supported mathematical frameworks, without any documentation
    (the parametrization of the functions should be the same)
2.  In Mathematica, dont forget to add the `MyNewFunction::usage="";` line at the top of the .m file
    (It should be empty as the help string will be generated automatically later)
3.  If the python implementation is in a separate file, dont forget to import it in the `__init__.py`
    file of the corresponding package
4.  Write the documentation of the new function and add it to the `doc/rawsource` directory (you find 
    many sample files there, the format is self-explanatory). Do not add examples to the documentation in 
    this step!
5.  Find the .rst file of the corresponding *package* in the `doc/source` directory (starts with a small letter!),
    insert your new function into the list, add a single-line description below, finally, at the bottom of the file
    add a reference to your new file which you added into `doc/rawsource`
6.  Write test cases by extending the test file of the corresponding package (ending with .test) in the `test` 
    directory. You find many samples there to explore the syntax. These test cases will serve as examples for 
    your new function as well.
7.  Run the gentests tool in the test directory by calling `python gentests.py all` or `python gentests.py mypackage.test`
8.  This script will update the test scripts in the `test/testpackages` directory and the scripts in the `test/gendocex`
    directory.
9.  Run these scripts. If the one in `test/testpackages` does not give and assertation error, you can proceed. The script
    in `test/gendocex` must be executed, which generates a docex file in the `test/docex` directory (this will the appended 
    to the documentation of the function as usage example later).

    To execute these scripts, the GUI of the mathematical tools are not needed. To run the test for the Python 
    implementation just run

    > python test_mypackage.py

    To execute the mathematica test at command line write

    > math -script test_mypackage.ma

    Finally, the Matlab version can be executed by 

    > matlab -nodesktop -nosplash -r "test_mypackage; exit;"
    
10. Re-build the documentation by running `python autofundoc.py` in the `doc` directory. This will do three things. It 
    parses all files in `doc/rawsources`, and adds the usage examples from `test/docex`, the result is written to 
    `doc/sources`. Then, the single-line description of the functions is copied to the Mathematica packages as help strings.
    The doc strings for both the Matlab and Python implementations are also generated by this script and inserted to the
    appropriate place into the implementations.
11. Run sphinx to obtain the html format documentation by executing in the `doc` directory the line

    > sphinx-build -b html source/ build/html

How to release a new version of BuTools
=======================================

1.  Convert the demo .ipynb files to html by calling

    > jupyter nbconvert --to html --template=btdemoconv.tpl demo_package.ipynb

2.  Update and copy the content of the `webpage` directory to the `public_html`
3.  Change the permission of the demo html files by adding "read" right to everybody 
    and copy these files to `public_html` as well
4.  Re-build the documentation by `shinx-build` (see above)
5.  Create a `doc` directory in public_html and copy the documentation there from 
    `doc/build/html` 
6.  Put the release package (.zip) to `public_html` and update the link in the webpage files
7.  Done.

