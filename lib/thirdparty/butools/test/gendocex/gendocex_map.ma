ClearAll["Global`*"]
AppendTo[$Path,"/home/gabor/github/butools/Mathematica"];
<<BuTools`
Print["---BuTools: MAP package test file---"//OutputForm];
Print["Enable the verbose messages with the BuToolsVerbose flag"//OutputForm];
BuTools`Verbose = True;
Print["Enable input parameter checking with the BuToolsCheckInput flag"//OutputForm];
BuTools`CheckInput = true;
On[Assert];
tmpOut = $Output;
stream = OpenWrite["/home/gabor/github/butools/test/docex/MAP_mathematica.docex", FormatType -> InputForm, PageWidth -> Infinity];
$Output = {stream};
Unprotect[Print];
Print[args___] := Block[{$inMsg = True, result, str},
   If[MatrixQ[args],
       str = "{";
       Do[str = StringJoin[str, ToString[args[[r]], FormatType -> InputForm]]; 
            If[r < Length[args], str = StringJoin[str, ",\n "]], {r, Length[args]}];
            str = StringJoin[str, "}"];
            Print[str//OutputForm],
            result = Print[args],
            result = Print[args]
        ]] /; ! TrueQ[$inMsg];
Print["=== MarginalDistributionFromMAP ==="]
Print[">>> D0 = {{-0.17, 0, 0, 0.07},{0.01, -0.78, 0.03, 0.08},{0.22, 0.17, -1.1, 0.02},{0.04, 0.12, 0, -0.42}};"//OutputForm];
D0 = {{-0.17, 0, 0, 0.07},{0.01, -0.78, 0.03, 0.08},{0.22, 0.17, -1.1, 0.02},{0.04, 0.12, 0, -0.42}};
Print[">>> D1 = {{0, 0.06, 0, 0.04},{0.04, 0.19, 0.21, 0.22},{0.22, 0.13, 0.15, 0.19},{0.05, 0, 0.17, 0.04}};"//OutputForm];
D1 = {{0, 0.06, 0, 0.04},{0.04, 0.19, 0.21, 0.22},{0.22, 0.13, 0.15, 0.19},{0.05, 0, 0.17, 0.04}};
Print[">>> {a, A} = MarginalDistributionFromMAP[D0, D1];"//OutputForm];
{a, A} = MarginalDistributionFromMAP[D0, D1];
Print[">>> Print[a];"//OutputForm];
Print[a];
Print[">>> Print[A];"//OutputForm];
Print[A];
Print["=== MarginalMomentsFromMAP ==="]
Print[">>> D0 = {{-0.17, 0, 0, 0.07},{0.01, -0.78, 0.03, 0.08},{0.22, 0.17, -1.1, 0.02},{0.04, 0.12, 0, -0.42}};"//OutputForm];
D0 = {{-0.17, 0, 0, 0.07},{0.01, -0.78, 0.03, 0.08},{0.22, 0.17, -1.1, 0.02},{0.04, 0.12, 0, -0.42}};
Print[">>> D1 = {{0, 0.06, 0, 0.04},{0.04, 0.19, 0.21, 0.22},{0.22, 0.13, 0.15, 0.19},{0.05, 0, 0.17, 0.04}};"//OutputForm];
D1 = {{0, 0.06, 0, 0.04},{0.04, 0.19, 0.21, 0.22},{0.22, 0.13, 0.15, 0.19},{0.05, 0, 0.17, 0.04}};
Print[">>> moms = MarginalMomentsFromMAP[D0, D1];"//OutputForm];
moms = MarginalMomentsFromMAP[D0, D1];
Print[">>> Print[moms];"//OutputForm];
Print[moms];
Print["=== MarginalDistributionFromRAP ==="]
Print[">>> H0 = {{-2, 0, 0},{0, -3, 1},{0, -1, -2}};"//OutputForm];
H0 = {{-2, 0, 0},{0, -3, 1},{0, -1, -2}};
Print[">>> H1 = {{1.8, 0.2, 0},{0.2, 1.8, 0},{0.2, 1.8, 1}};"//OutputForm];
H1 = {{1.8, 0.2, 0},{0.2, 1.8, 0},{0.2, 1.8, 1}};
Print[">>> {a, A} = MarginalDistributionFromRAP[H0, H1];"//OutputForm];
{a, A} = MarginalDistributionFromRAP[H0, H1];
Print[">>> Print[a];"//OutputForm];
Print[a];
Print[">>> Print[A];"//OutputForm];
Print[A];
Print["=== MarginalMomentsFromRAP ==="]
Print[">>> H0 = {{-2., 0, 0},{0, -3., 1.},{0, -1., -2.}};"//OutputForm];
H0 = {{-2., 0, 0},{0, -3., 1.},{0, -1., -2.}};
Print[">>> H1 = {{1.8, 0.2, 0},{0.2, 1.8, 0},{0.2, 1.8, 1.}};"//OutputForm];
H1 = {{1.8, 0.2, 0},{0.2, 1.8, 0},{0.2, 1.8, 1.}};
Print[">>> moms = MarginalMomentsFromRAP[H0, H1];"//OutputForm];
moms = MarginalMomentsFromRAP[H0, H1];
Print[">>> Print[moms];"//OutputForm];
Print[moms];
Print["=== MarginalDistributionFromMMAP ==="]
Print[">>> D0 = {{-1.78, 0.29},{0.07, -0.92}};"//OutputForm];
D0 = {{-1.78, 0.29},{0.07, -0.92}};
Print[">>> D1 = {{0.15, 0.49},{0.23, 0.36}};"//OutputForm];
D1 = {{0.15, 0.49},{0.23, 0.36}};
Print[">>> D2 = {{0.11, 0.2},{0.01, 0}};"//OutputForm];
D2 = {{0.11, 0.2},{0.01, 0}};
Print[">>> D3 = {{0.14, 0.4},{0.11, 0.14}};"//OutputForm];
D3 = {{0.14, 0.4},{0.11, 0.14}};
Print[">>> {a, A} = MarginalDistributionFromMMAP[{D0, D1, D2, D3}];"//OutputForm];
{a, A} = MarginalDistributionFromMMAP[{D0, D1, D2, D3}];
Print[">>> Print[a];"//OutputForm];
Print[a];
Print[">>> Print[A];"//OutputForm];
Print[A];
Print["=== MarginalMomentsFromMMAP ==="]
Print[">>> D0 = {{-1.78, 0.29},{0.07, -0.92}};"//OutputForm];
D0 = {{-1.78, 0.29},{0.07, -0.92}};
Print[">>> D1 = {{0.15, 0.49},{0.23, 0.36}};"//OutputForm];
D1 = {{0.15, 0.49},{0.23, 0.36}};
Print[">>> D2 = {{0.11, 0.2},{0.01, 0}};"//OutputForm];
D2 = {{0.11, 0.2},{0.01, 0}};
Print[">>> D3 = {{0.14, 0.4},{0.11, 0.14}};"//OutputForm];
D3 = {{0.14, 0.4},{0.11, 0.14}};
Print[">>> moms = MarginalMomentsFromMMAP[{D0, D1, D2, D3}];"//OutputForm];
moms = MarginalMomentsFromMMAP[{D0, D1, D2, D3}];
Print[">>> Print[moms];"//OutputForm];
Print[moms];
Print["=== MarginalDistributionFromMRAP ==="]
Print[">>> x = 0.18;"//OutputForm];
x = 0.18;
Print[">>> H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};"//OutputForm];
H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};
Print[">>> H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};"//OutputForm];
H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};
Print[">>> H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};"//OutputForm];
H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};
Print[">>> {a, A} = MarginalDistributionFromMRAP[{H0, H1, H2}];"//OutputForm];
{a, A} = MarginalDistributionFromMRAP[{H0, H1, H2}];
Print[">>> Print[a];"//OutputForm];
Print[a];
Print[">>> Print[A];"//OutputForm];
Print[A];
Print["=== MarginalMomentsFromMRAP ==="]
Print[">>> x = 0.18;"//OutputForm];
x = 0.18;
Print[">>> H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};"//OutputForm];
H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};
Print[">>> H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};"//OutputForm];
H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};
Print[">>> H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};"//OutputForm];
H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};
Print[">>> moms = MarginalMomentsFromMRAP[{H0, H1, H2}];"//OutputForm];
moms = MarginalMomentsFromMRAP[{H0, H1, H2}];
Print[">>> Print[moms];"//OutputForm];
Print[moms];
Print["=== LagCorrelationsFromMAP ==="]
Print[">>> D0 = {{-5., 0, 1., 1.},{1., -8., 1., 0},{1., 0, -4., 1.},{1., 2., 3., -9.}};"//OutputForm];
D0 = {{-5., 0, 1., 1.},{1., -8., 1., 0},{1., 0, -4., 1.},{1., 2., 3., -9.}};
Print[">>> D1 = {{0, 1., 0, 2.},{2., 1., 3., 0},{0, 0, 1., 1.},{1., 1., 0, 1.}};"//OutputForm];
D1 = {{0, 1., 0, 2.},{2., 1., 3., 0},{0, 0, 1., 1.},{1., 1., 0, 1.}};
Print[">>> corr = LagCorrelationsFromMAP[D0, D1, 3];"//OutputForm];
corr = LagCorrelationsFromMAP[D0, D1, 3];
Print[">>> Print[corr];"//OutputForm];
Print[corr];
Print["=== LagCorrelationsFromRAP ==="]
Print[">>> H0 = {{-2., 0, 0},{0, -3., 1.},{0, -1., -2.}};"//OutputForm];
H0 = {{-2., 0, 0},{0, -3., 1.},{0, -1., -2.}};
Print[">>> H1 = {{1.8, 0.2, 0},{0.2, 1.8, 0},{0.2, 1.8, 1.}};"//OutputForm];
H1 = {{1.8, 0.2, 0},{0.2, 1.8, 0},{0.2, 1.8, 1.}};
Print[">>> corr = LagCorrelationsFromRAP[H0, H1, 3];"//OutputForm];
corr = LagCorrelationsFromRAP[H0, H1, 3];
Print[">>> Print[corr];"//OutputForm];
Print[corr];
Print["=== LagkJointMomentsFromMAP ==="]
Print[">>> D0 = {{-5., 0, 1., 1.},{1., -8., 1., 0},{1., 0, -4., 1.},{1., 2., 3., -9.}};"//OutputForm];
D0 = {{-5., 0, 1., 1.},{1., -8., 1., 0},{1., 0, -4., 1.},{1., 2., 3., -9.}};
Print[">>> D1 = {{0, 1., 0, 2.},{2., 1., 3., 0},{0, 0, 1., 1.},{1., 1., 0, 1.}};"//OutputForm];
D1 = {{0, 1., 0, 2.},{2., 1., 3., 0},{0, 0, 1., 1.},{1., 1., 0, 1.}};
Print[">>> Nm = LagkJointMomentsFromMAP[D0, D1, 4, 1];"//OutputForm];
Nm = LagkJointMomentsFromMAP[D0, D1, 4, 1];
Print[">>> Print[Nm];"//OutputForm];
Print[Nm];
Print[">>> moms = MarginalMomentsFromMAP[D0, D1, 4];"//OutputForm];
moms = MarginalMomentsFromMAP[D0, D1, 4];
Print[">>> Print[moms];"//OutputForm];
Print[moms];
Print[">>> cjm = Table[0,{3}];"//OutputForm];
cjm = Table[0,{3}];
Print[">>> Do["//OutputForm];
Print[">>>     Nx = LagkJointMomentsFromMAP[D0, D1, 1, i];"//OutputForm];
Print[">>>     cjm[[i]] = (Nx[[2, 2]]-moms[[1]]^2)/(moms[[2]]-moms[[1]]^2);"//OutputForm];
Print[">>> , {i,1,3,1}];"//OutputForm];
Do[
    Nx = LagkJointMomentsFromMAP[D0, D1, 1, i];
    cjm[[i]] = (Nx[[2, 2]]-moms[[1]]^2)/(moms[[2]]-moms[[1]]^2);
, {i,1,3,1}];
Print[">>> Print[cjm];"//OutputForm];
Print[cjm];
Print[">>> corr = LagCorrelationsFromMAP[D0, D1, 3];"//OutputForm];
corr = LagCorrelationsFromMAP[D0, D1, 3];
Print[">>> Print[corr];"//OutputForm];
Print[corr];
mNm1 = Flatten[Nm[[1, 2;;-1]]];
mNm2 = Flatten[Nm[[2;;-1, 1]]];
Print["=== LagkJointMomentsFromRAP ==="]
Print[">>> H0 = {{-2., 0, 0},{0, -3., 1.},{0, -1., -2.}};"//OutputForm];
H0 = {{-2., 0, 0},{0, -3., 1.},{0, -1., -2.}};
Print[">>> H1 = {{1.8, 0.2, 0},{0.2, 1.8, 0},{0.2, 1.8, 1.}};"//OutputForm];
H1 = {{1.8, 0.2, 0},{0.2, 1.8, 0},{0.2, 1.8, 1.}};
Print[">>> Nm = LagkJointMomentsFromRAP[H0, H1, 4, 1];"//OutputForm];
Nm = LagkJointMomentsFromRAP[H0, H1, 4, 1];
Print[">>> Print[Length[Nm]];"//OutputForm];
Print[Length[Nm]];
Print[">>> moms = MarginalMomentsFromRAP[H0, H1, 4];"//OutputForm];
moms = MarginalMomentsFromRAP[H0, H1, 4];
Print[">>> Print[moms];"//OutputForm];
Print[moms];
Print[">>> cjm = Table[0,{3}];"//OutputForm];
cjm = Table[0,{3}];
Print[">>> Do["//OutputForm];
Print[">>>     Nx = LagkJointMomentsFromRAP[H0, H1, 1, i];"//OutputForm];
Print[">>>     cjm[[i]] = (Nx[[2, 2]]-moms[[1]]^2)/(moms[[2]]-moms[[1]]^2);"//OutputForm];
Print[">>> , {i,1,3,1}];"//OutputForm];
Do[
    Nx = LagkJointMomentsFromRAP[H0, H1, 1, i];
    cjm[[i]] = (Nx[[2, 2]]-moms[[1]]^2)/(moms[[2]]-moms[[1]]^2);
, {i,1,3,1}];
Print[">>> Print[cjm];"//OutputForm];
Print[cjm];
Print[">>> corr = LagCorrelationsFromRAP[H0, H1, 3];"//OutputForm];
corr = LagCorrelationsFromRAP[H0, H1, 3];
Print[">>> Print[corr];"//OutputForm];
Print[corr];
mNm1 = Flatten[Nm[[1, 2;;-1]]];
mNm2 = Flatten[Nm[[2;;-1, 1]]];
Print["=== LagkJointMomentsFromMMAP ==="]
Print[">>> D0 = {{-1.78, 0.29},{0.07, -0.92}};"//OutputForm];
D0 = {{-1.78, 0.29},{0.07, -0.92}};
Print[">>> D1 = {{0.15, 0.49},{0.23, 0.36}};"//OutputForm];
D1 = {{0.15, 0.49},{0.23, 0.36}};
Print[">>> D2 = {{0.11, 0.2},{0.01, 0}};"//OutputForm];
D2 = {{0.11, 0.2},{0.01, 0}};
Print[">>> D3 = {{0.14, 0.4},{0.11, 0.14}};"//OutputForm];
D3 = {{0.14, 0.4},{0.11, 0.14}};
Print[">>> Nm = LagkJointMomentsFromMMAP[{D0, D1, D2, D3}, 3, 1];"//OutputForm];
Nm = LagkJointMomentsFromMMAP[{D0, D1, D2, D3}, 3, 1];
Print[">>> Print[Nm[[1]]];"//OutputForm];
Print[Nm[[1]]];
Print[">>> Print[Nm[[2]]];"//OutputForm];
Print[Nm[[2]]];
Print[">>> Print[Nm[[3]]];"//OutputForm];
Print[Nm[[3]]];
Print["=== LagkJointMomentsFromMRAP ==="]
Print[">>> x = 0.18;"//OutputForm];
x = 0.18;
Print[">>> H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};"//OutputForm];
H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};
Print[">>> H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};"//OutputForm];
H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};
Print[">>> H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};"//OutputForm];
H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};
Print[">>> Nm = LagkJointMomentsFromMRAP[{H0, H1, H2}, 3, 2];"//OutputForm];
Nm = LagkJointMomentsFromMRAP[{H0, H1, H2}, 3, 2];
Print[">>> Print[Nm[[1]]];"//OutputForm];
Print[Nm[[1]]];
Print[">>> Print[Nm[[2]]];"//OutputForm];
Print[Nm[[2]]];
Print["=== RandomMAP ==="]
Print[">>> {D0, D1} = RandomMAP[4, 1.62, 10];"//OutputForm];
{D0, D1} = RandomMAP[4, 1.62, 10];
Print[">>> Print[D0];"//OutputForm];
Print[D0];
Print[">>> Print[D1];"//OutputForm];
Print[D1];
Print[">>> m = MarginalMomentsFromMAP[D0, D1, 1][[1]];"//OutputForm];
m = MarginalMomentsFromMAP[D0, D1, 1][[1]];
Print[">>> Print[m];"//OutputForm];
Print[m];
Print["=== RandomMMAP ==="]
Print[">>> Dm = RandomMMAP[4, 3, 1.62, 10];"//OutputForm];
Dm = RandomMMAP[4, 3, 1.62, 10];
Print[">>> Print[Dm[[1]]];"//OutputForm];
Print[Dm[[1]]];
Print[">>> Print[Dm[[2]]];"//OutputForm];
Print[Dm[[2]]];
Print[">>> Print[Dm[[3]]];"//OutputForm];
Print[Dm[[3]]];
Print[">>> Print[Dm[[4]]];"//OutputForm];
Print[Dm[[4]]];
Print[">>> m = MarginalMomentsFromMMAP[Dm, 1][[1]];"//OutputForm];
m = MarginalMomentsFromMMAP[Dm, 1][[1]];
Print[">>> Print[m];"//OutputForm];
Print[m];
Print["=== CheckMAPRepresentation ==="]
Print[">>> D0 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.}};"//OutputForm];
D0 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.}};
Print[">>> D1 = {{-1., 0, 1., 0},{0, -2., 0, 1.},{1., 0, -3., 0},{1., 2., 2., 1.}};"//OutputForm];
D1 = {{-1., 0, 1., 0},{0, -2., 0, 1.},{1., 0, -3., 0},{1., 2., 2., 1.}};
Print[">>> flag = CheckMAPRepresentation[D0, D1];"//OutputForm];
flag = CheckMAPRepresentation[D0, D1];
Print[">>> Print[flag];"//OutputForm];
Print[flag];
Print[">>> D0 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.}};"//OutputForm];
D0 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.}};
Print[">>> D1 = {{1., 0, 1.},{0, 2., 0},{1., 0, 3.}};"//OutputForm];
D1 = {{1., 0, 1.},{0, 2., 0},{1., 0, 3.}};
Print[">>> flag = CheckMAPRepresentation[D0, D1];"//OutputForm];
flag = CheckMAPRepresentation[D0, D1];
Print[">>> Print[flag];"//OutputForm];
Print[flag];
Print[">>> D0 = {{-3., 0, 1.},{0, -2., 0},{1., 0, -5.}};"//OutputForm];
D0 = {{-3., 0, 1.},{0, -2., 0},{1., 0, -5.}};
Print[">>> D1 = {{1., 0, 1.},{0, 2., 0},{1., 0, 3.}};"//OutputForm];
D1 = {{1., 0, 1.},{0, 2., 0},{1., 0, 3.}};
Print[">>> flag = CheckMAPRepresentation[D0, D1];"//OutputForm];
flag = CheckMAPRepresentation[D0, D1];
Print[">>> Print[flag];"//OutputForm];
Print[flag];
Print["=== CheckRAPRepresentation ==="]
Print[">>> H0 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.},{1., 2., 2.}};"//OutputForm];
H0 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.},{1., 2., 2.}};
Print[">>> H1 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.},{1., 2., 2.}};"//OutputForm];
H1 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.},{1., 2., 2.}};
Print[">>> flag = CheckRAPRepresentation[H0, H1];"//OutputForm];
flag = CheckRAPRepresentation[H0, H1];
Print[">>> Print[flag];"//OutputForm];
Print[flag];
Print[">>> H0 = {{-1., 0, 2.},{0, 2., 0},{1., 0, -3.}};"//OutputForm];
H0 = {{-1., 0, 2.},{0, 2., 0},{1., 0, -3.}};
Print[">>> H1 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.}};"//OutputForm];
H1 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.}};
Print[">>> flag = CheckRAPRepresentation[H0, H1];"//OutputForm];
flag = CheckRAPRepresentation[H0, H1];
Print[">>> Print[flag];"//OutputForm];
Print[flag];
Print[">>> H0 = {{-1., 0, 0},{0, -2., 2.},{0, 3., -3.}};"//OutputForm];
H0 = {{-1., 0, 0},{0, -2., 2.},{0, 3., -3.}};
Print[">>> H1 = {{0, 0, 1.},{0, -1., 1.},{1., 0, -1.}};"//OutputForm];
H1 = {{0, 0, 1.},{0, -1., 1.},{1., 0, -1.}};
Print[">>> flag = CheckRAPRepresentation[H0, H1];"//OutputForm];
flag = CheckRAPRepresentation[H0, H1];
Print[">>> Print[flag];"//OutputForm];
Print[flag];
Print[">>> H0 = {{-2., 0, 0},{0, -1., 1.},{0, -1., -1.}};"//OutputForm];
H0 = {{-2., 0, 0},{0, -1., 1.},{0, -1., -1.}};
Print[">>> H1 = {{1., 0, 1.},{0, 1., -1.},{1., 0, 1.}};"//OutputForm];
H1 = {{1., 0, 1.},{0, 1., -1.},{1., 0, 1.}};
Print[">>> flag = CheckRAPRepresentation[H0, H1];"//OutputForm];
flag = CheckRAPRepresentation[H0, H1];
Print[">>> Print[flag];"//OutputForm];
Print[flag];
Print[">>> H0 = {{-1., 0, 0},{0, -2., 1.},{0, -1., -2.}};"//OutputForm];
H0 = {{-1., 0, 0},{0, -2., 1.},{0, -1., -2.}};
Print[">>> H1 = {{1., 0, 0},{0, 1., 0},{1., 1., 1.}};"//OutputForm];
H1 = {{1., 0, 0},{0, 1., 0},{1., 1., 1.}};
Print[">>> flag = CheckRAPRepresentation[H0, H1];"//OutputForm];
flag = CheckRAPRepresentation[H0, H1];
Print[">>> Print[flag];"//OutputForm];
Print[flag];
Print["=== CheckMMAPRepresentation ==="]
Print[">>> D0 = {{-1.05, 0.03, 0.07},{0.19, -1.63, 0.06},{0, 0.2, -1.03}};"//OutputForm];
D0 = {{-1.05, 0.03, 0.07},{0.19, -1.63, 0.06},{0, 0.2, -1.03}};
Print[">>> D1 = {{0.16, 0.11, 0},{0.1, 0.16, 0},{0.27, 0, 0.19}};"//OutputForm];
D1 = {{0.16, 0.11, 0},{0.1, 0.16, 0},{0.27, 0, 0.19}};
Print[">>> D2 = {{0.01, 0.09, 0.13},{0.26, 0.21, 0.05},{0, 0.16, 0.07}};"//OutputForm];
D2 = {{0.01, 0.09, 0.13},{0.26, 0.21, 0.05},{0, 0.16, 0.07}};
Print[">>> D3 = {{0.19, 0.06, 0.2},{0.17, 0.16, 0.27},{0, 0, 0.14}};"//OutputForm];
D3 = {{0.19, 0.06, 0.2},{0.17, 0.16, 0.27},{0, 0, 0.14}};
Print[">>> flag = CheckMMAPRepresentation[{D0, D1, D2, D3}];"//OutputForm];
flag = CheckMMAPRepresentation[{D0, D1, D2, D3}];
Print[">>> Print[flag];"//OutputForm];
Print[flag];
Print["=== CheckMRAPRepresentation ==="]
Print[">>> x = 0.18;"//OutputForm];
x = 0.18;
Print[">>> H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};"//OutputForm];
H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};
Print[">>> H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};"//OutputForm];
H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};
Print[">>> H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};"//OutputForm];
H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};
Print[">>> flag = CheckMRAPRepresentation[{H0, H1, H2}];"//OutputForm];
flag = CheckMRAPRepresentation[{H0, H1, H2}];
Print[">>> Print[flag];"//OutputForm];
Print[flag];
Print["=== RAPFromMoments ==="]
Print[">>> G0 = {{-6.2, 2., 0.},{2., -9., 1.},{1., 0, -3.}};"//OutputForm];
G0 = {{-6.2, 2., 0.},{2., -9., 1.},{1., 0, -3.}};
Print[">>> G1 = {{2.2, -2., 4.},{2., 2., 2.},{1., 0, 1.}};"//OutputForm];
G1 = {{2.2, -2., 4.},{2., 2., 2.},{1., 0, 1.}};
Print[">>> moms = MarginalMomentsFromRAP[G0, G1, 5];"//OutputForm];
moms = MarginalMomentsFromRAP[G0, G1, 5];
Print[">>> Print[moms];"//OutputForm];
Print[moms];
Print[">>> Nm = LagkJointMomentsFromRAP[G0, G1, 2, 1];"//OutputForm];
Nm = LagkJointMomentsFromRAP[G0, G1, 2, 1];
Print[">>> Print[Nm];"//OutputForm];
Print[Nm];
Print[">>> {H0, H1} = RAPFromMoments[moms, Nm];"//OutputForm];
{H0, H1} = RAPFromMoments[moms, Nm];
Print[">>> Print[H0];"//OutputForm];
Print[H0];
Print[">>> Print[H1];"//OutputForm];
Print[H1];
Print[">>> rmoms = MarginalMomentsFromRAP[H0, H1, 5];"//OutputForm];
rmoms = MarginalMomentsFromRAP[H0, H1, 5];
Print[">>> Print[rmoms];"//OutputForm];
Print[rmoms];
Print[">>> rNm = LagkJointMomentsFromRAP[H0, H1, 2, 1];"//OutputForm];
rNm = LagkJointMomentsFromRAP[H0, H1, 2, 1];
Print[">>> Print[rNm];"//OutputForm];
Print[rNm];
Print[">>> G0 = {{-5., 0, 1., 1.},{1., -8., 1., 0},{1., 0, -4., 1.},{1., 2., 3., -9.}};"//OutputForm];
G0 = {{-5., 0, 1., 1.},{1., -8., 1., 0},{1., 0, -4., 1.},{1., 2., 3., -9.}};
Print[">>> G1 = {{0, 1., 0, 2.},{2., 1., 3., 0},{0, 0, 1., 1.},{1., 1., 0, 1.}};"//OutputForm];
G1 = {{0, 1., 0, 2.},{2., 1., 3., 0},{0, 0, 1., 1.},{1., 1., 0, 1.}};
Print[">>> moms = MarginalMomentsFromRAP[G0, G1, 7];"//OutputForm];
moms = MarginalMomentsFromRAP[G0, G1, 7];
Print[">>> Print[moms];"//OutputForm];
Print[moms];
Print[">>> Nm = LagkJointMomentsFromRAP[G0, G1, 3, 1];"//OutputForm];
Nm = LagkJointMomentsFromRAP[G0, G1, 3, 1];
Print[">>> Print[Nm];"//OutputForm];
Print[Nm];
Print[">>> {H0, H1} = RAPFromMoments[moms, Nm];"//OutputForm];
{H0, H1} = RAPFromMoments[moms, Nm];
Print[">>> Print[H0];"//OutputForm];
Print[H0];
Print[">>> Print[H1];"//OutputForm];
Print[H1];
Print[">>> BuTools`CheckPrecision = 10.^-8;"//OutputForm];
BuTools`CheckPrecision = 10.^-8;
Print[">>> rmoms = MarginalMomentsFromRAP[H0, H1, 7];"//OutputForm];
rmoms = MarginalMomentsFromRAP[H0, H1, 7];
Print[">>> Print[rmoms];"//OutputForm];
Print[rmoms];
Print[">>> rNm = LagkJointMomentsFromRAP[H0, H1, 3, 1];"//OutputForm];
rNm = LagkJointMomentsFromRAP[H0, H1, 3, 1];
Print[">>> Print[rNm];"//OutputForm];
Print[rNm];
Print["=== MRAPFromMoments ==="]
Print[">>> G0 = {{-1.05, 0.03, 0.07},{0.19, -1.63, 0.06},{0, 0.2, -1.03}};"//OutputForm];
G0 = {{-1.05, 0.03, 0.07},{0.19, -1.63, 0.06},{0, 0.2, -1.03}};
Print[">>> G1 = {{0.16, 0.11, 0},{0.1, 0.16, 0},{0.27, 0, 0.19}};"//OutputForm];
G1 = {{0.16, 0.11, 0},{0.1, 0.16, 0},{0.27, 0, 0.19}};
Print[">>> G2 = {{0.01, 0.09, 0.13},{0.26, 0.21, 0.05},{0, 0.16, 0.07}};"//OutputForm];
G2 = {{0.01, 0.09, 0.13},{0.26, 0.21, 0.05},{0, 0.16, 0.07}};
Print[">>> G3 = {{0.19, 0.06, 0.2},{0.17, 0.16, 0.27},{0, 0, 0.14}};"//OutputForm];
G3 = {{0.19, 0.06, 0.2},{0.17, 0.16, 0.27},{0, 0, 0.14}};
Print[">>> G = {G0, G1, G2, G3};"//OutputForm];
G = {G0, G1, G2, G3};
Print[">>> moms = MarginalMomentsFromMRAP[G, 5];"//OutputForm];
moms = MarginalMomentsFromMRAP[G, 5];
Print[">>> Print[moms];"//OutputForm];
Print[moms];
Print[">>> Nm = LagkJointMomentsFromMRAP[G, 2, 1];"//OutputForm];
Nm = LagkJointMomentsFromMRAP[G, 2, 1];
Print[">>> {Nm1, Nm2, Nm3} = Nm;"//OutputForm];
{Nm1, Nm2, Nm3} = Nm;
Print[">>> Print[Nm1];"//OutputForm];
Print[Nm1];
Print[">>> Print[Nm2];"//OutputForm];
Print[Nm2];
Print[">>> Print[Nm3];"//OutputForm];
Print[Nm3];
Print[">>> H = MRAPFromMoments[moms, Nm];"//OutputForm];
H = MRAPFromMoments[moms, Nm];
Print[">>> Print[H[[1]]];"//OutputForm];
Print[H[[1]]];
Print[">>> Print[H[[2]]];"//OutputForm];
Print[H[[2]]];
Print[">>> Print[H[[3]]];"//OutputForm];
Print[H[[3]]];
Print[">>> Print[H[[4]]];"//OutputForm];
Print[H[[4]]];
Print[">>> BuTools`CheckPrecision = 10.^-10;"//OutputForm];
BuTools`CheckPrecision = 10.^-10;
Print[">>> rmoms = MarginalMomentsFromMRAP[H, 5];"//OutputForm];
rmoms = MarginalMomentsFromMRAP[H, 5];
Print[">>> Print[rmoms];"//OutputForm];
Print[rmoms];
Print[">>> rNm = LagkJointMomentsFromMRAP[H, 2, 1];"//OutputForm];
rNm = LagkJointMomentsFromMRAP[H, 2, 1];
Print[">>> {rNm1, rNm2, rNm3} = rNm;"//OutputForm];
{rNm1, rNm2, rNm3} = rNm;
Print[">>> Print[rNm1];"//OutputForm];
Print[rNm1];
Print[">>> Print[rNm2];"//OutputForm];
Print[rNm2];
Print[">>> Print[rNm3];"//OutputForm];
Print[rNm3];
Print["=== RAPFromMomentsAndCorrelations ==="]
Print[">>> H0 = {{-6.2, 2., 0},{2., -9., 1.},{1., 0, -3.}};"//OutputForm];
H0 = {{-6.2, 2., 0},{2., -9., 1.},{1., 0, -3.}};
Print[">>> H1 = {{2.2, 0, 2.},{0, 4., 2.},{0, 1., 1.}};"//OutputForm];
H1 = {{2.2, 0, 2.},{0, 4., 2.},{0, 1., 1.}};
Print[">>> mom = MarginalMomentsFromRAP[H0, H1];"//OutputForm];
mom = MarginalMomentsFromRAP[H0, H1];
Print[">>> Print[mom];"//OutputForm];
Print[mom];
Print[">>> corr = LagCorrelationsFromRAP[H0, H1, 3];"//OutputForm];
corr = LagCorrelationsFromRAP[H0, H1, 3];
Print[">>> Print[corr];"//OutputForm];
Print[corr];
Print[">>> {G0, G1} = RAPFromMomentsAndCorrelations[mom, corr];"//OutputForm];
{G0, G1} = RAPFromMomentsAndCorrelations[mom, corr];
Print[">>> Print[G0];"//OutputForm];
Print[G0];
Print[">>> Print[G1];"//OutputForm];
Print[G1];
Print[">>> rmom = MarginalMomentsFromRAP[G0, G1];"//OutputForm];
rmom = MarginalMomentsFromRAP[G0, G1];
Print[">>> Print[rmom];"//OutputForm];
Print[rmom];
Print[">>> rcorr = LagCorrelationsFromRAP[G0, G1, 3];"//OutputForm];
rcorr = LagCorrelationsFromRAP[G0, G1, 3];
Print[">>> Print[rcorr];"//OutputForm];
Print[rcorr];
Print["=== MAP2FromMoments ==="]
Print[">>> D0 = {{-14., 1.},{1, -25.}};"//OutputForm];
D0 = {{-14., 1.},{1, -25.}};
Print[">>> D1 = {{6., 7.},{3., 21.}};"//OutputForm];
D1 = {{6., 7.},{3., 21.}};
Print[">>> moms = MarginalMomentsFromMAP[D0, D1, 3];"//OutputForm];
moms = MarginalMomentsFromMAP[D0, D1, 3];
Print[">>> Print[moms];"//OutputForm];
Print[moms];
Print[">>> corr = LagCorrelationsFromMAP[D0, D1, 1][[1]];"//OutputForm];
corr = LagCorrelationsFromMAP[D0, D1, 1][[1]];
Print[">>> Print[corr];"//OutputForm];
Print[corr];
Print[">>> {D0, D1} = MAP2FromMoments[moms, corr];"//OutputForm];
{D0, D1} = MAP2FromMoments[moms, corr];
Print[">>> Print[D0];"//OutputForm];
Print[D0];
Print[">>> Print[D1];"//OutputForm];
Print[D1];
Print[">>> rmoms = MarginalMomentsFromMAP[D0, D1, 3];"//OutputForm];
rmoms = MarginalMomentsFromMAP[D0, D1, 3];
Print[">>> Print[rmoms];"//OutputForm];
Print[rmoms];
Print[">>> rcorr = LagCorrelationsFromMAP[D0, D1, 1][[1]];"//OutputForm];
rcorr = LagCorrelationsFromMAP[D0, D1, 1][[1]];
Print[">>> Print[rcorr];"//OutputForm];
Print[rcorr];
Print["=== MAP2CorrelationBounds ==="]
Print[">>> D0 = {{-14., 1.},{1., -25.}};"//OutputForm];
D0 = {{-14., 1.},{1., -25.}};
Print[">>> D1 = {{6., 7.},{3., 21.}};"//OutputForm];
D1 = {{6., 7.},{3., 21.}};
Print[">>> moms = MarginalMomentsFromMAP[D0, D1, 3];"//OutputForm];
moms = MarginalMomentsFromMAP[D0, D1, 3];
Print[">>> Print[moms];"//OutputForm];
Print[moms];
Print[">>> {lb, ub} = MAP2CorrelationBounds[moms];"//OutputForm];
{lb, ub} = MAP2CorrelationBounds[moms];
Print[">>> Print[lb];"//OutputForm];
Print[lb];
Print[">>> Print[ub];"//OutputForm];
Print[ub];
Print["=== MAPFromFewMomentsAndCorrelations ==="]
Print[">>> moms = {1.1, 6.05};"//OutputForm];
moms = {1.1, 6.05};
Print[">>> corr1 = -0.17;"//OutputForm];
corr1 = -0.17;
Print[">>> {D0, D1} = MAPFromFewMomentsAndCorrelations[moms, corr1];"//OutputForm];
{D0, D1} = MAPFromFewMomentsAndCorrelations[moms, corr1];
Print[">>> Print[D0];"//OutputForm];
Print[D0];
Print[">>> Print[D1];"//OutputForm];
Print[D1];
Print[">>> rmoms = MarginalMomentsFromMAP[D0, D1, 2];"//OutputForm];
rmoms = MarginalMomentsFromMAP[D0, D1, 2];
Print[">>> Print[rmoms];"//OutputForm];
Print[rmoms];
Print[">>> rcorr1 = LagCorrelationsFromMAP[D0, D1, 1][[1]];"//OutputForm];
rcorr1 = LagCorrelationsFromMAP[D0, D1, 1][[1]];
Print[">>> Print[rcorr1];"//OutputForm];
Print[rcorr1];
Print[">>> moms = {1.2, 4.32, 20.};"//OutputForm];
moms = {1.2, 4.32, 20.};
Print[">>> corr1 = -0.4;"//OutputForm];
corr1 = -0.4;
Print[">>> {D0, D1} = MAPFromFewMomentsAndCorrelations[moms, corr1];"//OutputForm];
{D0, D1} = MAPFromFewMomentsAndCorrelations[moms, corr1];
Print[">>> Print[D0];"//OutputForm];
Print[D0];
Print[">>> Print[D1];"//OutputForm];
Print[D1];
Print[">>> BuTools`CheckPrecision = 10.^-12;"//OutputForm];
BuTools`CheckPrecision = 10.^-12;
Print[">>> rmoms = MarginalMomentsFromMAP[D0, D1, 3];"//OutputForm];
rmoms = MarginalMomentsFromMAP[D0, D1, 3];
Print[">>> Print[rmoms];"//OutputForm];
Print[rmoms];
Print[">>> rcorr1 = LagCorrelationsFromMAP[D0, D1, 1][[1]];"//OutputForm];
rcorr1 = LagCorrelationsFromMAP[D0, D1, 1][[1]];
Print[">>> Print[rcorr1];"//OutputForm];
Print[rcorr1];
Print[">>> moms = {1.2, 4.32, 20.};"//OutputForm];
moms = {1.2, 4.32, 20.};
Print[">>> corr1 = 0.4;"//OutputForm];
corr1 = 0.4;
Print[">>> {D0, D1} = MAPFromFewMomentsAndCorrelations[moms, corr1];"//OutputForm];
{D0, D1} = MAPFromFewMomentsAndCorrelations[moms, corr1];
Print[">>> Print[D0];"//OutputForm];
Print[D0];
Print[">>> Print[D1];"//OutputForm];
Print[D1];
Print[">>> rmoms = MarginalMomentsFromMAP[D0, D1, 3];"//OutputForm];
rmoms = MarginalMomentsFromMAP[D0, D1, 3];
Print[">>> Print[rmoms];"//OutputForm];
Print[rmoms];
Print[">>> rcorr1 = LagCorrelationsFromMAP[D0, D1, 1][[1]];"//OutputForm];
rcorr1 = LagCorrelationsFromMAP[D0, D1, 1][[1]];
Print[">>> Print[rcorr1];"//OutputForm];
Print[rcorr1];
Print["=== CanonicalFromMAP2 ==="]
Print[">>> D0 = {{-14., 1.},{1., -25.}};"//OutputForm];
D0 = {{-14., 1.},{1., -25.}};
Print[">>> D1 = {{6., 7.},{3., 21.}};"//OutputForm];
D1 = {{6., 7.},{3., 21.}};
Print[">>> {H0, H1} = CanonicalFromMAP2[D0, D1];"//OutputForm];
{H0, H1} = CanonicalFromMAP2[D0, D1];
Print[">>> Print[H0];"//OutputForm];
Print[H0];
Print[">>> Print[H1];"//OutputForm];
Print[H1];
Print[">>> Cm = SimilarityMatrix[H0, D0];"//OutputForm];
Cm = SimilarityMatrix[H0, D0];
Print[">>> err1 = Norm[H0.Cm-Cm.D0];"//OutputForm];
err1 = Norm[H0.Cm-Cm.D0];
Print[">>> err2 = Norm[H1.Cm-Cm.D1];"//OutputForm];
err2 = Norm[H1.Cm-Cm.D1];
Print[">>> Print[Max[err1, err2]];"//OutputForm];
Print[Max[err1, err2]];
Print["=== MAPFromRAP ==="]
Print[">>> D0 = {{-2., 2.},{2., -9.}};"//OutputForm];
D0 = {{-2., 2.},{2., -9.}};
Print[">>> D1 = {{-2., 2.},{3., 4.}};"//OutputForm];
D1 = {{-2., 2.},{3., 4.}};
Print[">>> {H0, H1} = MAPFromRAP[D0, D1];"//OutputForm];
{H0, H1} = MAPFromRAP[D0, D1];
Print[">>> Print[H0];"//OutputForm];
Print[H0];
Print[">>> Print[H1];"//OutputForm];
Print[H1];
Print[">>> err = Norm[LagkJointMomentsFromRAP[D0, D1, 3, 1]-LagkJointMomentsFromRAP[H0, H1, 3, 1]];"//OutputForm];
err = Norm[LagkJointMomentsFromRAP[D0, D1, 3, 1]-LagkJointMomentsFromRAP[H0, H1, 3, 1]];
Print[">>> Print[err];"//OutputForm];
Print[err];
Print[">>> D0 = {{-2.4, 2.},{2., -9.}};"//OutputForm];
D0 = {{-2.4, 2.},{2., -9.}};
Print[">>> D1 = {{-1.6, 2.},{3., 4.}};"//OutputForm];
D1 = {{-1.6, 2.},{3., 4.}};
Print[">>> {H0, H1} = MAPFromRAP[D0, D1];"//OutputForm];
{H0, H1} = MAPFromRAP[D0, D1];
Print[">>> Print[H0];"//OutputForm];
Print[H0];
Print[">>> Print[H1];"//OutputForm];
Print[H1];
Print[">>> err = Norm[LagkJointMomentsFromRAP[D0, D1, 3, 1]-LagkJointMomentsFromRAP[H0, H1, 3, 1]];"//OutputForm];
err = Norm[LagkJointMomentsFromRAP[D0, D1, 3, 1]-LagkJointMomentsFromRAP[H0, H1, 3, 1]];
Print[">>> Print[err];"//OutputForm];
Print[err];
Print["=== MMAPFromMRAP ==="]
Print[">>> x = 0.18;"//OutputForm];
x = 0.18;
Print[">>> H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};"//OutputForm];
H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};
Print[">>> H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};"//OutputForm];
H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};
Print[">>> H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};"//OutputForm];
H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};
Print[">>> H = {H0, H1, H2};"//OutputForm];
H = {H0, H1, H2};
Print[">>> moms = MarginalMomentsFromMRAP[H];"//OutputForm];
moms = MarginalMomentsFromMRAP[H];
Print[">>> Print[moms];"//OutputForm];
Print[moms];
Print[">>> jmom = LagkJointMomentsFromMRAP[H, 3, 1];"//OutputForm];
jmom = LagkJointMomentsFromMRAP[H, 3, 1];
Print[">>> G = MMAPFromMRAP[H];"//OutputForm];
G = MMAPFromMRAP[H];
Print[">>> Print[G[[1]]];"//OutputForm];
Print[G[[1]]];
Print[">>> Print[G[[2]]];"//OutputForm];
Print[G[[2]]];
Print[">>> Print[G[[3]]];"//OutputForm];
Print[G[[3]]];
Print[">>> rmoms = MarginalMomentsFromMMAP[G];"//OutputForm];
rmoms = MarginalMomentsFromMMAP[G];
Print[">>> Print[rmoms];"//OutputForm];
Print[rmoms];
Print[">>> rjmom = LagkJointMomentsFromMMAP[G, 3, 1];"//OutputForm];
rjmom = LagkJointMomentsFromMMAP[G, 3, 1];
Print[">>> err = Norm[rjmom[[1]]-jmom[[1]]]+Norm[rjmom[[2]]-jmom[[2]]];"//OutputForm];
err = Norm[rjmom[[1]]-jmom[[1]]]+Norm[rjmom[[2]]-jmom[[2]]];
Print[">>> Print[err];"//OutputForm];
Print[err];
Print["=== MinimalRepFromRAP ==="]
Print[">>> D0 = {{-5., 1., 0},{3., -3., 0},{1., 1., -5.}};"//OutputForm];
D0 = {{-5., 1., 0},{3., -3., 0},{1., 1., -5.}};
Print[">>> D1 = {{0, 0, 4.},{0, 0, 0},{1., 1., 1.}};"//OutputForm];
D1 = {{0, 0, 4.},{0, 0, 0},{1., 1., 1.}};
Print[">>> {H0, H1} = MinimalRepFromRAP[D0, D1, \"cont\"];"//OutputForm];
{H0, H1} = MinimalRepFromRAP[D0, D1, "cont"];
Print[">>> Print[H0];"//OutputForm];
Print[H0];
Print[">>> Print[H1];"//OutputForm];
Print[H1];
Print[">>> Cm = SimilarityMatrix[H0, D0];"//OutputForm];
Cm = SimilarityMatrix[H0, D0];
Print[">>> err1 = Norm[H0.Cm-Cm.D0];"//OutputForm];
err1 = Norm[H0.Cm-Cm.D0];
Print[">>> err2 = Norm[H1.Cm-Cm.D1];"//OutputForm];
err2 = Norm[H1.Cm-Cm.D1];
Print[">>> Print[Max[err1, err2]];"//OutputForm];
Print[Max[err1, err2]];
Print[">>> {H0, H1} = MinimalRepFromRAP[D0, D1, \"obs\"];"//OutputForm];
{H0, H1} = MinimalRepFromRAP[D0, D1, "obs"];
Print[">>> Print[H0];"//OutputForm];
Print[H0];
Print[">>> Print[H1];"//OutputForm];
Print[H1];
Print[">>> Cm = SimilarityMatrix[H0, D0];"//OutputForm];
Cm = SimilarityMatrix[H0, D0];
Print[">>> err1 = Norm[H0.Cm-Cm.D0];"//OutputForm];
err1 = Norm[H0.Cm-Cm.D0];
Print[">>> err2 = Norm[H1.Cm-Cm.D1];"//OutputForm];
err2 = Norm[H1.Cm-Cm.D1];
Print[">>> Print[Max[err1, err2]];"//OutputForm];
Print[Max[err1, err2]];
Print[">>> {H0, H1} = MinimalRepFromRAP[D0, D1, \"obscont\"];"//OutputForm];
{H0, H1} = MinimalRepFromRAP[D0, D1, "obscont"];
Print[">>> Print[H0];"//OutputForm];
Print[H0];
Print[">>> Print[H1];"//OutputForm];
Print[H1];
Print[">>> Cm = SimilarityMatrix[H0, D0];"//OutputForm];
Cm = SimilarityMatrix[H0, D0];
Print[">>> err1 = Norm[H0.Cm-Cm.D0];"//OutputForm];
err1 = Norm[H0.Cm-Cm.D0];
Print[">>> err2 = Norm[H1.Cm-Cm.D1];"//OutputForm];
err2 = Norm[H1.Cm-Cm.D1];
Print[">>> Print[Max[err1, err2]];"//OutputForm];
Print[Max[err1, err2]];
Print["=== MinimalRepFromMRAP ==="]
Print[">>> D0 = {{-5., 1., 0},{3., -3., 0},{1., 1., -5.}};"//OutputForm];
D0 = {{-5., 1., 0},{3., -3., 0},{1., 1., -5.}};
Print[">>> D1 = {{0, 0, 0.8},{0, 0, 0},{0.2, 0.2, 0.2}};"//OutputForm];
D1 = {{0, 0, 0.8},{0, 0, 0},{0.2, 0.2, 0.2}};
Print[">>> D2 = {{0, 0, 3.2},{0, 0, 0},{0.8, 0.8, 0.8}};"//OutputForm];
D2 = {{0, 0, 3.2},{0, 0, 0},{0.8, 0.8, 0.8}};
Print[">>> Dm = {D0, D1, D2};"//OutputForm];
Dm = {D0, D1, D2};
Print[">>> H = MinimalRepFromMRAP[Dm, \"cont\"];"//OutputForm];
H = MinimalRepFromMRAP[Dm, "cont"];
Print[">>> Print[H[[1]]];"//OutputForm];
Print[H[[1]]];
Print[">>> Print[H[[2]]];"//OutputForm];
Print[H[[2]]];
Print[">>> Print[H[[3]]];"//OutputForm];
Print[H[[3]]];
Print[">>> Cm = SimilarityMatrix[H[[1]], Dm[[1]]];"//OutputForm];
Cm = SimilarityMatrix[H[[1]], Dm[[1]]];
Print[">>> err = Norm[H[[1]].Cm-Cm.Dm[[1]]]+Norm[H[[2]].Cm-Cm.Dm[[2]]]+Norm[H[[3]].Cm-Cm.Dm[[3]]];"//OutputForm];
err = Norm[H[[1]].Cm-Cm.Dm[[1]]]+Norm[H[[2]].Cm-Cm.Dm[[2]]]+Norm[H[[3]].Cm-Cm.Dm[[3]]];
Print[">>> Print[err];"//OutputForm];
Print[err];
Print[">>> H = MinimalRepFromMRAP[Dm, \"obs\"];"//OutputForm];
H = MinimalRepFromMRAP[Dm, "obs"];
Print[">>> Print[H[[1]]];"//OutputForm];
Print[H[[1]]];
Print[">>> Print[H[[2]]];"//OutputForm];
Print[H[[2]]];
Print[">>> Print[H[[3]]];"//OutputForm];
Print[H[[3]]];
Print[">>> Cm = SimilarityMatrix[H[[1]], Dm[[1]]];"//OutputForm];
Cm = SimilarityMatrix[H[[1]], Dm[[1]]];
Print[">>> err = Norm[H[[1]].Cm-Cm.Dm[[1]]]+Norm[H[[2]].Cm-Cm.Dm[[2]]]+Norm[H[[3]].Cm-Cm.Dm[[3]]];"//OutputForm];
err = Norm[H[[1]].Cm-Cm.Dm[[1]]]+Norm[H[[2]].Cm-Cm.Dm[[2]]]+Norm[H[[3]].Cm-Cm.Dm[[3]]];
Print[">>> Print[err];"//OutputForm];
Print[err];
Print[">>> H = MinimalRepFromMRAP[Dm, \"obscont\"];"//OutputForm];
H = MinimalRepFromMRAP[Dm, "obscont"];
Print[">>> Print[H[[1]]];"//OutputForm];
Print[H[[1]]];
Print[">>> Print[H[[2]]];"//OutputForm];
Print[H[[2]]];
Print[">>> Print[H[[3]]];"//OutputForm];
Print[H[[3]]];
Print[">>> Cm = SimilarityMatrix[H[[1]], Dm[[1]]];"//OutputForm];
Cm = SimilarityMatrix[H[[1]], Dm[[1]]];
Print[">>> err = Norm[H[[1]].Cm-Cm.Dm[[1]]]+Norm[H[[2]].Cm-Cm.Dm[[2]]]+Norm[H[[3]].Cm-Cm.Dm[[3]]];"//OutputForm];
err = Norm[H[[1]].Cm-Cm.Dm[[1]]]+Norm[H[[2]].Cm-Cm.Dm[[2]]]+Norm[H[[3]].Cm-Cm.Dm[[3]]];
Print[">>> Print[err];"//OutputForm];
Print[err];
Print["=== SamplesFromMAP ==="]
Print[">>> D0 = {{-0.17, 0, 0, 0.07},{0.01, -0.78, 0.03, 0.08},{0.22, 0.17, -1.1, 0.02},{0.04, 0.12, 0, -0.42}};"//OutputForm];
D0 = {{-0.17, 0, 0, 0.07},{0.01, -0.78, 0.03, 0.08},{0.22, 0.17, -1.1, 0.02},{0.04, 0.12, 0, -0.42}};
Print[">>> D1 = {{0, 0.06, 0, 0.04},{0.04, 0.19, 0.21, 0.22},{0.22, 0.13, 0.15, 0.19},{0.05, 0, 0.17, 0.04}};"//OutputForm];
D1 = {{0, 0.06, 0, 0.04},{0.04, 0.19, 0.21, 0.22},{0.22, 0.13, 0.15, 0.19},{0.05, 0, 0.17, 0.04}};
Print[">>> x = SamplesFromMAP[D0, D1, 10000];"//OutputForm];
x = SamplesFromMAP[D0, D1, 10000];
Print[">>> mt = MarginalMomentsFromTrace[x, 3];"//OutputForm];
mt = MarginalMomentsFromTrace[x, 3];
Print[">>> Print[mt];"//OutputForm];
Print[mt];
Print[">>> mm = MarginalMomentsFromMAP[D0, D1, 3];"//OutputForm];
mm = MarginalMomentsFromMAP[D0, D1, 3];
Print[">>> Print[mm];"//OutputForm];
Print[mm];
Print["=== SamplesFromMMAP ==="]
Print[">>> D0 = {{-1.78, 0.29},{0.07, -0.92}};"//OutputForm];
D0 = {{-1.78, 0.29},{0.07, -0.92}};
Print[">>> D1 = {{0.15, 0.49},{0.23, 0.36}};"//OutputForm];
D1 = {{0.15, 0.49},{0.23, 0.36}};
Print[">>> D2 = {{0.11, 0.2},{0.01, 0}};"//OutputForm];
D2 = {{0.11, 0.2},{0.01, 0}};
Print[">>> D3 = {{0.14, 0.4},{0.11, 0.14}};"//OutputForm];
D3 = {{0.14, 0.4},{0.11, 0.14}};
Print[">>> Dm = {D0, D1, D2, D3};"//OutputForm];
Dm = {D0, D1, D2, D3};
Print[">>> x = SamplesFromMMAP[Dm, 10000];"//OutputForm];
x = SamplesFromMMAP[Dm, 10000];
Print[">>> mt = MarginalMomentsFromTrace[x[[1;;-1, 1]], 3];"//OutputForm];
mt = MarginalMomentsFromTrace[x[[1;;-1, 1]], 3];
Print[">>> Print[mt];"//OutputForm];
Print[mt];
Print[">>> mm = MarginalMomentsFromMMAP[Dm, 3];"//OutputForm];
mm = MarginalMomentsFromMMAP[Dm, 3];
Print[">>> Print[mm];"//OutputForm];
Print[mm];
$Output = tmpOut;Close[stream];

