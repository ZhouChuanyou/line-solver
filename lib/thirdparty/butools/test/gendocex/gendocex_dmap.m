clear all
run('/home/gabor/github/butools/Matlab/BuToolsInit.m')

disp('---BuTools: DMAP package test file---');
disp('Enable the verbose messages with the BuToolsVerbose flag');
global BuToolsVerbose;
BuToolsVerbose = true;
disp('Enable input parameter checking with the BuToolsCheckInput flag');
global BuToolsCheckInput;
BuToolsCheckInput = true;
global BuToolsCheckPrecision;
format short g;
format compact
delete('/home/gabor/github/butools/test/docex/DMAP_matlab.docex');
diary('/home/gabor/github/butools/test/docex/DMAP_matlab.docex');
disp('=== MarginalDistributionFromDMAP ===')
disp('>>> D0 = [0, 0.02, 0, 0; 0, 0.17, 0.2, 0.14; 0.16, 0.17, 0.02, 0.18; 0, 0, 0, 0.12];');
D0 = [0, 0.02, 0, 0; 0, 0.17, 0.2, 0.14; 0.16, 0.17, 0.02, 0.18; 0, 0, 0, 0.12];
disp('>>> D1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];');
D1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];
disp('>>> [a, A] = MarginalDistributionFromDMAP(D0, D1);');
[a, A] = MarginalDistributionFromDMAP(D0, D1);
disp('>>> disp(a);');
disp(a);
disp('>>> disp(A);');
disp(A);
disp('=== MarginalMomentsFromDMAP ===')
disp('>>> D0 = [0, 0.02, 0, 0; 0, 0.17, 0.2, 0.14; 0.16, 0.17, 0.02, 0.18; 0, 0, 0, 0.12];');
D0 = [0, 0.02, 0, 0; 0, 0.17, 0.2, 0.14; 0.16, 0.17, 0.02, 0.18; 0, 0, 0, 0.12];
disp('>>> D1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];');
D1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];
disp('>>> moms = MarginalMomentsFromDMAP(D0, D1);');
moms = MarginalMomentsFromDMAP(D0, D1);
disp('>>> disp(moms);');
disp(moms);
disp('=== MarginalDistributionFromDRAP ===')
disp('>>> H0 = [0, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02];');
H0 = [0, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02];
disp('>>> H1 = [0, 1, -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29];');
H1 = [0, 1, -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29];
disp('>>> [a, A] = MarginalDistributionFromDRAP(H0, H1);');
[a, A] = MarginalDistributionFromDRAP(H0, H1);
disp('>>> disp(a);');
disp(a);
disp('>>> disp(A);');
disp(A);
disp('=== MarginalMomentsFromDRAP ===')
disp('>>> H0 = [0, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02];');
H0 = [0, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02];
disp('>>> H1 = [0, 1, -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29];');
H1 = [0, 1, -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29];
disp('>>> moms = MarginalMomentsFromDRAP(H0, H1);');
moms = MarginalMomentsFromDRAP(H0, H1);
disp('>>> disp(moms);');
disp(moms);
disp('=== MarginalDistributionFromDMMAP ===')
disp('>>> D0 = [0.34, 0, 0; 0.06, 0.05, 0.03; 0.11, 0.13, 0];');
D0 = [0.34, 0, 0; 0.06, 0.05, 0.03; 0.11, 0.13, 0];
disp('>>> D1 = [0.3, 0, 0; 0.16, 0.18, 0.05; 0.15, 0.04, 0.09];');
D1 = [0.3, 0, 0; 0.16, 0.18, 0.05; 0.15, 0.04, 0.09];
disp('>>> D2 = [0, 0.01, 0; 0.1, 0.07, 0.08; 0.13, 0.12, 0.13];');
D2 = [0, 0.01, 0; 0.1, 0.07, 0.08; 0.13, 0.12, 0.13];
disp('>>> D3 = [0.35, 0, 0; 0, 0.18, 0.04; 0.06, 0.03, 0.01];');
D3 = [0.35, 0, 0; 0, 0.18, 0.04; 0.06, 0.03, 0.01];
disp('>>> [a, A] = MarginalDistributionFromDMMAP({D0, D1, D2, D3});');
[a, A] = MarginalDistributionFromDMMAP({D0, D1, D2, D3});
disp('>>> disp(a);');
disp(a);
disp('>>> disp(A);');
disp(A);
disp('=== MarginalMomentsFromDMMAP ===')
disp('>>> D0 = [0.34, 0, 0; 0.06, 0.05, 0.03; 0.11, 0.13, 0];');
D0 = [0.34, 0, 0; 0.06, 0.05, 0.03; 0.11, 0.13, 0];
disp('>>> D1 = [0.3, 0, 0; 0.16, 0.18, 0.05; 0.15, 0.04, 0.09];');
D1 = [0.3, 0, 0; 0.16, 0.18, 0.05; 0.15, 0.04, 0.09];
disp('>>> D2 = [0, 0.01, 0; 0.1, 0.07, 0.08; 0.13, 0.12, 0.13];');
D2 = [0, 0.01, 0; 0.1, 0.07, 0.08; 0.13, 0.12, 0.13];
disp('>>> D3 = [0.35, 0, 0; 0, 0.18, 0.04; 0.06, 0.03, 0.01];');
D3 = [0.35, 0, 0; 0, 0.18, 0.04; 0.06, 0.03, 0.01];
disp('>>> moms = MarginalMomentsFromDMMAP({D0, D1, D2, D3});');
moms = MarginalMomentsFromDMMAP({D0, D1, D2, D3});
disp('>>> disp(moms);');
disp(moms);
disp('=== MarginalDistributionFromDMRAP ===')
disp('>>> H0 = [0.15, 0.2, 0.18; -0.23, 0.17, 0.22; 0.19, 0.15, 0.16];');
H0 = [0.15, 0.2, 0.18; -0.23, 0.17, 0.22; 0.19, 0.15, 0.16];
disp('>>> H1 = [0.01, 0.08, 0.16; 0.02, 0.2, 0.07; 0.02, 0.15, 0.17];');
H1 = [0.01, 0.08, 0.16; 0.02, 0.2, 0.07; 0.02, 0.15, 0.17];
disp('>>> H2 = [0.14, 0.07, 0.01; 0.19, 0.02, 0.34; 0.06, 0.1, 0];');
H2 = [0.14, 0.07, 0.01; 0.19, 0.02, 0.34; 0.06, 0.1, 0];
disp('>>> [a, A] = MarginalDistributionFromDMRAP({H0, H1, H2});');
[a, A] = MarginalDistributionFromDMRAP({H0, H1, H2});
disp('>>> disp(a);');
disp(a);
disp('>>> disp(A);');
disp(A);
disp('=== MarginalMomentsFromDMRAP ===')
disp('>>> H0 = [0.15, 0.2, 0.18; -0.23, 0.17, 0.22; 0.19, 0.15, 0.16];');
H0 = [0.15, 0.2, 0.18; -0.23, 0.17, 0.22; 0.19, 0.15, 0.16];
disp('>>> H1 = [0.01, 0.08, 0.16; 0.02, 0.2, 0.07; 0.02, 0.15, 0.17];');
H1 = [0.01, 0.08, 0.16; 0.02, 0.2, 0.07; 0.02, 0.15, 0.17];
disp('>>> H2 = [0.14, 0.07, 0.01; 0.19, 0.02, 0.34; 0.06, 0.1, 0];');
H2 = [0.14, 0.07, 0.01; 0.19, 0.02, 0.34; 0.06, 0.1, 0];
disp('>>> moms = MarginalMomentsFromDMRAP({H0, H1, H2});');
moms = MarginalMomentsFromDMRAP({H0, H1, H2});
disp('>>> disp(moms);');
disp(moms);
disp('=== LagCorrelationsFromDMAP ===')
disp('>>> D0 = [0, 0.02, 0, 0; 0, 0.17, 0.2, 0.14; 0.16, 0.17, 0.02, 0.18; 0, 0, 0, 0.12];');
D0 = [0, 0.02, 0, 0; 0, 0.17, 0.2, 0.14; 0.16, 0.17, 0.02, 0.18; 0, 0, 0, 0.12];
disp('>>> D1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];');
D1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];
disp('>>> corr = LagCorrelationsFromDMAP(D0, D1, 3);');
corr = LagCorrelationsFromDMAP(D0, D1, 3);
disp('>>> disp(corr);');
disp(corr);
disp('=== LagCorrelationsFromDRAP ===')
disp('>>> H0 = [0, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02];');
H0 = [0, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02];
disp('>>> H1 = [0, 1, -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29];');
H1 = [0, 1, -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29];
disp('>>> corr = LagCorrelationsFromDRAP(H0, H1, 3);');
corr = LagCorrelationsFromDRAP(H0, H1, 3);
disp('>>> disp(corr);');
disp(corr);
disp('=== LagkJointMomentsFromDMAP ===')
disp('>>> D0 = [0, 0.02, 0, 0; 0, 0.17, 0.2, 0.14; 0.16, 0.17, 0.02, 0.18; 0, 0, 0, 0.12];');
D0 = [0, 0.02, 0, 0; 0, 0.17, 0.2, 0.14; 0.16, 0.17, 0.02, 0.18; 0, 0, 0, 0.12];
disp('>>> D1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];');
D1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];
disp('>>> Nm = LagkJointMomentsFromDMAP(D0, D1, 4, 1);');
Nm = LagkJointMomentsFromDMAP(D0, D1, 4, 1);
disp('>>> disp(Nm);');
disp(Nm);
disp('>>> moms = MarginalMomentsFromDMAP(D0, D1, 4);');
moms = MarginalMomentsFromDMAP(D0, D1, 4);
disp('>>> disp(moms);');
disp(moms);
disp('>>> cjm = zeros(1,3);');
cjm = zeros(1,3);
disp('>>> for i=1:1:3');
disp('>>>     Nx = LagkJointMomentsFromDMAP(D0, D1, 1, i);');
disp('>>>     cjm(i) = (Nx(2, 2)-moms(1)^2)/(moms(2)-moms(1)^2);');
disp('>>> end');
for i=1:1:3
    Nx = LagkJointMomentsFromDMAP(D0, D1, 1, i);
    cjm(i) = (Nx(2, 2)-moms(1)^2)/(moms(2)-moms(1)^2);
end
disp('>>> disp(cjm);');
disp(cjm);
disp('>>> corr = LagCorrelationsFromDMAP(D0, D1, 3);');
corr = LagCorrelationsFromDMAP(D0, D1, 3);
disp('>>> disp(corr);');
disp(corr);
mNm1 = reshape(Nm(1, 2:end),1,numel(Nm(1, 2:end)));
mNm2 = reshape(Nm(2:end, 1),1,numel(Nm(2:end, 1)));
disp('=== LagkJointMomentsFromDRAP ===')
disp('>>> H0 = [0, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02];');
H0 = [0, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02];
disp('>>> H1 = [0, 1, -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29];');
H1 = [0, 1, -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29];
disp('>>> Nm = LagkJointMomentsFromDRAP(H0, H1, 4, 1);');
Nm = LagkJointMomentsFromDRAP(H0, H1, 4, 1);
disp('>>> disp(length(Nm));');
disp(length(Nm));
disp('>>> moms = MarginalMomentsFromDRAP(H0, H1, 4);');
moms = MarginalMomentsFromDRAP(H0, H1, 4);
disp('>>> disp(moms);');
disp(moms);
disp('>>> cjm = zeros(1,3);');
cjm = zeros(1,3);
disp('>>> for i=1:1:3');
disp('>>>     Nx = LagkJointMomentsFromDRAP(H0, H1, 1, i);');
disp('>>>     cjm(i) = (Nx(2, 2)-moms(1)^2)/(moms(2)-moms(1)^2);');
disp('>>> end');
for i=1:1:3
    Nx = LagkJointMomentsFromDRAP(H0, H1, 1, i);
    cjm(i) = (Nx(2, 2)-moms(1)^2)/(moms(2)-moms(1)^2);
end
disp('>>> disp(cjm);');
disp(cjm);
disp('>>> corr = LagCorrelationsFromDRAP(H0, H1, 3);');
corr = LagCorrelationsFromDRAP(H0, H1, 3);
disp('>>> disp(corr);');
disp(corr);
mNm1 = reshape(Nm(1, 2:end),1,numel(Nm(1, 2:end)));
mNm2 = reshape(Nm(2:end, 1),1,numel(Nm(2:end, 1)));
disp('=== LagkJointMomentsFromDMMAP ===')
disp('>>> D0 = [0.34, 0, 0; 0.06, 0.05, 0.03; 0.11, 0.13, 0];');
D0 = [0.34, 0, 0; 0.06, 0.05, 0.03; 0.11, 0.13, 0];
disp('>>> D1 = [0.3, 0, 0; 0.16, 0.18, 0.05; 0.15, 0.04, 0.09];');
D1 = [0.3, 0, 0; 0.16, 0.18, 0.05; 0.15, 0.04, 0.09];
disp('>>> D2 = [0, 0.01, 0; 0.1, 0.07, 0.08; 0.13, 0.12, 0.13];');
D2 = [0, 0.01, 0; 0.1, 0.07, 0.08; 0.13, 0.12, 0.13];
disp('>>> D3 = [0.35, 0, 0; 0, 0.18, 0.04; 0.06, 0.03, 0.01];');
D3 = [0.35, 0, 0; 0, 0.18, 0.04; 0.06, 0.03, 0.01];
disp('>>> Nm = LagkJointMomentsFromDMMAP({D0, D1, D2, D3}, 3, 1);');
Nm = LagkJointMomentsFromDMMAP({D0, D1, D2, D3}, 3, 1);
disp('>>> disp(Nm{1});');
disp(Nm{1});
disp('>>> disp(Nm{2});');
disp(Nm{2});
disp('>>> disp(Nm{3});');
disp(Nm{3});
disp('=== LagkJointMomentsFromDMRAP ===')
disp('>>> H0 = [0.15, 0.2, 0.18; -0.23, 0.17, 0.22; 0.19, 0.15, 0.16];');
H0 = [0.15, 0.2, 0.18; -0.23, 0.17, 0.22; 0.19, 0.15, 0.16];
disp('>>> H1 = [0.01, 0.08, 0.16; 0.02, 0.2, 0.07; 0.02, 0.15, 0.17];');
H1 = [0.01, 0.08, 0.16; 0.02, 0.2, 0.07; 0.02, 0.15, 0.17];
disp('>>> H2 = [0.14, 0.07, 0.01; 0.19, 0.02, 0.34; 0.06, 0.1, 0];');
H2 = [0.14, 0.07, 0.01; 0.19, 0.02, 0.34; 0.06, 0.1, 0];
disp('>>> Nm = LagkJointMomentsFromDMRAP({H0, H1, H2}, 3, 2);');
Nm = LagkJointMomentsFromDMRAP({H0, H1, H2}, 3, 2);
disp('>>> disp(Nm{1});');
disp(Nm{1});
disp('>>> disp(Nm{2});');
disp(Nm{2});
disp('=== RandomDMAP ===')
disp('>>> [D0, D1] = RandomDMAP(4, 5.62, 10);');
[D0, D1] = RandomDMAP(4, 5.62, 10);
disp('>>> disp(D0);');
disp(D0);
disp('>>> disp(D1);');
disp(D1);
disp('>>> m = MarginalMomentsFromDMAP(D0, D1, 1);');
m = MarginalMomentsFromDMAP(D0, D1, 1);
disp('>>> disp(m);');
disp(m);
disp('=== RandomDMMAP ===')
disp('>>> Dm = RandomDMMAP(4, 3, 5.62, 10);');
Dm = RandomDMMAP(4, 3, 5.62, 10);
disp('>>> disp(Dm{1});');
disp(Dm{1});
disp('>>> disp(Dm{2});');
disp(Dm{2});
disp('>>> disp(Dm{3});');
disp(Dm{3});
disp('>>> disp(Dm{4});');
disp(Dm{4});
disp('>>> m = MarginalMomentsFromDMMAP(Dm, 1);');
m = MarginalMomentsFromDMMAP(Dm, 1);
disp('>>> disp(m);');
disp(m);
disp('=== CheckDMAPRepresentation ===')
disp('>>> D0 = [0, 0.02, 0; 0, 0.17, 0.2; 0.16, 0.17, 0.02];');
D0 = [0, 0.02, 0; 0, 0.17, 0.2; 0.16, 0.17, 0.02];
disp('>>> D1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];');
D1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];
disp('>>> flag = CheckDMAPRepresentation(D0, D1);');
flag = CheckDMAPRepresentation(D0, D1);
disp('>>> disp(flag);');
disp(flag);
disp('>>> D0 = [0, 0.02, 0; 0, 0.17, 0.2; 0.16, 0.17, 0.02];');
D0 = [0, 0.02, 0; 0, 0.17, 0.2; 0.16, 0.17, 0.02];
disp('>>> D1 = [0, 0.88, 0.1; 0.18, 0.07, 0.14; 0.13, 0.15, 0.15];');
D1 = [0, 0.88, 0.1; 0.18, 0.07, 0.14; 0.13, 0.15, 0.15];
disp('>>> flag = CheckDMAPRepresentation(D0, D1);');
flag = CheckDMAPRepresentation(D0, D1);
disp('>>> disp(flag);');
disp(flag);
disp('>>> D0 = [0, 0.02, 0, 0; 0, 0.17, 0.2, 0.14; 0.16, 0.17, 0.02, 0.18; 0, 0, 0, 0.12];');
D0 = [0, 0.02, 0, 0; 0, 0.17, 0.2, 0.14; 0.16, 0.17, 0.02, 0.18; 0, 0, 0, 0.12];
disp('>>> D1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];');
D1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];
disp('>>> flag = CheckDMAPRepresentation(D0, D1);');
flag = CheckDMAPRepresentation(D0, D1);
disp('>>> disp(flag);');
disp(flag);
disp('=== CheckDRAPRepresentation ===')
disp('>>> H0 = [0, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02; 0.2, 0, 0];');
H0 = [0, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02; 0.2, 0, 0];
disp('>>> H1 = [0, 1., -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29; 0, 0.8, 0];');
H1 = [0, 1., -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29; 0, 0.8, 0];
disp('>>> flag = CheckDRAPRepresentation(H0, H1);');
flag = CheckDRAPRepresentation(H0, H1);
disp('>>> disp(flag);');
disp(flag);
disp('>>> H0 = [0.2, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02];');
H0 = [0.2, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02];
disp('>>> H1 = [0, 1., -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29];');
H1 = [0, 1., -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29];
disp('>>> flag = CheckDRAPRepresentation(H0, H1);');
flag = CheckDRAPRepresentation(H0, H1);
disp('>>> disp(flag);');
disp(flag);
disp('>>> H0 = [-1., 0, 0; 0, -2., 2.; 0, 3., -3.];');
H0 = [-1., 0, 0; 0, -2., 2.; 0, 3., -3.];
disp('>>> H1 = [0, 0, 1.; 0, -1., 1.; 1., 0, -1.];');
H1 = [0, 0, 1.; 0, -1., 1.; 1., 0, -1.];
disp('>>> flag = CheckDRAPRepresentation(H0, H1);');
flag = CheckDRAPRepresentation(H0, H1);
disp('>>> disp(flag);');
disp(flag);
disp('>>> H0 = [0, 0, 15.; 0, 0.6, 0.18; 0.31, 0.26, 0.02];');
H0 = [0, 0, 15.; 0, 0.6, 0.18; 0.31, 0.26, 0.02];
disp('>>> H1 = [0, 1., -15.; 0, 0.18, 0.04; 0.03, 0.09, 0.29];');
H1 = [0, 1., -15.; 0, 0.18, 0.04; 0.03, 0.09, 0.29];
disp('>>> flag = CheckDRAPRepresentation(H0, H1);');
flag = CheckDRAPRepresentation(H0, H1);
disp('>>> disp(flag);');
disp(flag);
disp('>>> H0 = [0, 0.5, 0.1; 0, -1.4, 3.1; 0.67, 0, 0.4];');
H0 = [0, 0.5, 0.1; 0, -1.4, 3.1; 0.67, 0, 0.4];
disp('>>> H1 = [0, 0.4, 0; 0, -0.2, -0.5; 0.3, -0.7, 0.33];');
H1 = [0, 0.4, 0; 0, -0.2, -0.5; 0.3, -0.7, 0.33];
disp('>>> flag = CheckDRAPRepresentation(H0, H1);');
flag = CheckDRAPRepresentation(H0, H1);
disp('>>> disp(flag);');
disp(flag);
disp('>>> H0 = [0, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02];');
H0 = [0, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02];
disp('>>> H1 = [0, 1., -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29];');
H1 = [0, 1., -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29];
disp('>>> flag = CheckDRAPRepresentation(H0, H1);');
flag = CheckDRAPRepresentation(H0, H1);
disp('>>> disp(flag);');
disp(flag);
disp('=== CheckDMMAPRepresentation ===')
disp('>>> D0 = [0.34, 0, 0; 0.06, 0.05, 0.03; 0.11, 0.13, 0];');
D0 = [0.34, 0, 0; 0.06, 0.05, 0.03; 0.11, 0.13, 0];
disp('>>> D1 = [0.3, 0, 0; 0.16, 0.18, 0.05; 0.15, 0.04, 0.09];');
D1 = [0.3, 0, 0; 0.16, 0.18, 0.05; 0.15, 0.04, 0.09];
disp('>>> D2 = [0, 0.01, 0; 0.1, 0.07, 0.08; 0.13, 0.12, 0.13];');
D2 = [0, 0.01, 0; 0.1, 0.07, 0.08; 0.13, 0.12, 0.13];
disp('>>> D3 = [0.35, 0, 0; 0, 0.18, 0.04; 0.06, 0.03, 0.01];');
D3 = [0.35, 0, 0; 0, 0.18, 0.04; 0.06, 0.03, 0.01];
disp('>>> flag = CheckDMMAPRepresentation({D0, D1, D2, D3});');
flag = CheckDMMAPRepresentation({D0, D1, D2, D3});
disp('>>> disp(flag);');
disp(flag);
disp('=== CheckDMRAPRepresentation ===')
disp('>>> H0 = [0.15, 0.2, 0.18; -0.23, 0.17, 0.22; 0.19, 0.15, 0.16];');
H0 = [0.15, 0.2, 0.18; -0.23, 0.17, 0.22; 0.19, 0.15, 0.16];
disp('>>> H1 = [0.01, 0.08, 0.16; 0.02, 0.2, 0.07; 0.02, 0.15, 0.17];');
H1 = [0.01, 0.08, 0.16; 0.02, 0.2, 0.07; 0.02, 0.15, 0.17];
disp('>>> H2 = [0.14, 0.07, 0.01; 0.19, 0.02, 0.34; 0.06, 0.1, 0];');
H2 = [0.14, 0.07, 0.01; 0.19, 0.02, 0.34; 0.06, 0.1, 0];
disp('>>> flag = CheckDMRAPRepresentation({H0, H1, H2});');
flag = CheckDMRAPRepresentation({H0, H1, H2});
disp('>>> disp(flag);');
disp(flag);
disp('=== DRAPFromMoments ===')
disp('>>> G0 = [0, 0.02, 0, 0; 0, 0.17, 0.2, 0.14; 0.16, 0.17, 0.02, 0.18; 0, 0, 0, 0.12];');
G0 = [0, 0.02, 0, 0; 0, 0.17, 0.2, 0.14; 0.16, 0.17, 0.02, 0.18; 0, 0, 0, 0.12];
disp('>>> G1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];');
G1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];
disp('>>> moms = MarginalMomentsFromDRAP(G0, G1, 5);');
moms = MarginalMomentsFromDRAP(G0, G1, 5);
disp('>>> disp(moms);');
disp(moms);
disp('>>> Nm = LagkJointMomentsFromDRAP(G0, G1, 2, 1);');
Nm = LagkJointMomentsFromDRAP(G0, G1, 2, 1);
disp('>>> disp(Nm);');
disp(Nm);
disp('>>> [H0, H1] = DRAPFromMoments(moms, Nm);');
[H0, H1] = DRAPFromMoments(moms, Nm);
disp('>>> disp(H0);');
disp(H0);
disp('>>> disp(H1);');
disp(H1);
disp('>>> rmoms = MarginalMomentsFromDRAP(H0, H1, 5);');
rmoms = MarginalMomentsFromDRAP(H0, H1, 5);
disp('>>> disp(rmoms);');
disp(rmoms);
disp('>>> rNm = LagkJointMomentsFromDRAP(H0, H1, 2, 1);');
rNm = LagkJointMomentsFromDRAP(H0, H1, 2, 1);
disp('>>> disp(rNm);');
disp(rNm);
disp('=== DMRAPFromMoments ===')
disp('>>> G0 = [0.34, 0, 0; 0.06, 0.05, 0.03; 0.11, 0.13, 0];');
G0 = [0.34, 0, 0; 0.06, 0.05, 0.03; 0.11, 0.13, 0];
disp('>>> G1 = [0.3, 0, 0; 0.16, 0.18, 0.05; 0.15, 0.04, 0.09];');
G1 = [0.3, 0, 0; 0.16, 0.18, 0.05; 0.15, 0.04, 0.09];
disp('>>> G2 = [0, 0.01, 0; 0.1, 0.07, 0.08; 0.13, 0.12, 0.13];');
G2 = [0, 0.01, 0; 0.1, 0.07, 0.08; 0.13, 0.12, 0.13];
disp('>>> G3 = [0.35, 0, 0; 0, 0.18, 0.04; 0.06, 0.03, 0.01];');
G3 = [0.35, 0, 0; 0, 0.18, 0.04; 0.06, 0.03, 0.01];
disp('>>> G = {G0, G1, G2, G3};');
G = {G0, G1, G2, G3};
disp('>>> moms = MarginalMomentsFromDMRAP(G, 5);');
moms = MarginalMomentsFromDMRAP(G, 5);
disp('>>> disp(moms);');
disp(moms);
disp('>>> Nm = LagkJointMomentsFromDMRAP(G, 2, 1);');
Nm = LagkJointMomentsFromDMRAP(G, 2, 1);
disp('>>> [Nm1, Nm2, Nm3] = Nm{:};');
[Nm1, Nm2, Nm3] = Nm{:};
disp('>>> disp(Nm1);');
disp(Nm1);
disp('>>> disp(Nm2);');
disp(Nm2);
disp('>>> disp(Nm3);');
disp(Nm3);
disp('>>> H = DMRAPFromMoments(moms, Nm);');
H = DMRAPFromMoments(moms, Nm);
disp('>>> disp(H{1});');
disp(H{1});
disp('>>> disp(H{2});');
disp(H{2});
disp('>>> disp(H{3});');
disp(H{3});
disp('>>> disp(H{4});');
disp(H{4});
disp('>>> BuToolsCheckPrecision = 10.^-10;');
BuToolsCheckPrecision = 10.^-10;
disp('>>> rmoms = MarginalMomentsFromDMRAP(H, 5);');
rmoms = MarginalMomentsFromDMRAP(H, 5);
disp('>>> disp(rmoms);');
disp(rmoms);
disp('>>> rNm = LagkJointMomentsFromDMRAP(H, 2, 1);');
rNm = LagkJointMomentsFromDMRAP(H, 2, 1);
disp('>>> [rNm1, rNm2, rNm3] = rNm{:};');
[rNm1, rNm2, rNm3] = rNm{:};
disp('>>> disp(rNm1);');
disp(rNm1);
disp('>>> disp(rNm2);');
disp(rNm2);
disp('>>> disp(rNm3);');
disp(rNm3);
disp('>>> disp(norm(moms-rmoms));');
disp(norm(moms-rmoms));
disp('=== DMAPFromDRAP ===')
disp('>>> H0 = [0, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02];');
H0 = [0, 0, 0.13; 0, 0.6, 0.18; 0.31, 0.26, 0.02];
disp('>>> H1 = [0, 1, -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29];');
H1 = [0, 1, -0.13; 0, 0.18, 0.04; 0.03, 0.09, 0.29];
disp('>>> [D0, D1] = DMAPFromDRAP(H0, H1);');
[D0, D1] = DMAPFromDRAP(H0, H1);
disp('>>> disp(D0);');
disp(D0);
disp('>>> disp(D1);');
disp(D1);
disp('>>> err = norm(LagkJointMomentsFromDRAP(D0, D1, 3, 1)-LagkJointMomentsFromDRAP(H0, H1, 3, 1));');
err = norm(LagkJointMomentsFromDRAP(D0, D1, 3, 1)-LagkJointMomentsFromDRAP(H0, H1, 3, 1));
disp('>>> disp(err);');
disp(err);
disp('=== DMMAPFromDMRAP ===')
disp('>>> H0 = [0.15, 0.2, 0.18; -0.20, 0.17, 0.22; 0.19, 0.15, 0.16];');
H0 = [0.15, 0.2, 0.18; -0.20, 0.17, 0.22; 0.19, 0.15, 0.16];
disp('>>> H1 = [0.01, 0.08, 0.16; 0.02, 0.2, 0.07; 0.02, 0.15, 0.17];');
H1 = [0.01, 0.08, 0.16; 0.02, 0.2, 0.07; 0.02, 0.15, 0.17];
disp('>>> H2 = [0.14, 0.07, 0.01; 0.19, 0.02, 0.31; 0.06, 0.1, 0.];');
H2 = [0.14, 0.07, 0.01; 0.19, 0.02, 0.31; 0.06, 0.1, 0.];
disp('>>> H = {H0, H1, H2};');
H = {H0, H1, H2};
disp('>>> moms = MarginalMomentsFromDMRAP(H);');
moms = MarginalMomentsFromDMRAP(H);
disp('>>> disp(moms);');
disp(moms);
disp('>>> jmom = LagkJointMomentsFromDMRAP(H, 3, 1);');
jmom = LagkJointMomentsFromDMRAP(H, 3, 1);
disp('>>> G = DMMAPFromDMRAP(H);');
G = DMMAPFromDMRAP(H);
disp('>>> disp(G{1});');
disp(G{1});
disp('>>> disp(G{2});');
disp(G{2});
disp('>>> disp(G{3});');
disp(G{3});
disp('>>> rmoms = MarginalMomentsFromDMMAP(G);');
rmoms = MarginalMomentsFromDMMAP(G);
disp('>>> disp(rmoms);');
disp(rmoms);
disp('>>> rjmom = LagkJointMomentsFromDMMAP(G, 3, 1);');
rjmom = LagkJointMomentsFromDMMAP(G, 3, 1);
disp('>>> err = norm(rjmom{1}-jmom{1})+norm(rjmom{2}-jmom{2});');
err = norm(rjmom{1}-jmom{1})+norm(rjmom{2}-jmom{2});
disp('>>> disp(err);');
disp(err);
disp('=== CanonicalFromDMAP2 ===')
disp('>>> D0 = [0.46, 0.28; 0.35, 0.23];');
D0 = [0.46, 0.28; 0.35, 0.23];
disp('>>> D1 = [0.08, 0.18; 0.14, 0.28];');
D1 = [0.08, 0.18; 0.14, 0.28];
disp('>>> [H0, H1] = CanonicalFromDMAP2(D0, D1);');
[H0, H1] = CanonicalFromDMAP2(D0, D1);
disp('>>> disp(H0);');
disp(H0);
disp('>>> disp(H1);');
disp(H1);
disp('>>> Cm = SimilarityMatrix(H0, D0);');
Cm = SimilarityMatrix(H0, D0);
disp('>>> err1 = norm(H0*Cm-Cm*D0);');
err1 = norm(H0*Cm-Cm*D0);
disp('>>> err2 = norm(H1*Cm-Cm*D1);');
err2 = norm(H1*Cm-Cm*D1);
disp('>>> disp(max(err1, err2));');
disp(max(err1, err2));
disp('>>> D0 = [0.26, 0.28; 0.35, 0.23];');
D0 = [0.26, 0.28; 0.35, 0.23];
disp('>>> D1 = [0.28, 0.18; 0.14, 0.28];');
D1 = [0.28, 0.18; 0.14, 0.28];
disp('>>> [H0, H1] = CanonicalFromDMAP2(D0, D1);');
[H0, H1] = CanonicalFromDMAP2(D0, D1);
disp('>>> disp(H0);');
disp(H0);
disp('>>> disp(H1);');
disp(H1);
disp('>>> Cm = SimilarityMatrix(H0, D0);');
Cm = SimilarityMatrix(H0, D0);
disp('>>> err1 = norm(H0*Cm-Cm*D0);');
err1 = norm(H0*Cm-Cm*D0);
disp('>>> err2 = norm(H1*Cm-Cm*D1);');
err2 = norm(H1*Cm-Cm*D1);
disp('>>> disp(max(err1, err2));');
disp(max(err1, err2));
disp('>>> D0 = [0.14, 0.34; 0.35, 0.23];');
D0 = [0.14, 0.34; 0.35, 0.23];
disp('>>> D1 = [0.22, 0.3; 0.28, 0.14];');
D1 = [0.22, 0.3; 0.28, 0.14];
disp('>>> [H0, H1] = CanonicalFromDMAP2(D0, D1);');
[H0, H1] = CanonicalFromDMAP2(D0, D1);
disp('>>> disp(H0);');
disp(H0);
disp('>>> disp(H1);');
disp(H1);
disp('>>> Cm = SimilarityMatrix(H0, D0);');
Cm = SimilarityMatrix(H0, D0);
disp('>>> err1 = norm(H0*Cm-Cm*D0);');
err1 = norm(H0*Cm-Cm*D0);
disp('>>> err2 = norm(H1*Cm-Cm*D1);');
err2 = norm(H1*Cm-Cm*D1);
disp('>>> disp(max(err1, err2));');
disp(max(err1, err2));
disp('=== DMAP2FromMoments ===')
disp('>>> D0 = [0.2, 0.7; 0.6, 0.1];');
D0 = [0.2, 0.7; 0.6, 0.1];
disp('>>> D1 = [0.09, 0.01; 0.2, 0.1];');
D1 = [0.09, 0.01; 0.2, 0.1];
disp('>>> moms = MarginalMomentsFromDMAP(D0, D1, 3);');
moms = MarginalMomentsFromDMAP(D0, D1, 3);
disp('>>> disp(moms);');
disp(moms);
disp('>>> corr = LagCorrelationsFromDMAP(D0, D1, 1);');
corr = LagCorrelationsFromDMAP(D0, D1, 1);
disp('>>> disp(corr);');
disp(corr);
disp('>>> [D0, D1] = DMAP2FromMoments(moms, corr);');
[D0, D1] = DMAP2FromMoments(moms, corr);
disp('>>> disp(D0);');
disp(D0);
disp('>>> disp(D1);');
disp(D1);
disp('>>> rmoms = MarginalMomentsFromDMAP(D0, D1, 3);');
rmoms = MarginalMomentsFromDMAP(D0, D1, 3);
disp('>>> disp(rmoms);');
disp(rmoms);
disp('>>> rcorr = LagCorrelationsFromDMAP(D0, D1, 1);');
rcorr = LagCorrelationsFromDMAP(D0, D1, 1);
disp('>>> disp(rcorr);');
disp(rcorr);
disp('=== SamplesFromDMAP ===')
disp('>>> D0 = [0, 0.02, 0, 0; 0, 0.17, 0.2, 0.14; 0.16, 0.17, 0.02, 0.18; 0, 0, 0, 0.12];');
D0 = [0, 0.02, 0, 0; 0, 0.17, 0.2, 0.14; 0.16, 0.17, 0.02, 0.18; 0, 0, 0, 0.12];
disp('>>> D1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];');
D1 = [0, 0.88, 0.1, 0; 0.18, 0.07, 0.14, 0.1; 0.13, 0.15, 0.15, 0.04; 0.31, 0.18, 0.12, 0.27];
disp('>>> x = SamplesFromDMAP(D0, D1, 10000);');
x = SamplesFromDMAP(D0, D1, 10000);
disp('>>> mt = MarginalMomentsFromTrace(x, 3);');
mt = MarginalMomentsFromTrace(x, 3);
disp('>>> disp(mt);');
disp(mt);
disp('>>> mm = MarginalMomentsFromDMAP(D0, D1, 3);');
mm = MarginalMomentsFromDMAP(D0, D1, 3);
disp('>>> disp(mm);');
disp(mm);
disp('=== SamplesFromDMMAP ===')
disp('>>> D0 = [0.34, 0, 0; 0.06, 0.05, 0.03; 0.11, 0.13, 0];');
D0 = [0.34, 0, 0; 0.06, 0.05, 0.03; 0.11, 0.13, 0];
disp('>>> D1 = [0.3, 0, 0; 0.16, 0.18, 0.05; 0.15, 0.04, 0.09];');
D1 = [0.3, 0, 0; 0.16, 0.18, 0.05; 0.15, 0.04, 0.09];
disp('>>> D2 = [0, 0.01, 0; 0.1, 0.07, 0.08; 0.13, 0.12, 0.13];');
D2 = [0, 0.01, 0; 0.1, 0.07, 0.08; 0.13, 0.12, 0.13];
disp('>>> D3 = [0.35, 0, 0; 0, 0.18, 0.04; 0.06, 0.03, 0.01];');
D3 = [0.35, 0, 0; 0, 0.18, 0.04; 0.06, 0.03, 0.01];
disp('>>> Dm = {D0, D1, D2, D3};');
Dm = {D0, D1, D2, D3};
disp('>>> x = SamplesFromDMMAP(Dm, 10000);');
x = SamplesFromDMMAP(Dm, 10000);
disp('>>> mt = MarginalMomentsFromTrace(x(1:end, 1), 3);');
mt = MarginalMomentsFromTrace(x(1:end, 1), 3);
disp('>>> disp(mt);');
disp(mt);
disp('>>> mm = MarginalMomentsFromDMMAP(Dm, 3);');
mm = MarginalMomentsFromDMMAP(Dm, 3);
disp('>>> disp(mm);');
disp(mm);

