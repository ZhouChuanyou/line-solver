clear all
run('/home/gabor/github/butools/Matlab/BuToolsInit.m')

disp('---BuTools: DPH package test file---');
disp('Enable the verbose messages with the BuToolsVerbose flag');
global BuToolsVerbose;
BuToolsVerbose = true;
disp('Enable input parameter checking with the BuToolsCheckInput flag');
global BuToolsCheckInput;
BuToolsCheckInput = true;
global BuToolsCheckPrecision;
format short g;
format compact
delete('/home/gabor/github/butools/test/docex/DPH_matlab.docex');
diary('/home/gabor/github/butools/test/docex/DPH_matlab.docex');
disp('=== MomentsFromMG ===')
disp('>>> a = [-0.6,0.3,1.3];');
a = [-0.6,0.3,1.3];
disp('>>> A = [0.25, 0.2, -0.15; 0.3, 0.1, 0.25; 0, 0.2, 0.47];');
A = [0.25, 0.2, -0.15; 0.3, 0.1, 0.25; 0, 0.2, 0.47];
disp('>>> moms = MomentsFromMG(a, A);');
moms = MomentsFromMG(a, A);
disp('>>> disp(moms);');
disp(moms);
disp('>>> moms = MomentsFromMG(a, A, 3);');
moms = MomentsFromMG(a, A, 3);
disp('>>> disp(moms);');
disp(moms);
disp('=== MomentsFromDPH ===')
disp('>>> a = [0.76,0,0.24];');
a = [0.76,0,0.24];
disp('>>> A = [0.34, 0.66, 0; 0.79, 0.05, 0.07; 0.26, 0.73, 0.01];');
A = [0.34, 0.66, 0; 0.79, 0.05, 0.07; 0.26, 0.73, 0.01];
disp('>>> moms = MomentsFromDPH(a, A, 5);');
moms = MomentsFromDPH(a, A, 5);
disp('>>> disp(moms);');
disp(moms);
disp('=== PmfFromMG ===')
disp('>>> a = [-0.6,0.3,1.3];');
a = [-0.6,0.3,1.3];
disp('>>> A = [0.25, 0.2, -0.15; 0.3, 0.1, 0.25; 0, 0.2, 0.47];');
A = [0.25, 0.2, -0.15; 0.3, 0.1, 0.25; 0, 0.2, 0.47];
disp('>>> x = (0.0:1.0:100.0);');
x = (0.0:1.0:100.0);
disp('>>> pmf = PmfFromMG(a, A, x);');
pmf = PmfFromMG(a, A, x);
disp('>>> plot(x, pmf)');
disp('=== PmfFromDPH ===')
disp('>>> a = [0.76,0,0.24];');
a = [0.76,0,0.24];
disp('>>> A = [0.34, 0.66, 0; 0.79, 0.05, 0.07; 0.26, 0.73, 0.01];');
A = [0.34, 0.66, 0; 0.79, 0.05, 0.07; 0.26, 0.73, 0.01];
disp('>>> x = (0.0:1.0:1000.0);');
x = (0.0:1.0:1000.0);
disp('>>> pmf = PmfFromDPH(a, A, x);');
pmf = PmfFromDPH(a, A, x);
disp('>>> plot(x, pmf)');
disp('=== CdfFromMG ===')
disp('>>> a = [-0.6,0.3,1.3];');
a = [-0.6,0.3,1.3];
disp('>>> A = [0.25, 0.2, -0.15; 0.3, 0.1, 0.25; 0, 0.2, 0.47];');
A = [0.25, 0.2, -0.15; 0.3, 0.1, 0.25; 0, 0.2, 0.47];
disp('>>> x = (0.0:1.0:100.0);');
x = (0.0:1.0:100.0);
disp('>>> cdf = CdfFromMG(a, A, x);');
cdf = CdfFromMG(a, A, x);
disp('>>> plot(x, cdf)');
disp('=== CdfFromDPH ===')
disp('>>> a = [0.76,0,0.24];');
a = [0.76,0,0.24];
disp('>>> A = [0.34, 0.66, 0; 0.79, 0.05, 0.07; 0.26, 0.73, 0.01];');
A = [0.34, 0.66, 0; 0.79, 0.05, 0.07; 0.26, 0.73, 0.01];
disp('>>> x = (0.0:1.0:1000.0);');
x = (0.0:1.0:1000.0);
disp('>>> cdf = CdfFromDPH(a, A, x);');
cdf = CdfFromDPH(a, A, x);
disp('>>> plot(x, cdf)');
disp('=== RandomDPH ===')
disp('>>> [a, A] = RandomDPH(3, 10, 5);');
[a, A] = RandomDPH(3, 10, 5);
disp('>>> disp(a);');
disp(a);
disp('>>> disp(A);');
disp(A);
disp('=== CheckMGRepresentation ===')
disp('>>> a = [-0.6,0.3,1.3];');
a = [-0.6,0.3,1.3];
disp('>>> A = [0.25, 0.2, -0.15; 0.3, 0.1, 0.25; 0, 0.2, 0.47];');
A = [0.25, 0.2, -0.15; 0.3, 0.1, 0.25; 0, 0.2, 0.47];
disp('>>> flag = CheckMGRepresentation(a, A);');
flag = CheckMGRepresentation(a, A);
disp('>>> disp(flag);');
disp(flag);
disp('>>> a = [-0.6,0.3,1.3];');
a = [-0.6,0.3,1.3];
disp('>>> A = [0.35, 0.2, -0.25; 0.3, 0.1, 0.25; 0, 0.2, 0.47];');
A = [0.35, 0.2, -0.25; 0.3, 0.1, 0.25; 0, 0.2, 0.47];
disp('>>> flag = CheckMGRepresentation(a, A);');
flag = CheckMGRepresentation(a, A);
disp('>>> disp(flag);');
disp(flag);
disp('=== CheckDPHRepresentation ===')
disp('>>> a = [0.48,0.08,0.26,0.18];');
a = [0.48,0.08,0.26,0.18];
disp('>>> A = [0, 0.08, 0.08, 0.8; 0.55, 0, 0.24, 0.19; 0.06, 0.03, 0, 0.001; 0.23, 0.005, 0.2, 0.53];');
A = [0, 0.08, 0.08, 0.8; 0.55, 0, 0.24, 0.19; 0.06, 0.03, 0, 0.001; 0.23, 0.005, 0.2, 0.53];
disp('>>> flag = CheckDPHRepresentation(a, A);');
flag = CheckDPHRepresentation(a, A);
disp('>>> disp(flag);');
disp(flag);
disp('>>> a = [0.48,0.08];');
a = [0.48,0.08];
disp('>>> A = [0, 0.08; 0.55, 0.5];');
A = [0, 0.08; 0.55, 0.5];
disp('>>> flag = CheckDPHRepresentation(a, A);');
flag = CheckDPHRepresentation(a, A);
disp('>>> disp(flag);');
disp(flag);
disp('=== MGFromMoments ===')
disp('>>> moms = [4.08, 20.41, 130.45, 1054.41, 10463.73];');
moms = [4.08, 20.41, 130.45, 1054.41, 10463.73];
disp('>>> [a, A] = MGFromMoments(moms);');
[a, A] = MGFromMoments(moms);
disp('>>> disp(a);');
disp(a);
disp('>>> disp(A);');
disp(A);
disp('>>> memoms = MomentsFromMG(a, A, 5);');
memoms = MomentsFromMG(a, A, 5);
disp('>>> disp(memoms);');
disp(memoms);
disp('=== DPHFromMG ===')
disp('>>> a = [-0.6,0.3,1.3];');
a = [-0.6,0.3,1.3];
disp('>>> A = [0.1, 0.2, 0; 0.3, 0.1, 0.25; -0.3, 0.2, 0.77];');
A = [0.1, 0.2, 0; 0.3, 0.1, 0.25; -0.3, 0.2, 0.77];
disp('>>> flag = CheckMGRepresentation(a, A);');
flag = CheckMGRepresentation(a, A);
disp('>>> disp(flag);');
disp(flag);
disp('>>> flag = CheckDPHRepresentation(a, A);');
flag = CheckDPHRepresentation(a, A);
disp('>>> disp(flag);');
disp(flag);
disp('>>> [b, B] = DPHFromMG(a, A);');
[b, B] = DPHFromMG(a, A);
disp('>>> disp(b);');
disp(b);
disp('>>> disp(B);');
disp(B);
disp('>>> flag = CheckDPHRepresentation(b, B);');
flag = CheckDPHRepresentation(b, B);
disp('>>> disp(flag);');
disp(flag);
disp('>>> Cm = SimilarityMatrix(A, B);');
Cm = SimilarityMatrix(A, B);
disp('>>> err1 = norm(A*Cm-Cm*B);');
err1 = norm(A*Cm-Cm*B);
disp('>>> err2 = norm(a*Cm-b);');
err2 = norm(a*Cm-b);
disp('>>> disp(max(err1, err2));');
disp(max(err1, err2));
disp('=== CanonicalFromDPH2 ===')
disp('>>> a = [0,1.0];');
a = [0,1.0];
disp('>>> A = [0.23, 0.22; 0.41, 0.48];');
A = [0.23, 0.22; 0.41, 0.48];
disp('>>> [b, B] = CanonicalFromDPH2(a, A);');
[b, B] = CanonicalFromDPH2(a, A);
disp('>>> disp(b);');
disp(b);
disp('>>> disp(B);');
disp(B);
disp('>>> ev = eig(A);');
ev = eig(A);
disp('>>> disp(ev);');
disp(ev);
disp('>>> flag = CheckDPHRepresentation(b, B);');
flag = CheckDPHRepresentation(b, B);
disp('>>> disp(flag);');
disp(flag);
disp('>>> Cm = SimilarityMatrix(A, B);');
Cm = SimilarityMatrix(A, B);
disp('>>> err1 = norm(A*Cm-Cm*B);');
err1 = norm(A*Cm-Cm*B);
disp('>>> err2 = norm(a*Cm-b);');
err2 = norm(a*Cm-b);
disp('>>> a = [1.0,0];');
a = [1.0,0];
disp('>>> A = [0, 0.61; 0.56, 0.44];');
A = [0, 0.61; 0.56, 0.44];
disp('>>> [b, B] = CanonicalFromDPH2(a, A);');
[b, B] = CanonicalFromDPH2(a, A);
disp('>>> disp(b);');
disp(b);
disp('>>> disp(B);');
disp(B);
disp('>>> ev = eig(A);');
ev = eig(A);
disp('>>> disp(ev);');
disp(ev);
disp('>>> flag = CheckDPHRepresentation(b, B);');
flag = CheckDPHRepresentation(b, B);
disp('>>> disp(flag);');
disp(flag);
disp('>>> Cm = SimilarityMatrix(A, B);');
Cm = SimilarityMatrix(A, B);
disp('>>> err1 = norm(A*Cm-Cm*B);');
err1 = norm(A*Cm-Cm*B);
disp('>>> err2 = norm(a*Cm-b);');
err2 = norm(a*Cm-b);
disp('>>> disp(max(err1, err2));');
disp(max(err1, err2));
disp('=== CanonicalFromDPH3 ===')
disp('>>> a = [0.46,0.22,0.32];');
a = [0.46,0.22,0.32];
disp('>>> A = [0.67, 0.01, 0.12; 0.06, 0.45, 0.15; 0.18, 0.43, 0.32];');
A = [0.67, 0.01, 0.12; 0.06, 0.45, 0.15; 0.18, 0.43, 0.32];
disp('>>> [b, B] = CanonicalFromDPH3(a, A);');
[b, B] = CanonicalFromDPH3(a, A);
disp('>>> disp(b);');
disp(b);
disp('>>> disp(B);');
disp(B);
disp('>>> ev = eig(A);');
ev = eig(A);
disp('>>> disp(ev);');
disp(ev);
disp('>>> flag = CheckDPHRepresentation(b, B);');
flag = CheckDPHRepresentation(b, B);
disp('>>> disp(flag);');
disp(flag);
disp('>>> Cm = SimilarityMatrix(A, B);');
Cm = SimilarityMatrix(A, B);
disp('>>> err1 = norm(A*Cm-Cm*B);');
err1 = norm(A*Cm-Cm*B);
disp('>>> err2 = norm(a*Cm-b);');
err2 = norm(a*Cm-b);
disp('>>> disp(max(err1, err2));');
disp(max(err1, err2));
disp('>>> a = [0.76,0.12,0.12];');
a = [0.76,0.12,0.12];
disp('>>> A = [0.31, 0., 0.; 0.98, 0., 0.02; 0.88, 0.04, 0.08];');
A = [0.31, 0., 0.; 0.98, 0., 0.02; 0.88, 0.04, 0.08];
disp('>>> [b, B] = CanonicalFromDPH3(a, A);');
[b, B] = CanonicalFromDPH3(a, A);
disp('>>> disp(b);');
disp(b);
disp('>>> disp(B);');
disp(B);
disp('>>> ev = eig(A);');
ev = eig(A);
disp('>>> disp(ev);');
disp(ev);
disp('>>> flag = CheckDPHRepresentation(b, B);');
flag = CheckDPHRepresentation(b, B);
disp('>>> disp(flag);');
disp(flag);
disp('>>> Cm = SimilarityMatrix(A, B);');
Cm = SimilarityMatrix(A, B);
disp('>>> err1 = norm(A*Cm-Cm*B);');
err1 = norm(A*Cm-Cm*B);
disp('>>> err2 = norm(a*Cm-b);');
err2 = norm(a*Cm-b);
disp('>>> disp(max(err1, err2));');
disp(max(err1, err2));
disp('>>> a = [0.67,0.07,0.26];');
a = [0.67,0.07,0.26];
disp('>>> A = [0.31, 0., 0.; 0.98, 0., 0.02; 0.88, 0.04, 0.08];');
A = [0.31, 0., 0.; 0.98, 0., 0.02; 0.88, 0.04, 0.08];
disp('>>> [b, B] = CanonicalFromDPH3(a, A);');
[b, B] = CanonicalFromDPH3(a, A);
disp('>>> disp(b);');
disp(b);
disp('>>> disp(B);');
disp(B);
disp('>>> ev = eig(A);');
ev = eig(A);
disp('>>> disp(ev);');
disp(ev);
disp('>>> flag = CheckDPHRepresentation(b, B);');
flag = CheckDPHRepresentation(b, B);
disp('>>> disp(flag);');
disp(flag);
disp('>>> Cm = SimilarityMatrix(A, B);');
Cm = SimilarityMatrix(A, B);
disp('>>> err1 = norm(A*Cm-Cm*B);');
err1 = norm(A*Cm-Cm*B);
disp('>>> err2 = norm(a*Cm-b);');
err2 = norm(a*Cm-b);
disp('>>> disp(max(err1, err2));');
disp(max(err1, err2));
disp('>>> a = [0.78,0.04,0.18];');
a = [0.78,0.04,0.18];
disp('>>> A = [0.06, 0.25, 0.31; 0.45, 0.18, 0.33; 0.98, 0, 0.01];');
A = [0.06, 0.25, 0.31; 0.45, 0.18, 0.33; 0.98, 0, 0.01];
disp('>>> [b, B] = CanonicalFromDPH3(a, A);');
[b, B] = CanonicalFromDPH3(a, A);
disp('>>> disp(b);');
disp(b);
disp('>>> disp(B);');
disp(B);
disp('>>> ev = eig(A);');
ev = eig(A);
disp('>>> disp(ev);');
disp(ev);
disp('>>> flag = CheckDPHRepresentation(b, B);');
flag = CheckDPHRepresentation(b, B);
disp('>>> disp(flag);');
disp(flag);
disp('>>> Cm = SimilarityMatrix(A, B);');
Cm = SimilarityMatrix(A, B);
disp('>>> err1 = norm(A*Cm-Cm*B);');
err1 = norm(A*Cm-Cm*B);
disp('>>> err2 = norm(a*Cm-b);');
err2 = norm(a*Cm-b);
disp('>>> disp(max(err1, err2));');
disp(max(err1, err2));
disp('=== AcyclicDPHFromMG ===')
disp('>>> a = [0,0,1.0];');
a = [0,0,1.0];
disp('>>> A = [0.22, 0, 0; 0.3, 0.1, 0.55; 0.26, 0, 0.73];');
A = [0.22, 0, 0; 0.3, 0.1, 0.55; 0.26, 0, 0.73];
disp('>>> [b, B] = AcyclicDPHFromMG(a, A);');
[b, B] = AcyclicDPHFromMG(a, A);
disp('>>> disp(b);');
disp(b);
disp('>>> disp(B);');
disp(B);
disp('>>> ma = MomentsFromMG(a, A, 5);');
ma = MomentsFromMG(a, A, 5);
disp('>>> disp(ma);');
disp(ma);
disp('>>> mb = MomentsFromMG(b, B, 5);');
mb = MomentsFromMG(b, B, 5);
disp('>>> disp(mb);');
disp(mb);
disp('>>> flag = CheckDPHRepresentation(b, B);');
flag = CheckDPHRepresentation(b, B);
disp('>>> disp(flag);');
disp(flag);
disp('>>> Cm = SimilarityMatrix(A, B);');
Cm = SimilarityMatrix(A, B);
disp('>>> err1 = norm(A*Cm-Cm*B);');
err1 = norm(A*Cm-Cm*B);
disp('>>> err2 = norm(a*Cm-b);');
err2 = norm(a*Cm-b);
disp('>>> disp(max(err1, err2));');
disp(max(err1, err2));
disp('=== DPH2From3Moments ===')
disp('>>> a = [0.9,0.1];');
a = [0.9,0.1];
disp('>>> A = [0.2, 0.61; 0.58, 0.41];');
A = [0.2, 0.61; 0.58, 0.41];
disp('>>> moms = MomentsFromDPH(a, A);');
moms = MomentsFromDPH(a, A);
disp('>>> disp(moms);');
disp(moms);
disp('>>> [b, B] = DPH2From3Moments(moms);');
[b, B] = DPH2From3Moments(moms);
disp('>>> disp(b);');
disp(b);
disp('>>> disp(B);');
disp(B);
disp('>>> phmoms = MomentsFromDPH(b, B, 3);');
phmoms = MomentsFromDPH(b, B, 3);
disp('>>> disp(phmoms);');
disp(phmoms);
disp('=== DPH3From5Moments ===')
disp('>>> a = [0.7,0.1,0.2];');
a = [0.7,0.1,0.2];
disp('>>> A = [0.2, 0.51, 0.1; 0.58, 0.41, 0; 0.1, 0.4, 0.3];');
A = [0.2, 0.51, 0.1; 0.58, 0.41, 0; 0.1, 0.4, 0.3];
disp('>>> moms = MomentsFromDPH(a, A);');
moms = MomentsFromDPH(a, A);
disp('>>> disp(moms);');
disp(moms);
disp('>>> [b, B] = DPH3From5Moments(moms);');
[b, B] = DPH3From5Moments(moms);
disp('>>> disp(b);');
disp(b);
disp('>>> disp(B);');
disp(B);
disp('>>> phmoms = MomentsFromMG(b, B, 5);');
phmoms = MomentsFromMG(b, B, 5);
disp('>>> disp(phmoms);');
disp(phmoms);
disp('=== SamplesFromDPH ===')
disp('>>> a = [0.76,0,0.24];');
a = [0.76,0,0.24];
disp('>>> A = [0.34, 0.66, 0; 0.79, 0.05, 0.07; 0.26, 0.73, 0.01];');
A = [0.34, 0.66, 0; 0.79, 0.05, 0.07; 0.26, 0.73, 0.01];
disp('>>> x = SamplesFromDPH(a, A, 1000);');
x = SamplesFromDPH(a, A, 1000);
disp('>>> mt = MarginalMomentsFromTrace(x, 3);');
mt = MarginalMomentsFromTrace(x, 3);
disp('>>> disp(mt);');
disp(mt);
disp('>>> mp = MomentsFromDPH(a, A, 3);');
mp = MomentsFromDPH(a, A, 3);
disp('>>> disp(mp);');
disp(mp);

