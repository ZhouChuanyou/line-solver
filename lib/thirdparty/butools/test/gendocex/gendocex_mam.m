clear all
run('/home/gabor/github/butools/Matlab/BuToolsInit.m')

disp('---BuTools: MAM package test file---');
disp('Enable the verbose messages with the BuToolsVerbose flag');
global BuToolsVerbose;
BuToolsVerbose = true;
disp('Enable input parameter checking with the BuToolsCheckInput flag');
global BuToolsCheckInput;
BuToolsCheckInput = true;
global BuToolsCheckPrecision;
format short g;
format compact
delete('/home/gabor/github/butools/test/docex/MAM_matlab.docex');
diary('/home/gabor/github/butools/test/docex/MAM_matlab.docex');
disp('=== QBDFundamentalMatrices ===')
disp('>>> B = [0., 0.; 3., 4.];');
B = [0., 0.; 3., 4.];
disp('>>> L = [-6., 5.; 3., -12.];');
L = [-6., 5.; 3., -12.];
disp('>>> F = [1., 0.; 2., 0.];');
F = [1., 0.; 2., 0.];
disp('>>> L0 = [-6., 5.; 6., -8.];');
L0 = [-6., 5.; 6., -8.];
disp('>>> [R, G, U] = QBDFundamentalMatrices(B, L, F, ''RGU'');');
[R, G, U] = QBDFundamentalMatrices(B, L, F, 'RGU');
disp('>>> disp(R);');
disp(R);
disp('>>> disp(G);');
disp(G);
disp('>>> disp(U);');
disp(U);
disp('=== QBDSolve ===')
disp('>>> B = [0., 0.; 3., 4.];');
B = [0., 0.; 3., 4.];
disp('>>> L = [-6., 5.; 3., -12.];');
L = [-6., 5.; 3., -12.];
disp('>>> F = [1., 0.; 2., 0.];');
F = [1., 0.; 2., 0.];
disp('>>> L0 = [-6., 5.; 6., -8.];');
L0 = [-6., 5.; 6., -8.];
disp('>>> [pi0, R] = QBDSolve(B, L, F, L0);');
[pi0, R] = QBDSolve(B, L, F, L0);
disp('>>> disp(pi0);');
disp(pi0);
disp('>>> disp(R);');
disp(R);
disp('=== QBDStationaryDistr ===')
disp('>>> B = [0., 0.; 3., 4.];');
B = [0., 0.; 3., 4.];
disp('>>> L = [-6., 5.; 3., -12.];');
L = [-6., 5.; 3., -12.];
disp('>>> F = [1., 0.; 2., 0.];');
F = [1., 0.; 2., 0.];
disp('>>> L0 = [-6., 5.; 6., -8.];');
L0 = [-6., 5.; 6., -8.];
disp('>>> pi = QBDStationaryDistr(pi0, R, 5);');
pi = QBDStationaryDistr(pi0, R, 5);
disp('>>> disp(pi);');
disp(pi);
disp('=== MG1FundamentalMatrix ===')
disp('>>> A0 = [0.4, 0.2; 0.3, 0.4];');
A0 = [0.4, 0.2; 0.3, 0.4];
disp('>>> A1 = [0., 0.1; 0., 0.];');
A1 = [0., 0.1; 0., 0.];
disp('>>> A2 = [0., 0.2; 0., 0.2];');
A2 = [0., 0.2; 0., 0.2];
disp('>>> A3 = [0.1, 0.; 0.1, 0.];');
A3 = [0.1, 0.; 0.1, 0.];
disp('>>> A = {A0, A1, A2, A3};');
A = {A0, A1, A2, A3};
disp('>>> G = MG1FundamentalMatrix(A);');
G = MG1FundamentalMatrix(A);
disp('>>> disp(G);');
disp(G);
disp('=== MG1StationaryDistr ===')
disp('>>> B0 = [0.1, 0.5; 0.3, 0.4];');
B0 = [0.1, 0.5; 0.3, 0.4];
disp('>>> B1 = [0., 0.1; 0., 0.];');
B1 = [0., 0.1; 0., 0.];
disp('>>> B2 = [0.2, 0.; 0., 0.2];');
B2 = [0.2, 0.; 0., 0.2];
disp('>>> B3 = [0., 0.1; 0.1, 0.];');
B3 = [0., 0.1; 0.1, 0.];
disp('>>> A0 = [0.4, 0.2; 0.3, 0.4];');
A0 = [0.4, 0.2; 0.3, 0.4];
disp('>>> A1 = [0., 0.1; 0., 0.];');
A1 = [0., 0.1; 0., 0.];
disp('>>> A2 = [0., 0.2; 0., 0.2];');
A2 = [0., 0.2; 0., 0.2];
disp('>>> A3 = [0.1, 0.; 0.1, 0.];');
A3 = [0.1, 0.; 0.1, 0.];
disp('>>> B = {B0, B1, B2, B3};');
B = {B0, B1, B2, B3};
disp('>>> A = {A0, A1, A2, A3};');
A = {A0, A1, A2, A3};
disp('>>> G = MG1FundamentalMatrix(A);');
G = MG1FundamentalMatrix(A);
disp('>>> disp(G);');
disp(G);
disp('>>> pi = MG1StationaryDistr(A, B, G, 300);');
pi = MG1StationaryDistr(A, B, G, 300);
disp('=== GM1FundamentalMatrix ===')
disp('>>> A0 = [0.1, 0.; 0., 0.1];');
A0 = [0.1, 0.; 0., 0.1];
disp('>>> A1 = [0., 0.2; 0., 0.2];');
A1 = [0., 0.2; 0., 0.2];
disp('>>> A2 = [0., 0.1; 0., 0.];');
A2 = [0., 0.1; 0., 0.];
disp('>>> A3 = [0.3, 0.2; 0.3, 0.2];');
A3 = [0.3, 0.2; 0.3, 0.2];
disp('>>> A4 = [0., 0.1; 0.2, 0.];');
A4 = [0., 0.1; 0.2, 0.];
disp('>>> A = {A0, A1, A2, A3, A4};');
A = {A0, A1, A2, A3, A4};
disp('>>> R = GM1FundamentalMatrix(A);');
R = GM1FundamentalMatrix(A);
disp('>>> disp(R);');
disp(R);
disp('=== GM1StationaryDistr ===')
disp('>>> B0 = [0.7, 0.2; 0.3, 0.6];');
B0 = [0.7, 0.2; 0.3, 0.6];
disp('>>> B1 = [0.3, 0.4; 0.5, 0.2];');
B1 = [0.3, 0.4; 0.5, 0.2];
disp('>>> B2 = [0.2, 0.4; 0.1, 0.6];');
B2 = [0.2, 0.4; 0.1, 0.6];
disp('>>> B3 = [0., 0.1; 0.2, 0.];');
B3 = [0., 0.1; 0.2, 0.];
disp('>>> A0 = [0.1, 0.; 0., 0.1];');
A0 = [0.1, 0.; 0., 0.1];
disp('>>> A1 = [0., 0.2; 0., 0.2];');
A1 = [0., 0.2; 0., 0.2];
disp('>>> A2 = [0., 0.1; 0., 0.];');
A2 = [0., 0.1; 0., 0.];
disp('>>> A3 = [0.3, 0.2; 0.3, 0.2];');
A3 = [0.3, 0.2; 0.3, 0.2];
disp('>>> A4 = [0., 0.1; 0.2, 0.];');
A4 = [0., 0.1; 0.2, 0.];
disp('>>> B = {B0, B1, B2, B3};');
B = {B0, B1, B2, B3};
disp('>>> A = {A0, A1, A2, A3, A4};');
A = {A0, A1, A2, A3, A4};
disp('>>> R = GM1FundamentalMatrix(A);');
R = GM1FundamentalMatrix(A);
disp('>>> disp(R);');
disp(R);
disp('>>> pi = GM1StationaryDistr(B, R, 300);');
pi = GM1StationaryDistr(B, R, 300);
disp('=== FluidFundamentalMatrices ===')
disp('>>> Fpp = [-5., 1.; 2., -3.];');
Fpp = [-5., 1.; 2., -3.];
disp('>>> Fpm = [2., 1., 1.; 1., 0., 0.];');
Fpm = [2., 1., 1.; 1., 0., 0.];
disp('>>> Fmm = [-8., 4., 1.; 2., -12., 3.; 2., 0., -2.];');
Fmm = [-8., 4., 1.; 2., -12., 3.; 2., 0., -2.];
disp('>>> Fmp = [3., 0.; 2., 5.; 0., 0.];');
Fmp = [3., 0.; 2., 5.; 0., 0.];
disp('>>> [Psi, K, U] = FluidFundamentalMatrices(Fpp, Fpm, Fmp, Fmm, ''PKU'');');
[Psi, K, U] = FluidFundamentalMatrices(Fpp, Fpm, Fmp, Fmm, 'PKU');
disp('>>> disp(Psi);');
disp(Psi);
disp('>>> disp(K);');
disp(K);
disp('>>> disp(U);');
disp(U);
disp('=== FluidSolve ===')
disp('>>> Fpp = [-5., 1.; 2., -3.];');
Fpp = [-5., 1.; 2., -3.];
disp('>>> Fpm = [2., 1., 1.; 1., 0., 0.];');
Fpm = [2., 1., 1.; 1., 0., 0.];
disp('>>> Fmm = [-8., 4., 1.; 2., -12., 3.; 2., 0., -2.];');
Fmm = [-8., 4., 1.; 2., -12., 3.; 2., 0., -2.];
disp('>>> Fmp = [3., 0.; 2., 5.; 0., 0.];');
Fmp = [3., 0.; 2., 5.; 0., 0.];
disp('>>> x = 0.7;');
x = 0.7;
disp('>>> [mass0, ini, K, clo] = FluidSolve(Fpp, Fpm, Fmp, Fmm);');
[mass0, ini, K, clo] = FluidSolve(Fpp, Fpm, Fmp, Fmm);
disp('>>> disp(mass0);');
disp(mass0);
disp('>>> disp(ini);');
disp(ini);
disp('>>> disp(K);');
disp(K);
disp('>>> disp(clo);');
disp(clo);
disp('>>> pdfAtX = ini*expm(K*x)*clo;');
pdfAtX = ini*expm(K*x)*clo;
disp('>>> disp(pdfAtX);');
disp(pdfAtX);
disp('=== GeneralFluidSolve ===')
disp('>>> Q = [-6., 1., 3., 2., 0., 0.; 6., -10., 2., 0., 2., 0.; 3., 7., -12., 0., 0., 2.; 5., 0., 0., -9., 1., 3.; 0., 5., 0., 6., -13., 2.; 0., 0., 5., 3., 7., -15.];');
Q = [-6., 1., 3., 2., 0., 0.; 6., -10., 2., 0., 2., 0.; 3., 7., -12., 0., 0., 2.; 5., 0., 0., -9., 1., 3.; 0., 5., 0., 6., -13., 2.; 0., 0., 5., 3., 7., -15.];
disp('>>> R = [2., 0., 0., 0., 0., 0.; 0., -4., 0., 0., 0., 0.; 0., 0., -12., 0., 0., 0.; 0., 0., 0., 6., 0., 0.; 0., 0., 0., 0., 0., 0.; 0., 0., 0., 0., 0., -8.];');
R = [2., 0., 0., 0., 0., 0.; 0., -4., 0., 0., 0., 0.; 0., 0., -12., 0., 0., 0.; 0., 0., 0., 6., 0., 0.; 0., 0., 0., 0., 0., 0.; 0., 0., 0., 0., 0., -8.];
disp('>>> x = 0.7;');
x = 0.7;
disp('>>> [mass0, ini, K, clo] = GeneralFluidSolve(Q, R);');
[mass0, ini, K, clo] = GeneralFluidSolve(Q, R);
disp('>>> disp(mass0);');
disp(mass0);
disp('>>> disp(ini);');
disp(ini);
disp('>>> disp(K);');
disp(K);
disp('>>> disp(clo);');
disp(clo);
disp('>>> pdfAtX = ini*expm(K*x)*clo;');
pdfAtX = ini*expm(K*x)*clo;
disp('>>> disp(pdfAtX);');
disp(pdfAtX);
disp('=== FluidStationaryDistr ===')
disp('>>> Q = [-6., 1., 3., 2., 0., 0.; 6., -10., 2., 0., 2., 0.; 3., 7., -12., 0., 0., 2.; 5., 0., 0., -9., 1., 3.; 0., 5., 0., 6., -13., 2.; 0., 0., 5., 3., 7., -15.];');
Q = [-6., 1., 3., 2., 0., 0.; 6., -10., 2., 0., 2., 0.; 3., 7., -12., 0., 0., 2.; 5., 0., 0., -9., 1., 3.; 0., 5., 0., 6., -13., 2.; 0., 0., 5., 3., 7., -15.];
disp('>>> R = [2., 0., 0., 0., 0., 0.; 0., -4., 0., 0., 0., 0.; 0., 0., -12., 0., 0., 0.; 0., 0., 0., 6., 0., 0.; 0., 0., 0., 0., 0., 0.; 0., 0., 0., 0., 0., -8.];');
R = [2., 0., 0., 0., 0., 0.; 0., -4., 0., 0., 0., 0.; 0., 0., -12., 0., 0., 0.; 0., 0., 0., 6., 0., 0.; 0., 0., 0., 0., 0., 0.; 0., 0., 0., 0., 0., -8.];
disp('>>> x = (0.0:1.0:30.0);');
x = (0.0:1.0:30.0);
disp('>>> [mass0, ini, K, clo] = GeneralFluidSolve(Q, R);');
[mass0, ini, K, clo] = GeneralFluidSolve(Q, R);
disp('>>> disp(mass0);');
disp(mass0);
disp('>>> disp(ini);');
disp(ini);
disp('>>> disp(K);');
disp(K);
disp('>>> disp(clo);');
disp(clo);
disp('>>> y = FluidStationaryDistr(mass0, ini, K, clo, x);');
y = FluidStationaryDistr(mass0, ini, K, clo, x);
disp('>>> disp(y);');
disp(y);
pi = CTMCSolve(Q);

