"=== SimilarityMatrix ==="
>>> A1m = {{0.2, 0.8, 0.},{1.2, -0.4, 0.1},{-0.2, 0.7, 0.5}};
>>> T = {{1., 2., -4., 6.},{0., 8., -9., 7.},{-3., 7., 8., -2.}};
>>> A2m = PseudoInverse[T].A1m.T;
>>> B = SimilarityMatrix[A1m, A2m];
>>> err = Norm[A1m.B-B.A2m];
>>> Print[err];
1.0553656492422553*^-15
"=== TransformToAcyclic ==="
>>> A = {{-0.8, 0.8, 0.},{0.1, -0.3, 0.1},{0.2, 0., -0.5}};
>>> B = TransformToAcyclic[A];
>>> Print[B];
{{-0.12030366824989391, 0.12030366824989391, 0},
 {0, -0.6157989613063427, 0.6157989613063427},
 {0, 0, -0.8638973704437634}}
>>> Cm = SimilarityMatrix[A, B];
>>> err = Norm[A.Cm-Cm.B];
>>> Print[err];
3.2936898311300537*^-16
"=== TransformToMonocyclic ==="
>>> A = {{-1, 0, 0},{0, -3, 2},{0, -2, -3}};
>>> B = TransformToMonocyclic[A];
>>> Print[B];
{{-1, 1, 0, 0, 0},
 {0, -3, 3, 0, 0},
 {0, 0, -3, 3, 0},
 {0, 0, 0, -3, 3},
 {0, 16/27, 0, 0, -3}}
>>> Cm = SimilarityMatrix[A, B];
>>> err = Norm[A.Cm-Cm.B];
>>> Print[err];
0
"=== ExtendToMarkovian ==="
>>> alpha = {0.2,0.3,0.5};
>>> A = {{-1., 0., 0.},{0., -3., 0.6},{0., -0.6, -3.}};
>>> B = TransformToMonocyclic[A];
>>> Print[B];
{{-1., 1., 0, 0},
 {0, -2.6535898384862247, 2.6535898384862247, 0},
 {0, 0, -2.6535898384862247, 2.6535898384862247},
 {0, 0.047227424799192015, 0, -2.6535898384862247}}
>>> Cm = SimilarityMatrix[A, B];
>>> beta = alpha.Cm;
>>> Print[beta];
{0.0456492140620947, -0.0004383562608946817, -0.08881092881059305, 1.0436000710093931}
>>> {m, M} = ExtendToMarkovian[beta, B];
>>> Print[m];
{0.015398906730148602, 0.010192332530307258, 0.017620759235113224, 0.018114065982724338, 0.008799081502100216, 0.10332742932145772, 0.8265474246981488}
>>> Print[M];
{{-1., 1., 0., 0., 0., 0., 0.},
 {0., -2.6535898384862247, 2.6535898384862247, 0., 0., 0., 0.},
 {0., 0., -2.6535898384862247, 2.6535898384862247, 0., 0., 0.},
 {0., 0.047227424799192015, 0., -2.6535898384862247, 2.6063624136870325, 0., 0.},
 {0., 0., 0., 0., -3.290797259447432, 3.290797259447432, 0.},
 {0., 0., 0., 0., 0., -3.290797259447432, 3.290797259447432},
 {0., 0., 0., 0., 0., 0., -3.290797259447432}}
>>> Cm = SimilarityMatrix[B, M];
>>> err = Norm[B.Cm-Cm.M];
>>> Print[err];
2.7864548696465478*^-15
"=== SimilarityMatrixForVectors ==="
>>> vecA = {{0.0},{0.3},{-1.5},{0.0}};
>>> vecB = {{1.0},{0.2},{0.0},{1.0}};
>>> B = SimilarityMatrixForVectors[vecA, vecB];
>>> Print[B];
{{0., 3.3333333333333335, 0., 0.},
 {0.6666666666666667, 0.6666666666666667, 0., 0.},
 {0., 0., 0., 0.},
 {-0.8333333333333334, -0.8333333333333334, -0.8333333333333334, -0.8333333333333334}}
>>> err = Norm[B.vecA-vecB];
>>> Print[err];
0.
