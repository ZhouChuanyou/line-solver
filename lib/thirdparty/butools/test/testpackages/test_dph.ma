ClearAll["Global`*"]
AppendTo[$Path,"/home/gabor/github/butools/Mathematica"];
<<BuTools`
Print["---BuTools: DPH package test file---"//OutputForm];
Print["Enable the verbose messages with the BuToolsVerbose flag"//OutputForm];
BuTools`Verbose = True;
Print["Enable input parameter checking with the BuToolsCheckInput flag"//OutputForm];
BuTools`CheckInput = true;
On[Assert];
Print["========================================"]
Print["Testing BuTools function MomentsFromMG"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {-0.6,0.3,1.3};
Print["a = "//OutputForm];
Print[a];
A = {{0.25, 0.2, -0.15},{0.3, 0.1, 0.25},{0, 0.2, 0.47}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["moms = MomentsFromMG[a, A];:"//OutputForm];
moms = MomentsFromMG[a, A];
Print["moms = "//OutputForm];
Print[moms];
Assert[CheckMoments[moms]==True, "The function returned invalid moments!"];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["moms = MomentsFromMG[a, A, 3];:"//OutputForm];
moms = MomentsFromMG[a, A, 3];
Print["moms = "//OutputForm];
Print[moms];
Assert[CheckMoments[moms]==True, "The function returned invalid moments!"];
Print["========================================"]
Print["Testing BuTools function MomentsFromDPH"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {0.76,0,0.24};
Print["a = "//OutputForm];
Print[a];
A = {{0.34, 0.66, 0},{0.79, 0.05, 0.07},{0.26, 0.73, 0.01}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["moms = MomentsFromDPH[a, A, 5];:"//OutputForm];
moms = MomentsFromDPH[a, A, 5];
Print["moms = "//OutputForm];
Print[moms];
Assert[CheckMoments[moms]==True, "The function returned invalid moments!"];
Print["========================================"]
Print["Testing BuTools function PmfFromMG"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {-0.6,0.3,1.3};
Print["a = "//OutputForm];
Print[a];
A = {{0.25, 0.2, -0.15},{0.3, 0.1, 0.25},{0, 0.2, 0.47}};
Print["A = "//OutputForm];
Print[A];
x = Range[0.0,100.0,1.0];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["pmf = PmfFromMG[a, A, x];:"//OutputForm];
pmf = PmfFromMG[a, A, x];
ListLinePlot[{Transpose[{x, pmf}]}]
Assert[AllTrue[pmf,#>=-10^-14 &], "PmfFromMG returned negative pmf!"];
Assert[Abs[Dot[x, pmf]-MomentsFromMG[a, A, 1][[1]]]<10^-10, "The mean computed from the pmf does not match the theoretical result!"];
Print["========================================"]
Print["Testing BuTools function PmfFromDPH"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {0.76,0,0.24};
Print["a = "//OutputForm];
Print[a];
A = {{0.34, 0.66, 0},{0.79, 0.05, 0.07},{0.26, 0.73, 0.01}};
Print["A = "//OutputForm];
Print[A];
x = Range[0.0,1000.0,1.0];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["pmf = PmfFromDPH[a, A, x];:"//OutputForm];
pmf = PmfFromDPH[a, A, x];
ListLinePlot[{Transpose[{x, pmf}]}]
Assert[AllTrue[pmf,#>=-10^-14 &], "PmfFromMG returned negative pmf!"];
Assert[Abs[Dot[x, pmf]-MomentsFromDPH[a, A, 1][[1]]]<10^-10, "The mean computed from the pmf does not match the theoretical result!"];
Print["========================================"]
Print["Testing BuTools function CdfFromMG"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {-0.6,0.3,1.3};
Print["a = "//OutputForm];
Print[a];
A = {{0.25, 0.2, -0.15},{0.3, 0.1, 0.25},{0, 0.2, 0.47}};
Print["A = "//OutputForm];
Print[A];
x = Range[0.0,100.0,1.0];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["cdf = CdfFromMG[a, A, x];:"//OutputForm];
cdf = CdfFromMG[a, A, x];
ListLinePlot[{Transpose[{x, cdf}]}]
Assert[AllTrue[Differences[cdf],#>=-10^-14 &], "The cdf is not increasing monotonously!"];
Assert[Abs[Total[1-cdf]-MomentsFromMG[a, A, 1][[1]]]<10^-10, "The mean computed from the cdf does not match the theoretical result!"];
Print["========================================"]
Print["Testing BuTools function CdfFromDPH"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {0.76,0,0.24};
Print["a = "//OutputForm];
Print[a];
A = {{0.34, 0.66, 0},{0.79, 0.05, 0.07},{0.26, 0.73, 0.01}};
Print["A = "//OutputForm];
Print[A];
x = Range[0.0,1000.0,1.0];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["cdf = CdfFromDPH[a, A, x];:"//OutputForm];
cdf = CdfFromDPH[a, A, x];
ListLinePlot[{Transpose[{x, cdf}]}]
Assert[AllTrue[Differences[cdf],#>=-10^-14 &], "The cdf is not increasing monotonously!"];
Assert[Abs[Total[1-cdf]-MomentsFromDPH[a, A, 1][[1]]]<10^-10, "The mean computed from the cdf does not match the theoretical result!"];
Print["========================================"]
Print["Testing BuTools function RandomDPH"]
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["{a, A} = RandomDPH[3, 10, 5];:"//OutputForm];
{a, A} = RandomDPH[3, 10, 5];
Print["a = "//OutputForm];
Print[a];
Print["A = "//OutputForm];
Print[A];
Assert[CheckDPHRepresentation[a, A], "RandomDPH failed to return a valid DPH representation!"];
Assert[Max[Abs[MomentsFromDPH[a, A, 1][[1]]-10]]<10^-14, "RandomDPH failed to match the given mean value!"];
Print["========================================"]
Print["Testing BuTools function CheckMGRepresentation"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {-0.6,0.3,1.3};
Print["a = "//OutputForm];
Print[a];
A = {{0.25, 0.2, -0.15},{0.3, 0.1, 0.25},{0, 0.2, 0.47}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["flag = CheckMGRepresentation[a, A];:"//OutputForm];
flag = CheckMGRepresentation[a, A];
Print["flag = "//OutputForm];
Print[flag];
Assert[flag==True, "CheckMGRepresentation failed to recognize a valid MG distribution!"];
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {-0.6,0.3,1.3};
Print["a = "//OutputForm];
Print[a];
A = {{0.35, 0.2, -0.25},{0.3, 0.1, 0.25},{0, 0.2, 0.47}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["flag = CheckMGRepresentation[a, A];:"//OutputForm];
flag = CheckMGRepresentation[a, A];
Print["flag = "//OutputForm];
Print[flag];
Assert[flag==False, "CheckMGRepresentation failed to recognize wrong eigenvalues!"];
Print["========================================"]
Print["Testing BuTools function CheckDPHRepresentation"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {0.48,0.08,0.26,0.18};
Print["a = "//OutputForm];
Print[a];
A = {{0, 0.08, 0.08, 0.8},{0.55, 0, 0.24, 0.19},{0.06, 0.03, 0, 0.001},{0.23, 0.005, 0.2, 0.53}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["flag = CheckDPHRepresentation[a, A];:"//OutputForm];
flag = CheckDPHRepresentation[a, A];
Print["flag = "//OutputForm];
Print[flag];
Assert[flag==True, "CheckDPHRepresentation failed to recognize a valid DPH distribution!"];
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {0.48,0.08};
Print["a = "//OutputForm];
Print[a];
A = {{0, 0.08},{0.55, 0.5}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["flag = CheckDPHRepresentation[a, A];:"//OutputForm];
flag = CheckDPHRepresentation[a, A];
Print["flag = "//OutputForm];
Print[flag];
Assert[flag==False, "CheckDPHRepresentation failed to recognize wrong row sums!"];
Print["========================================"]
Print["Testing BuTools function MGFromMoments"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
moms = {4.08, 20.41, 130.45, 1054.41, 10463.73};
Print["moms = "//OutputForm];
Print[moms];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["{a, A} = MGFromMoments[moms];:"//OutputForm];
{a, A} = MGFromMoments[moms];
Print["a = "//OutputForm];
Print[a];
Print["A = "//OutputForm];
Print[A];
Print["memoms = MomentsFromMG[a, A, 5];:"//OutputForm];
memoms = MomentsFromMG[a, A, 5];
Print["memoms = "//OutputForm];
Print[memoms];
Assert[Norm[moms-memoms]<10^-9, "The moments of the result of MGFromMoments do not match the input!"];
Print["========================================"]
Print["Testing BuTools function DPHFromMG"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {-0.6,0.3,1.3};
Print["a = "//OutputForm];
Print[a];
A = {{0.1, 0.2, 0},{0.3, 0.1, 0.25},{-0.3, 0.2, 0.77}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["flag = CheckMGRepresentation[a, A];:"//OutputForm];
flag = CheckMGRepresentation[a, A];
Print["flag = "//OutputForm];
Print[flag];
Print["flag = CheckDPHRepresentation[a, A];:"//OutputForm];
flag = CheckDPHRepresentation[a, A];
Print["flag = "//OutputForm];
Print[flag];
Print["{b, B} = DPHFromMG[a, A];:"//OutputForm];
{b, B} = DPHFromMG[a, A];
Print["b = "//OutputForm];
Print[b];
Print["B = "//OutputForm];
Print[B];
Print["flag = CheckDPHRepresentation[b, B];:"//OutputForm];
flag = CheckDPHRepresentation[b, B];
Print["flag = "//OutputForm];
Print[flag];
Cm = SimilarityMatrix[A, B];
err1 = Norm[A.Cm-Cm.B];
err2 = Norm[a.Cm-b];
Print["Transformation errors:"];
Print[Max[err1, err2]];
Assert[flag&&err1<10^-12&&err2<10^-12, "Transformation to DPH failed!"];
Print["========================================"]
Print["Testing BuTools function CanonicalFromDPH2"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {0,1.0};
Print["a = "//OutputForm];
Print[a];
A = {{0.23, 0.22},{0.41, 0.48}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["{b, B} = CanonicalFromDPH2[a, A];:"//OutputForm];
{b, B} = CanonicalFromDPH2[a, A];
Print["b = "//OutputForm];
Print[b];
Print["B = "//OutputForm];
Print[B];
Print["ev = Eigenvalues[A];:"//OutputForm];
ev = Eigenvalues[A];
Print["ev = "//OutputForm];
Print[ev];
Print["flag = CheckDPHRepresentation[b, B];:"//OutputForm];
flag = CheckDPHRepresentation[b, B];
Print["flag = "//OutputForm];
Print[flag];
Cm = SimilarityMatrix[A, B];
err1 = Norm[A.Cm-Cm.B];
err2 = Norm[a.Cm-b];
Assert[err1<10^-12&&err2<10^-12, "Transformation to canonical DPH(2) failed!"];
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {1.0,0};
Print["a = "//OutputForm];
Print[a];
A = {{0, 0.61},{0.56, 0.44}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["{b, B} = CanonicalFromDPH2[a, A];:"//OutputForm];
{b, B} = CanonicalFromDPH2[a, A];
Print["b = "//OutputForm];
Print[b];
Print["B = "//OutputForm];
Print[B];
Print["ev = Eigenvalues[A];:"//OutputForm];
ev = Eigenvalues[A];
Print["ev = "//OutputForm];
Print[ev];
Print["flag = CheckDPHRepresentation[b, B];:"//OutputForm];
flag = CheckDPHRepresentation[b, B];
Print["flag = "//OutputForm];
Print[flag];
Cm = SimilarityMatrix[A, B];
err1 = Norm[A.Cm-Cm.B];
err2 = Norm[a.Cm-b];
Print["Transformation errors:"];
Print[Max[err1, err2]];
Assert[err1<10^-12&&err2<10^-12, "Transformation to canonical DPH(2) failed!"];
Print["========================================"]
Print["Testing BuTools function CanonicalFromDPH3"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {0.46,0.22,0.32};
Print["a = "//OutputForm];
Print[a];
A = {{0.67, 0.01, 0.12},{0.06, 0.45, 0.15},{0.18, 0.43, 0.32}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["{b, B} = CanonicalFromDPH3[a, A];:"//OutputForm];
{b, B} = CanonicalFromDPH3[a, A];
Print["b = "//OutputForm];
Print[b];
Print["B = "//OutputForm];
Print[B];
Print["ev = Eigenvalues[A];:"//OutputForm];
ev = Eigenvalues[A];
Print["ev = "//OutputForm];
Print[ev];
Print["flag = CheckDPHRepresentation[b, B];:"//OutputForm];
flag = CheckDPHRepresentation[b, B];
Print["flag = "//OutputForm];
Print[flag];
Cm = SimilarityMatrix[A, B];
err1 = Norm[A.Cm-Cm.B];
err2 = Norm[a.Cm-b];
Print["Transformation errors:"];
Print[Max[err1, err2]];
Assert[flag&&err1<10^-12&&err2<10^-12, "Transformation to canonical DPH(3) failed!"];
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {0.76,0.12,0.12};
Print["a = "//OutputForm];
Print[a];
A = {{0.31, 0., 0.},{0.98, 0., 0.02},{0.88, 0.04, 0.08}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["{b, B} = CanonicalFromDPH3[a, A];:"//OutputForm];
{b, B} = CanonicalFromDPH3[a, A];
Print["b = "//OutputForm];
Print[b];
Print["B = "//OutputForm];
Print[B];
Print["ev = Eigenvalues[A];:"//OutputForm];
ev = Eigenvalues[A];
Print["ev = "//OutputForm];
Print[ev];
Print["flag = CheckDPHRepresentation[b, B];:"//OutputForm];
flag = CheckDPHRepresentation[b, B];
Print["flag = "//OutputForm];
Print[flag];
Cm = SimilarityMatrix[A, B];
err1 = Norm[A.Cm-Cm.B];
err2 = Norm[a.Cm-b];
Print["Transformation errors:"];
Print[Max[err1, err2]];
Assert[flag&&err1<10^-12&&err2<10^-12, "Transformation to canonical DPH(3) failed!"];
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {0.67,0.07,0.26};
Print["a = "//OutputForm];
Print[a];
A = {{0.31, 0., 0.},{0.98, 0., 0.02},{0.88, 0.04, 0.08}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["{b, B} = CanonicalFromDPH3[a, A];:"//OutputForm];
{b, B} = CanonicalFromDPH3[a, A];
Print["b = "//OutputForm];
Print[b];
Print["B = "//OutputForm];
Print[B];
Print["ev = Eigenvalues[A];:"//OutputForm];
ev = Eigenvalues[A];
Print["ev = "//OutputForm];
Print[ev];
Print["flag = CheckDPHRepresentation[b, B];:"//OutputForm];
flag = CheckDPHRepresentation[b, B];
Print["flag = "//OutputForm];
Print[flag];
Cm = SimilarityMatrix[A, B];
err1 = Norm[A.Cm-Cm.B];
err2 = Norm[a.Cm-b];
Print["Transformation errors:"];
Print[Max[err1, err2]];
Assert[flag&&err1<10^-12&&err2<10^-12, "Transformation to canonical DPH(3) failed!"];
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {0.78,0.04,0.18};
Print["a = "//OutputForm];
Print[a];
A = {{0.06, 0.25, 0.31},{0.45, 0.18, 0.33},{0.98, 0, 0.01}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["{b, B} = CanonicalFromDPH3[a, A];:"//OutputForm];
{b, B} = CanonicalFromDPH3[a, A];
Print["b = "//OutputForm];
Print[b];
Print["B = "//OutputForm];
Print[B];
Print["ev = Eigenvalues[A];:"//OutputForm];
ev = Eigenvalues[A];
Print["ev = "//OutputForm];
Print[ev];
Print["flag = CheckDPHRepresentation[b, B];:"//OutputForm];
flag = CheckDPHRepresentation[b, B];
Print["flag = "//OutputForm];
Print[flag];
Cm = SimilarityMatrix[A, B];
err1 = Norm[A.Cm-Cm.B];
err2 = Norm[a.Cm-b];
Print["Transformation errors:"];
Print[Max[err1, err2]];
Assert[flag&&err1<10^-12&&err2<10^-12, "Transformation to canonical DPH(3) failed!"];
Print["========================================"]
Print["Testing BuTools function AcyclicDPHFromMG"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {0,0,1.0};
Print["a = "//OutputForm];
Print[a];
A = {{0.22, 0, 0},{0.3, 0.1, 0.55},{0.26, 0, 0.73}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["{b, B} = AcyclicDPHFromMG[a, A];:"//OutputForm];
{b, B} = AcyclicDPHFromMG[a, A];
Print["b = "//OutputForm];
Print[b];
Print["B = "//OutputForm];
Print[B];
Print["ma = MomentsFromMG[a, A, 5];:"//OutputForm];
ma = MomentsFromMG[a, A, 5];
Print["ma = "//OutputForm];
Print[ma];
Print["mb = MomentsFromMG[b, B, 5];:"//OutputForm];
mb = MomentsFromMG[b, B, 5];
Print["mb = "//OutputForm];
Print[mb];
Print["flag = CheckDPHRepresentation[b, B];:"//OutputForm];
flag = CheckDPHRepresentation[b, B];
Print["flag = "//OutputForm];
Print[flag];
Cm = SimilarityMatrix[A, B];
err1 = Norm[A.Cm-Cm.B];
err2 = Norm[a.Cm-b];
Print["Transformation errors:"];
Print[Max[err1, err2]];
Assert[err1<10^-12&&err2<10^-12, "Transformation to canonical PH(3) failed!"];
Print["========================================"]
Print["Testing BuTools function DPH2From3Moments"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {0.9,0.1};
Print["a = "//OutputForm];
Print[a];
A = {{0.2, 0.61},{0.58, 0.41}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["moms = MomentsFromDPH[a, A];:"//OutputForm];
moms = MomentsFromDPH[a, A];
Print["moms = "//OutputForm];
Print[moms];
Print["{b, B} = DPH2From3Moments[moms];:"//OutputForm];
{b, B} = DPH2From3Moments[moms];
Print["b = "//OutputForm];
Print[b];
Print["B = "//OutputForm];
Print[B];
Print["phmoms = MomentsFromDPH[b, B, 3];:"//OutputForm];
phmoms = MomentsFromDPH[b, B, 3];
Print["phmoms = "//OutputForm];
Print[phmoms];
Assert[Norm[(phmoms-moms)/moms]<10^-12, "The moments of the result of DPH2From3Moments do not match the input!"];
Print["========================================"]
Print["Testing BuTools function DPH3From5Moments"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {0.7,0.1,0.2};
Print["a = "//OutputForm];
Print[a];
A = {{0.2, 0.51, 0.1},{0.58, 0.41, 0},{0.1, 0.4, 0.3}};
Print["A = "//OutputForm];
Print[A];
Print["Test:"//OutputForm];
Print["-----"//OutputForm];
Print["moms = MomentsFromDPH[a, A];:"//OutputForm];
moms = MomentsFromDPH[a, A];
Print["moms = "//OutputForm];
Print[moms];
Print["{b, B} = DPH3From5Moments[moms];:"//OutputForm];
{b, B} = DPH3From5Moments[moms];
Print["b = "//OutputForm];
Print[b];
Print["B = "//OutputForm];
Print[B];
Print["phmoms = MomentsFromMG[b, B, 5];:"//OutputForm];
phmoms = MomentsFromMG[b, B, 5];
Print["phmoms = "//OutputForm];
Print[phmoms];
Assert[Norm[(phmoms-moms)/moms]<10^-12, "The moments of the result of DPH3From5Moments do not match the input!"];
Print["========================================"]
Print["Testing BuTools function SamplesFromDPH"]
Print["Input:"//OutputForm];
Print["------"//OutputForm];
a = {0.76,0,0.24};
Print["a = "//OutputForm];
Print[a];
A = {{0.34, 0.66, 0},{0.79, 0.05, 0.07},{0.26, 0.73, 0.01}};
Print["A = "//OutputForm];
Print[A];
Print["x = SamplesFromDPH[a, A, 1000];:"//OutputForm];
x = SamplesFromDPH[a, A, 1000];
Print["mt = MarginalMomentsFromTrace[x, 3];:"//OutputForm];
mt = MarginalMomentsFromTrace[x, 3];
Print["mt = "//OutputForm];
Print[mt];
Print["mp = MomentsFromDPH[a, A, 3];:"//OutputForm];
mp = MomentsFromDPH[a, A, 3];
Print["mp = "//OutputForm];
Print[mp];
