%  [s,n,S,D]=sprod(M,N) % init
%  [s,n]=sprod(s,S,D) % next state
% 
%  Copyright (c) 2012-2018, Imperial College London
%  All rights reserved.
%
