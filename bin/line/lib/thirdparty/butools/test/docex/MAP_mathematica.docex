"=== MarginalDistributionFromMAP ==="
>>> D0 = {{-0.17, 0, 0, 0.07},{0.01, -0.78, 0.03, 0.08},{0.22, 0.17, -1.1, 0.02},{0.04, 0.12, 0, -0.42}};
>>> D1 = {{0, 0.06, 0, 0.04},{0.04, 0.19, 0.21, 0.22},{0.22, 0.13, 0.15, 0.19},{0.05, 0, 0.17, 0.04}};
>>> {a, A} = MarginalDistributionFromMAP[D0, D1];
>>> Print[a];
{0.1443829740435819, 0.23570990103732542, 0.33794226877724004, 0.2819648561418526}
>>> Print[A];
{{-0.17, 0, 0, 0.07},
 {0.01, -0.78, 0.03, 0.08},
 {0.22, 0.17, -1.1, 0.02},
 {0.04, 0.12, 0, -0.42}}
"=== MarginalMomentsFromMAP ==="
>>> D0 = {{-0.17, 0, 0, 0.07},{0.01, -0.78, 0.03, 0.08},{0.22, 0.17, -1.1, 0.02},{0.04, 0.12, 0, -0.42}};
>>> D1 = {{0, 0.06, 0, 0.04},{0.04, 0.19, 0.21, 0.22},{0.22, 0.13, 0.15, 0.19},{0.05, 0, 0.17, 0.04}};
>>> moms = MarginalMomentsFromMAP[D0, D1];
>>> Print[moms];
{3.44334737542053, 34.03035343496073, 592.0769859317294, 14547.729458258553, 455900.2769738976, 1.7269527005202413*^7, 7.652597172788765*^8}
"=== MarginalDistributionFromRAP ==="
>>> H0 = {{-2, 0, 0},{0, -3, 1},{0, -1, -2}};
>>> H1 = {{1.8, 0.2, 0},{0.2, 1.8, 0},{0.2, 1.8, 1}};
>>> {a, A} = MarginalDistributionFromRAP[H0, H1];
>>> Print[a];
{0.44444444444444464, 0.4444444444444443, 0.11111111111111106}
>>> Print[A];
{{-2, 0, 0},
 {0, -3, 1},
 {0, -1, -2}}
"=== MarginalMomentsFromRAP ==="
>>> H0 = {{-2., 0, 0},{0, -3., 1.},{0, -1., -2.}};
>>> H1 = {{1.8, 0.2, 0},{0.2, 1.8, 0},{0.2, 1.8, 1.}};
>>> moms = MarginalMomentsFromRAP[H0, H1];
>>> Print[moms];
{0.4444444444444444, 0.380952380952381, 0.48299319727891166, 0.8221574344023325, 1.794391225878107}
"=== MarginalDistributionFromMMAP ==="
>>> D0 = {{-1.78, 0.29},{0.07, -0.92}};
>>> D1 = {{0.15, 0.49},{0.23, 0.36}};
>>> D2 = {{0.11, 0.2},{0.01, 0}};
>>> D3 = {{0.14, 0.4},{0.11, 0.14}};
>>> {a, A} = MarginalDistributionFromMMAP[{D0, D1, D2, D3}];
>>> Print[a];
{0.36190793862575055, 0.6380920613742495}
>>> Print[A];
{{-1.78, 0.29},
 {0.07, -0.92}}
"=== MarginalMomentsFromMMAP ==="
>>> D0 = {{-1.78, 0.29},{0.07, -0.92}};
>>> D1 = {{0.15, 0.49},{0.23, 0.36}};
>>> D2 = {{0.11, 0.2},{0.01, 0}};
>>> D3 = {{0.14, 0.4},{0.11, 0.14}};
>>> moms = MarginalMomentsFromMMAP[{D0, D1, D2, D3}];
>>> Print[moms];
{1.000667111407605, 2.1044966311760755, 6.827688149434602}
"=== MarginalDistributionFromMRAP ==="
>>> x = 0.18;
>>> H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};
>>> H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};
>>> H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};
>>> {a, A} = MarginalDistributionFromMRAP[{H0, H1, H2}];
>>> Print[a];
{0.1715935052770479, 0.21694768240956405, 0.27935809825487623, 0.3321007140585118}
>>> Print[A];
{{-5., 0.28, 0.9, 1.},
 {1., -8., 0.9, 0.1},
 {0.9, 0.1, -4., 1.},
 {1., 2., 3., -9.}}
"=== MarginalMomentsFromMRAP ==="
>>> x = 0.18;
>>> H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};
>>> H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};
>>> H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};
>>> moms = MarginalMomentsFromMRAP[{H0, H1, H2}];
>>> Print[moms];
{0.33950747762450084, 0.2458255719823656, 0.2742374276605113, 0.4120601813350093, 0.7767718404933559, 1.7594286078546524, 4.651534763161781}
"=== LagCorrelationsFromMAP ==="
>>> D0 = {{-5., 0, 1., 1.},{1., -8., 1., 0},{1., 0, -4., 1.},{1., 2., 3., -9.}};
>>> D1 = {{0, 1., 0, 2.},{2., 1., 3., 0},{0, 0, 1., 1.},{1., 1., 0, 1.}};
>>> corr = LagCorrelationsFromMAP[D0, D1, 3];
>>> Print[corr];
{0.00012012478025411484, 0.0008617649366101062, -0.00022001393374437001}
"=== LagCorrelationsFromRAP ==="
>>> H0 = {{-2., 0, 0},{0, -3., 1.},{0, -1., -2.}};
>>> H1 = {{1.8, 0.2, 0},{0.2, 1.8, 0},{0.2, 1.8, 1.}};
>>> corr = LagCorrelationsFromRAP[H0, H1, 3];
>>> Print[corr];
{-0.0038461538461536634, 0.0045604395604397245, 0.005895604395604545}
"=== LagkJointMomentsFromMAP ==="
>>> D0 = {{-5., 0, 1., 1.},{1., -8., 1., 0},{1., 0, -4., 1.},{1., 2., 3., -9.}};
>>> D1 = {{0, 1., 0, 2.},{2., 1., 3., 0},{0, 0, 1., 1.},{1., 1., 0, 1.}};
>>> Nm = LagkJointMomentsFromMAP[D0, D1, 4, 1];
>>> Print[Nm];
{{1., 0.3424657534246575, 0.2505363921439181, 0.2827096943168424, 0.42984404959582045},
 {0.3424657534246575, 0.11729879932812143, 0.08578883767954984, 0.09680718552353199, 0.14720828999251045},
 {0.2505363921439181, 0.08570000543480039, 0.06263282590926178, 0.07065983692223346, 0.10744275082056383},
 {0.28270969431684234, 0.09662651257722407, 0.07058862634724386, 0.07962311566530773, 0.1210669477207951},
 {0.4298440495958204, 0.14686125208953896, 0.10726689466149464, 0.12098747565756454, 0.18395767529024404}}
>>> moms = MarginalMomentsFromMAP[D0, D1, 4];
>>> Print[moms];
{0.3424657534246575, 0.2505363921439181, 0.2827096943168424, 0.42984404959582045}
>>> cjm = Table[0,{3}];
>>> Do[
>>>     Nx = LagkJointMomentsFromMAP[D0, D1, 1, i];
>>>     cjm[[i]] = (Nx[[2, 2]]-moms[[1]]^2)/(moms[[2]]-moms[[1]]^2);
>>> , {i,1,3,1}];
>>> Print[cjm];
{0.00012012478025432312, 0.0008617649366102103, -0.00022001393374426588}
>>> corr = LagCorrelationsFromMAP[D0, D1, 3];
>>> Print[corr];
{0.00012012478025411484, 0.0008617649366101062, -0.00022001393374437001}
"=== LagkJointMomentsFromRAP ==="
>>> H0 = {{-2., 0, 0},{0, -3., 1.},{0, -1., -2.}};
>>> H1 = {{1.8, 0.2, 0},{0.2, 1.8, 0},{0.2, 1.8, 1.}};
>>> Nm = LagkJointMomentsFromRAP[H0, H1, 4, 1];
>>> Print[Length[Nm]];
5
>>> moms = MarginalMomentsFromRAP[H0, H1, 4];
>>> Print[moms];
{0.4444444444444444, 0.380952380952381, 0.48299319727891166, 0.8221574344023325}
>>> cjm = Table[0,{3}];
>>> Do[
>>>     Nx = LagkJointMomentsFromRAP[H0, H1, 1, i];
>>>     cjm[[i]] = (Nx[[2, 2]]-moms[[1]]^2)/(moms[[2]]-moms[[1]]^2);
>>> , {i,1,3,1}];
>>> Print[cjm];
{-0.0038461538461536634, 0.004560439560439573, 0.0058956043956042425}
>>> corr = LagCorrelationsFromRAP[H0, H1, 3];
>>> Print[corr];
{-0.0038461538461536634, 0.0045604395604397245, 0.005895604395604545}
"=== LagkJointMomentsFromMMAP ==="
>>> D0 = {{-1.78, 0.29},{0.07, -0.92}};
>>> D1 = {{0.15, 0.49},{0.23, 0.36}};
>>> D2 = {{0.11, 0.2},{0.01, 0}};
>>> D3 = {{0.14, 0.4},{0.11, 0.14}};
>>> Nm = LagkJointMomentsFromMMAP[{D0, D1, D2, D3}, 3, 1];
>>> Print[Nm[[1]]];
{{0.6020680453635756, 0.6050097826919547, 1.2755312779381711, 4.143785726301525},
 {0.6291277595686432, 0.6291324346751083, 1.3226115303952872, 4.29008766966622},
 {1.356058746641639, 1.3524365188039793, 2.8387063057306685, 9.199840452355494},
 {4.457620287136224, 4.439461568207248, 9.310487784608107, 30.160255763360027}}
>>> Print[Nm[[2]]];
{{0.08005336891260842, 0.07837208152164925, 0.16268008556958458, 0.5240068039224259},
 {0.06033000338608641, 0.058276456272008365, 0.11997332411839014, 0.3846690086730414},
 {0.10243942401511769, 0.09766196798710611, 0.19940380826076648, 0.6363686631976577},
 {0.289234720958347, 0.2729259896515855, 0.5535960565150979, 1.7600767451077592}}
>>> Print[Nm[[3]]];
{{0.3178785857238159, 0.31728524719400103, 0.66628526766832, 2.1598956192106504},
 {0.3112093484528753, 0.30821203977350414, 0.6442381239542273, 2.0831364406036084},
 {0.6459984605193192, 0.6367244916768195, 1.327097838382605, 4.28439098549322},
 {2.0808331413400314, 2.045505561084037, 4.256516259923166, 13.72951730592557}}
"=== LagkJointMomentsFromMRAP ==="
>>> x = 0.18;
>>> H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};
>>> H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};
>>> H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};
>>> Nm = LagkJointMomentsFromMRAP[{H0, H1, H2}, 3, 2];
>>> Print[Nm[[1]]];
{{0.41974048988209456, 0.1433714202044304, 0.10409540795191471, 0.11624988638743064},
 {0.14138068443967466, 0.04824753953626901, 0.03501746854001877, 0.039099557275548855},
 {0.10185532272464182, 0.034737397063937, 0.02520539838495395, 0.028140494722472847},
 {0.11337711648763446, 0.038655118635854246, 0.028044484995573313, 0.031308489803818416}}
>>> Print[Nm[[2]]];
{{0.5802595101179051, 0.19613605742007034, 0.14173016403045077, 0.15798754127308057},
 {0.1981267931848261, 0.06699407161937415, 0.048417900372854594, 0.05397433134001463},
 {0.14397024925772373, 0.048696896031760306, 0.03519900415612581, 0.039240318805296825},
 {0.16086031117287675, 0.05441861692540258, 0.03933760117012349, 0.0438552148324313}}
"=== RandomMAP ==="
>>> {D0, D1} = RandomMAP[4, 1.62, 10];
>>> Print[D0];
{{-1.2603255570025995, 0., 1.2603255570025995, 0.},
 {1.0421148823453172, -3.0725926090541065, 0., 1.2512140562551135},
 {0.0729686946916973, 1.1513050282525865, -3.021511605493252, 0.8603731650240692},
 {0.905645182073805, 0., 0.3797626274429608, -2.652481770444762}}
>>> Print[D1];
{{0., 0., 0., 0.},
 {0.0035497683267016345, 0.025589968292695654, 0.1383759482229132, 0.6117479856113653},
 {0.4204286154800259, 0.36476933475507295, 0.14415600056384018, 0.007510766725959241},
 {0.1266680865059269, 1.2404058744220698, 0., 0.}}
>>> m = MarginalMomentsFromMAP[D0, D1, 1][[1]];
>>> Print[m];
1.6199999999999997
"=== RandomMMAP ==="
>>> Dm = RandomMMAP[4, 3, 1.62, 10];
>>> Print[Dm[[1]]];
{{-0.5862070911809831, 0., 0.0168137805609394, 0.08788491863058187},
 {0.05283897336899656, -0.8424383930373084, 0.07960302764594157, 0.},
 {0.0430532309208159, 0.09311851788523529, -0.8665132200026514, 0.09720430167174356},
 {0.03143342574603682, 0.006933947818271124, 0.1026546426188773, -0.8461985523926278}}
>>> Print[Dm[[2]]];
{{0.014680660704177124, 0.0645992486634905, 0.08177105711062393, 0.016642761139291848},
 {0., 0.09540597852268921, 0., 0.0707635001562371},
 {0.095047323249757, 0.05618623612094079, 0.07843785718105817, 0.06223373813267749},
 {0.0465659166377795, 0.027686196902255576, 0.07643593698997828, 0.04091552394072304}}
>>> Print[Dm[[3]]];
{{0.09941961376878797, 0., 0.08253500208040433, 0.10492138700485602},
 {0.07147061429219402, 0.08132225534707489, 0., 0.01620411904838067},
 {0.05528588985095624, 0.06258835562699341, 0.07840456211046513, 0.03871997575555587},
 {0.09854407744754319, 0.06032740737189369, 0.06451082035845042, 0.09710176006166384}}
>>> Print[Dm[[4]]];
{{0., 0.0169386615178302, 0., 0.},
 {0.08694201353931666, 0.10148847810958055, 0.09477989858935744, 0.09161953441753981},
 {0.004110565171334107, 0.0061642514927466065, 0.01543324456111962, 0.08052517027125213},
 {0.07312825196154744, 0., 0.06649165886464029, 0.053468985672967276}}
>>> m = MarginalMomentsFromMMAP[Dm, 1][[1]];
>>> Print[m];
1.6199999999999997
"=== CheckMAPRepresentation ==="
>>> D0 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.}};
>>> D1 = {{-1., 0, 1., 0},{0, -2., 0, 1.},{1., 0, -3., 0},{1., 2., 2., 1.}};
>>> flag = CheckMAPRepresentation[D0, D1];
"CheckMAPRepresentation: D0 and D1 have different sizes!"
>>> Print[flag];
False
>>> D0 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.}};
>>> D1 = {{1., 0, 1.},{0, 2., 0},{1., 0, 3.}};
>>> flag = CheckMAPRepresentation[D0, D1];
"CheckMAPRepresentation: A rowsum of D0+D1 is not 0 (at precision "1.*^-12")!"
>>> Print[flag];
False
>>> D0 = {{-3., 0, 1.},{0, -2., 0},{1., 0, -5.}};
>>> D1 = {{1., 0, 1.},{0, 2., 0},{1., 0, 3.}};
>>> flag = CheckMAPRepresentation[D0, D1];
>>> Print[flag];
True
"=== CheckRAPRepresentation ==="
>>> H0 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.},{1., 2., 2.}};
>>> H1 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.},{1., 2., 2.}};
>>> flag = CheckRAPRepresentation[H0, H1];
"CheckRAPRepresentation: D0 is not a quadratic matrix!"
>>> Print[flag];
False
>>> H0 = {{-1., 0, 2.},{0, 2., 0},{1., 0, -3.}};
>>> H1 = {{-1., 0, 1.},{0, -2., 0},{1., 0, -3.}};
>>> flag = CheckRAPRepresentation[H0, H1];
"CheckRAPRepresentation: A rowsum of D0+D1 is not 0! (precision:"1.*^-12")"
>>> Print[flag];
False
>>> H0 = {{-1., 0, 0},{0, -2., 2.},{0, 3., -3.}};
>>> H1 = {{0, 0, 1.},{0, -1., 1.},{1., 0, -1.}};
>>> flag = CheckRAPRepresentation[H0, H1];
"CheckRAPRepresentation: there is an eigenvalue of D0 with non-negative real part (at precision "1.*^-12")!"
>>> Print[flag];
False
>>> H0 = {{-2., 0, 0},{0, -1., 1.},{0, -1., -1.}};
>>> H1 = {{1., 0, 1.},{0, 1., -1.},{1., 0, 1.}};
>>> flag = CheckRAPRepresentation[H0, H1];
"CheckRAPRepresentation: The dominant eigenvalue of D0 is not real!"
>>> Print[flag];
False
>>> H0 = {{-1., 0, 0},{0, -2., 1.},{0, -1., -2.}};
>>> H1 = {{1., 0, 0},{0, 1., 0},{1., 1., 1.}};
>>> flag = CheckRAPRepresentation[H0, H1];
>>> Print[flag];
True
"=== CheckMMAPRepresentation ==="
>>> D0 = {{-1.05, 0.03, 0.07},{0.19, -1.63, 0.06},{0, 0.2, -1.03}};
>>> D1 = {{0.16, 0.11, 0},{0.1, 0.16, 0},{0.27, 0, 0.19}};
>>> D2 = {{0.01, 0.09, 0.13},{0.26, 0.21, 0.05},{0, 0.16, 0.07}};
>>> D3 = {{0.19, 0.06, 0.2},{0.17, 0.16, 0.27},{0, 0, 0.14}};
>>> flag = CheckMMAPRepresentation[{D0, D1, D2, D3}];
>>> Print[flag];
True
"=== CheckMRAPRepresentation ==="
>>> x = 0.18;
>>> H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};
>>> H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};
>>> H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};
>>> flag = CheckMRAPRepresentation[{H0, H1, H2}];
>>> Print[flag];
True
"=== RAPFromMoments ==="
>>> G0 = {{-6.2, 2., 0.},{2., -9., 1.},{1., 0, -3.}};
>>> G1 = {{2.2, -2., 4.},{2., 2., 2.},{1., 0, 1.}};
>>> moms = MarginalMomentsFromRAP[G0, G1, 5];
>>> Print[moms];
{0.3658536585365854, 0.2553502718860305, 0.26507255497329196, 0.36691170692675057, 0.6357275591669562}
>>> Nm = LagkJointMomentsFromRAP[G0, G1, 2, 1];
>>> Print[Nm];
{{1., 0.36585365853658536, 0.25535027188603043},
 {0.36585365853658547, 0.12866311891090199, 0.08833352579367165},
 {0.25535027188603054, 0.08880201960555248, 0.06066984268584448}}
>>> {H0, H1} = RAPFromMoments[moms, Nm];
>>> Print[H0];
{{-12.949385817977836, 36.77982874083904, -24.817434792780038},
 {-1.1101688032075987, -2.5113400173185036, 0.917051942480952},
 {-0.7120534190146224, 0.6891177950962794, -2.7392741647031724}}
>>> Print[H1];
{{9.267225013957797, -99.9580820687114, 91.67784892467239},
 {1.1693067341368664, -2.1771485461371185, 3.7122986900453725},
 {0.6529154880849459, 3.999370768358972, -1.8900764678223823}}
>>> rmoms = MarginalMomentsFromRAP[H0, H1, 5];
>>> Print[rmoms];
{0.36585365853657714, 0.25535027188602305, 0.2650725549732837, 0.3669117069267387, 0.6357275591669355}
>>> rNm = LagkJointMomentsFromRAP[H0, H1, 2, 1];
>>> Print[rNm];
{{0.9999999999999984, 0.36585365853657636, 0.25535027188602255},
 {0.36585365853658025, 0.12866311891089843, 0.08833352579366896},
 {0.25535027188602677, 0.08880201960555026, 0.0606698426858429}}
>>> G0 = {{-5., 0, 1., 1.},{1., -8., 1., 0},{1., 0, -4., 1.},{1., 2., 3., -9.}};
>>> G1 = {{0, 1., 0, 2.},{2., 1., 3., 0},{0, 0, 1., 1.},{1., 1., 0, 1.}};
>>> moms = MarginalMomentsFromRAP[G0, G1, 7];
>>> Print[moms];
{0.3424657534246575, 0.2505363921439181, 0.2827096943168424, 0.42984404959582045, 0.8199855548792176, 1.87947069217376, 5.028019684356114}
>>> Nm = LagkJointMomentsFromRAP[G0, G1, 3, 1];
>>> Print[Nm];
{{1., 0.3424657534246575, 0.2505363921439181, 0.2827096943168424},
 {0.3424657534246575, 0.11729879932812143, 0.08578883767954984, 0.09680718552353199},
 {0.2505363921439181, 0.08570000543480039, 0.06263282590926178, 0.07065983692223346},
 {0.28270969431684234, 0.09662651257722407, 0.07058862634724386, 0.07962311566530773}}
>>> {H0, H1} = RAPFromMoments[moms, Nm];
>>> Print[H0];
{{-6.712604756497726, 32.989128321588076, -108.70524958101856, 77.98324656387703},
 {-0.8704043653332061, -8.340513878935521, 25.267697633820713, -19.012580513479065},
 {-0.6598231785519086, 3.0738822535382218, -16.542813378858632, 11.226648399084453},
 {-0.6597724561148857, 3.0766316253972996, -10.914884254962077, 5.595932114394607}}
>>> Print[H1];
{{1.6406099353574024, 4.4202069311362155, 26351.394279699773, -26353.009617120028},
 {0.6163474960953952, 0.876324568437956, -1431.470838015899, 1432.933967076242},
 {0.7868266708278491, 0.6568875335524327, 716.3427121937275, -714.8843204919249},
 {0.7868258364326305, 0.6567878979929078, 717.3181258011609, -715.8596465606242}}
>>> BuTools`CheckPrecision = 10.^-8;
>>> rmoms = MarginalMomentsFromRAP[H0, H1, 7];
>>> Print[rmoms];
{0.3424657534532438, 0.250536392173959, 0.28270969435470766, 0.4298440496555902, 0.8199855549947348, 1.8794706924397593, 5.028019685068905}
>>> rNm = LagkJointMomentsFromRAP[H0, H1, 3, 1];
>>> Print[rNm];
{{1.0000000006873626, 0.3424657536405521, 0.2505363922953623, 0.28270969448493943},
 {0.34246575387544453, 0.11729879948006072, 0.08578883778979218, 0.09680718564758983},
 {0.2505363926432551, 0.08570000560779079, 0.06263282603635645, 0.07065983706588419},
 {0.2827096950286432, 0.09662651282658885, 0.07058862653136089, 0.07962311587379389}}
"=== MRAPFromMoments ==="
>>> G0 = {{-1.05, 0.03, 0.07},{0.19, -1.63, 0.06},{0, 0.2, -1.03}};
>>> G1 = {{0.16, 0.11, 0},{0.1, 0.16, 0},{0.27, 0, 0.19}};
>>> G2 = {{0.01, 0.09, 0.13},{0.26, 0.21, 0.05},{0, 0.16, 0.07}};
>>> G3 = {{0.19, 0.06, 0.2},{0.17, 0.16, 0.27},{0, 0, 0.14}};
>>> G = {G0, G1, G2, G3};
>>> moms = MarginalMomentsFromMRAP[G, 5];
>>> Print[moms];
{0.998048613345479, 2.0262345014785748, 6.2347773609141575, 25.738432370871866, 133.30214790750443}
>>> Nm = LagkJointMomentsFromMRAP[G, 2, 1];
>>> {Nm1, Nm2, Nm3} = Nm;
>>> Print[Nm1];
{{0.3400009192827923, 0.3405452798817129, 0.6932173701035182},
 {0.3496600253904083, 0.3518559816976867, 0.7182912226288702},
 {0.7239624620818725, 0.7307864272366612, 1.494690822742042}}
>>> Print[Nm2];
{{0.29553270348533534, 0.27734235602329654, 0.5407773515893262},
 {0.29028125712379704, 0.27210886385024, 0.5301325803470373},
 {0.5839079003431904, 0.5468180031775005, 1.064574978879992}}
>>> Print[Nm3];
{{0.36446637723187236, 0.3801609774404695, 0.7922397797857303},
 {0.35810733083127366, 0.37445996131218023, 0.7814764837751109},
 {0.7183641390535117, 0.752387606929777, 1.5716457698900985}}
>>> H = MRAPFromMoments[moms, Nm];
>>> Print[H[[1]]];
{{-1.9473051937398436, 3.0344139261695524, -2.1703554254825432},
 {-0.3343442044701893, -0.8811768825595621, 0.2135477889258592},
 {-0.33362593020289716, 0.2132067478864758, -0.8815179235989457}}
>>> Print[H[[2]]];
{{0.22303732415660393, 7.496153934451286, -7.397276128273006},
 {0.09280493616992504, 7.913084312262072, -7.665823186685884},
 {0.0869846290873446, 7.880402325125033, -7.626121636429161}}
>>> Print[H[[3]]];
{{0.4939487332101481, 0.9295081378932082, -1.079810419889327},
 {0.4418009261624444, -2.4454040931686905, 2.2994668648207153},
 {0.44567916840142563, -2.3907771669346403, 2.241455359959218}}
>>> Print[H[[4]]];
{{-0.1427050168593569, -5.435557714889001, 5.995947843257454},
 {-0.19984735284082544, -5.110198412374302, 5.6760893037571805},
 {-0.19945217229000395, -5.17913683023653, 5.742903429225407}}
>>> BuTools`CheckPrecision = 10.^-10;
>>> rmoms = MarginalMomentsFromMRAP[H, 5];
>>> Print[rmoms];
{0.9980486133447148, 2.026234501476063, 6.23477736090465, 25.738432370828296, 133.30214790726575}
>>> rNm = LagkJointMomentsFromMRAP[H, 2, 1];
>>> {rNm1, rNm2, rNm3} = rNm;
>>> Print[rNm1];
{{0.3400009192835025, 0.3405452798822086, 0.6932173701042554},
 {0.3496600253876201, 0.3518559816946487, 0.7182912226223763},
 {0.7239624620661935, 0.7307864272203464, 1.4946908227080655}}
>>> Print[rNm2];
{{0.29553270348466576, 0.27734235602249724, 0.5407773515875407},
 {0.2902812571227895, 0.2721088638491218, 0.5301325803446262},
 {0.5839079003408321, 0.5468180031749403, 1.0645749788745391}}
>>> Print[rNm3];
{{0.3644663772275738, 0.3801609774359047, 0.7922397797761231},
 {0.35810733082500956, 0.374459961305627, 0.7814764837614341},
 {0.7183641390383446, 0.752387606913997, 1.5716457698572626}}
"=== RAPFromMomentsAndCorrelations ==="
>>> H0 = {{-6.2, 2., 0},{2., -9., 1.},{1., 0, -3.}};
>>> H1 = {{2.2, 0, 2.},{0, 4., 2.},{0, 1., 1.}};
>>> mom = MarginalMomentsFromRAP[H0, H1];
>>> Print[mom];
{0.29774127310061604, 0.19283643304803644, 0.19448147792730758, 0.2659732553924553, 0.45833053059627116}
>>> corr = LagCorrelationsFromRAP[H0, H1, 3];
>>> Print[corr];
{0.012393574884970258, 0.0027411959690404088, 0.0007238364213571031}
>>> {G0, G1} = RAPFromMomentsAndCorrelations[mom, corr];
>>> Print[G0];
{{-8.96289388087693, 22.252570107207173, -18.544098091372838},
 {-0.9917815607047362, -4.666992249154709, 2.33103341018933},
 {-1.247298899065379, 2.4279117893845945, -4.570113869959446}}
>>> Print[G1];
{{2.2027474563394773, -1.3172514038167056, 4.368925812519816},
 {1.2179262967043782, 1.8217266419760083, 0.2880874609897277},
 {1.0211541630657368, 0.4173538177941065, 1.9509929987803876}}
>>> rmom = MarginalMomentsFromRAP[G0, G1];
>>> Print[rmom];
{0.297741273100616, 0.19283643304803638, 0.19448147792730755, 0.2659732553924553, 0.45833053059627116}
>>> rcorr = LagCorrelationsFromRAP[G0, G1, 3];
>>> Print[rcorr];
{0.012393574884970393, 0.0027411959690408086, 0.0007238364213573696}
"=== MAP2FromMoments ==="
>>> D0 = {{-14., 1.},{1, -25.}};
>>> D1 = {{6., 7.},{3., 21.}};
>>> moms = MarginalMomentsFromMAP[D0, D1, 3];
>>> Print[moms];
{0.04918032786885247, 0.005260932876133214, 0.0009181867601560783}
>>> corr = LagCorrelationsFromMAP[D0, D1, 1][[1]];
>>> Print[corr];
0.02241571110398602
>>> {D0, D1} = MAP2FromMoments[moms, corr];
>>> Print[D0];
{{-13.909830056250456, 9.199027971874015},
 {0, -25.090169943749302}}
>>> Print[D1];
{{4.710802084376442, 0},
 {2.8009720281259014, 22.2891979156234}}
>>> rmoms = MarginalMomentsFromMAP[D0, D1, 3];
>>> Print[rmoms];
{0.04918032786885251, 0.005260932876133218, 0.0009181867601560789}
>>> rcorr = LagCorrelationsFromMAP[D0, D1, 1][[1]];
>>> Print[rcorr];
0.022415711103985703
"=== MAP2CorrelationBounds ==="
>>> D0 = {{-14., 1.},{1., -25.}};
>>> D1 = {{6., 7.},{3., 21.}};
>>> moms = MarginalMomentsFromMAP[D0, D1, 3];
>>> Print[moms];
{0.04918032786885247, 0.005260932876133214, 0.0009181867601560783}
>>> {lb, ub} = MAP2CorrelationBounds[moms];
>>> Print[lb];
-0.030588145972596268
>>> Print[ub];
0.0745055540503923
"=== MAPFromFewMomentsAndCorrelations ==="
>>> moms = {1.1, 6.05};
>>> corr1 = -0.17;
>>> {D0, D1} = MAPFromFewMomentsAndCorrelations[moms, corr1];
>>> Print[D0];
{{-0.28493894165535966, 0.28493894165535966, 0, 0},
 {0., -18.13383801258688, 0, 0},
 {0, 0, -0.2849389416553596, 0.2849389416553596},
 {0, 0, 0., -0.9570710783221891}}
>>> Print[D1];
{{0., 0., 0., 0.},
 {0.022795115332428794, 1.4279119256745232, 4.966897224470778, 11.71623374710915},
 {0., 0., 0., 0.},
 {0.013835475664900425, 0.8666699163915135, 0.022795115332428787, 0.053770570933346404}}
>>> rmoms = MarginalMomentsFromMAP[D0, D1, 2];
>>> Print[rmoms];
{1.0999999999999996, 6.049999999999997}
>>> rcorr1 = LagCorrelationsFromMAP[D0, D1, 1][[1]];
>>> Print[rcorr1];
-0.16999999999999998
>>> moms = {1.2, 4.32, 20.};
>>> corr1 = -0.4;
>>> {D0, D1} = MAPFromFewMomentsAndCorrelations[moms, corr1];
>>> Print[D0];
{{-0.3360418695910829, 0.3360418695910829, 0, 0, 0, 0},
 {0, -36.0266728289002, 0, 0, 0, 0},
 {0, 0, -1.2828628105692446, 1.2828628105692446, 0, 0},
 {0, 0, 0, -1.2828628105692446, 1.2828628105692446, 0},
 {0, 0, 0, 0, -1.2828628105692446, 1.2828628105692446},
 {0, 0, 0, 0, 0, -1.3747185152915538}}
>>> Print[D1];
{{0., 0., 0., 0., 0., 0.},
 {0.024740745552158373, 1.7765928958928536, 23.47455308878542, 0., 0., 10.750786098669774},
 {0., 0., 0., 0., 0., 0.},
 {0., 0., 0., 0., 0., 0.},
 {0., 0., 0., 0., 0., 0.},
 {0.017937256152678223, 1.2880453333742978, 0.04714475230266865, 0., 0., 0.021591173461909096}}
>>> BuTools`CheckPrecision = 10.^-12;
>>> rmoms = MarginalMomentsFromMAP[D0, D1, 3];
>>> Print[rmoms];
{1.2, 4.319999999999999, 20.00000000000002}
>>> rcorr1 = LagCorrelationsFromMAP[D0, D1, 1][[1]];
>>> Print[rcorr1];
-0.4
>>> moms = {1.2, 4.32, 20.};
>>> corr1 = 0.4;
>>> {D0, D1} = MAPFromFewMomentsAndCorrelations[moms, corr1];
>>> Print[D0];
{{-0.5418383137500514, 0.5418383137500514, 0, 0, 0, 0, 0, 0, 0},
 {0, -116.33647358652203, 0, 0, 0, 0, 0, 0, 0},
 {0, 0, -0.24417076816625743, 0.24417076816625743, 0, 0, 0, 0, 0},
 {0, 0, 0, -2.0140275715489198, 2.0140275715489198, 0, 0, 0, 0},
 {0, 0, 0, 0, -2.0140275715489198, 2.0140275715489198, 0, 0, 0},
 {0, 0, 0, 0, 0, -2.0140275715489198, 2.0140275715489198, 0, 0},
 {0, 0, 0, 0, 0, 0, -2.0140275715489198, 2.0140275715489198, 0},
 {0, 0, 0, 0, 0, 0, 0, -2.0140275715489198, 2.0140275715489198},
 {0, 0, 0, 0, 0, 0, 0, 0, -2.0140275715489198}}
>>> Print[D1];
{{0., 0., 0., 0., 0., 0., 0., 0., 0.},
 {16.128313181474883, 88.57451304639496, 0.0997738996285687, 11.533873459023635, 0., 0., 0., 0., 0.},
 {0., 0., 0., 0., 0., 0., 0., 0., 0.},
 {0., 0., 0., 0., 0., 0., 0., 0., 0.},
 {0., 0., 0., 0., 0., 0., 0., 0., 0.},
 {0., 0., 0., 0., 0., 0., 0., 0., 0.},
 {0., 0., 0., 0., 0., 0., 0., 0., 0.},
 {0., 0., 0., 0., 0., 0., 0., 0., 0.},
 {0.062047737583266864, 0.3407577767265171, 0.013818358324120445, 1.5974036989150155, 0., 0., 0., 0., 0.}}
>>> rmoms = MarginalMomentsFromMAP[D0, D1, 3];
>>> Print[rmoms];
{1.2000000000000002, 4.320000000000002, 19.999999999999577}
>>> rcorr1 = LagCorrelationsFromMAP[D0, D1, 1][[1]];
>>> Print[rcorr1];
0.40000000000000063
"=== CanonicalFromMAP2 ==="
>>> D0 = {{-14., 1.},{1., -25.}};
>>> D1 = {{6., 7.},{3., 21.}};
>>> {H0, H1} = CanonicalFromMAP2[D0, D1];
>>> Print[H0];
{{-13.909830056250456, 9.199027971874015},
 {0, -25.090169943749302}}
>>> Print[H1];
{{4.710802084376442, 0},
 {2.8009720281259014, 22.2891979156234}}
>>> Cm = SimilarityMatrix[H0, D0];
>>> err1 = Norm[H0.Cm-Cm.D0];
>>> err2 = Norm[H1.Cm-Cm.D1];
>>> Print[Max[err1, err2]];
2.39754619495158*^-13
"=== MAPFromRAP ==="
>>> D0 = {{-2., 2.},{2., -9.}};
>>> D1 = {{-2., 2.},{3., 4.}};
>>> {H0, H1} = MAPFromRAP[D0, D1];
>>> Print[H0];
{{-1.469865108524213, -0.18513639022235387},
 {-0.04328028919559579, -9.530134891475761}}
>>> Print[H1];
{{-0.1851363902223537, 1.8401378889689204},
 {7.388278790449017, 2.185136390222349}}
>>> err = Norm[LagkJointMomentsFromRAP[D0, D1, 3, 1]-LagkJointMomentsFromRAP[H0, H1, 3, 1]];
>>> Print[err];
3.31611301558491*^-15
>>> D0 = {{-2.4, 2.},{2., -9.}};
>>> D1 = {{-1.6, 2.},{3., 4.}};
>>> {H0, H1} = MAPFromRAP[D0, D1];
>>> Print[H0];
{{-1.8413725353422619, 0.07946777343749967},
 {0.012509334866139282, -9.558627464657736}}
>>> Print[H1];
{{0.02450852167038682, 1.7373962402343748},
 {7.170626651461986, 2.3754914783296126}}
>>> err = Norm[LagkJointMomentsFromRAP[D0, D1, 3, 1]-LagkJointMomentsFromRAP[H0, H1, 3, 1]];
>>> Print[err];
7.665251615940028*^-16
"=== MMAPFromMRAP ==="
>>> x = 0.18;
>>> H0 = {{-5., 0.1+x, 0.9, 1.},{1., -8., 0.9, 0.1},{0.9, 0.1, -4., 1.},{1., 2., 3., -9.}};
>>> H1 = {{0.1-x, 0.7, 0.1, 0.1},{0.1, 1., 1.8, 0.1},{0.1, 0.1, 0.1, 0.7},{0.7, 0.1, 0.1, 0.1}};
>>> H2 = {{0.1, 0.1, 0.1, 1.7},{1.8, 0.1, 1., 0.1},{0.1, 0.1, 0.7, 0.1},{0.1, 1., 0.1, 0.8}};
>>> H = {H0, H1, H2};
>>> moms = MarginalMomentsFromMRAP[H];
>>> Print[moms];
{0.33950747762450084, 0.2458255719823656, 0.2742374276605113, 0.4120601813350093, 0.7767718404933559, 1.7594286078546524, 4.651534763161781}
>>> jmom = LagkJointMomentsFromMRAP[H, 3, 1];
>>> G = MMAPFromMRAP[H];
>>> Print[G[[1]]];
{{-4.631096923246836, 0.1767431722689076, 0.8556401694342012, 0.9296874999999999},
 {1.089926373504154, -8.018189880952379, 0.6717986882242408, 0.03718750000000001},
 {1.2591506958007814, 0.0390625, -4.2279006958007805, 0.9296875},
 {0.8562506287479182, 2.047180907362945, 3.0030799771240595, -9.122812499999998}}
>>> Print[G[[2]]];
{{0.013161771259610652, 0.5411755660597573, 0.10313314003824185, 0.19567013888888887},
 {0.2175499987728381, 0.9560645171957671, 1.8821030700102306, 0.08801828703703704},
 {0.23379669189453123, 0.055468750000000004, 0.059953308105468756, 0.65078125},
 {0.9628872413087414, 0.065679065237206, 0.03031780115268766, 0.09082040343915343}}
>>> Print[G[[3]]];
{{0.33919587344215035, 0.01689127178649242, 0.15319994043895765, 1.3065983796296292},
 {2.3528665610661585, 0.09333804012345678, 0.6223335271172633, 0.007003317901234591},
 {0.14414825439453127, 0.08828125, 0.6746017456054687, 0.09296875},
 {0.4195116361795369, 0.9664386522201472, 0.08778184639867956, 0.5928643408289241}}
>>> rmoms = MarginalMomentsFromMMAP[G];
>>> Print[rmoms];
{0.33950747762450095, 0.24582557198236582, 0.2742374276605117, 0.41206018133501016, 0.7767718404933577, 1.7594286078546573, 4.651534763161796}
>>> rjmom = LagkJointMomentsFromMMAP[G, 3, 1];
>>> err = Norm[rjmom[[1]]-jmom[[1]]]+Norm[rjmom[[2]]-jmom[[2]]];
>>> Print[err];
1.1623659668586761*^-15
"=== MinimalRepFromRAP ==="
>>> D0 = {{-5., 1., 0},{3., -3., 0},{1., 1., -5.}};
>>> D1 = {{0, 0, 4.},{0, 0, 0},{1., 1., 1.}};
>>> {H0, H1} = MinimalRepFromRAP[D0, D1, "cont"];
>>> Print[H0];
{{-5., 1., 0.},
 {3., -3., 0.},
 {1., 1., -5.}}
>>> Print[H1];
{{0., 0., 4.},
 {0., 0., 0.},
 {1., 1., 1.}}
>>> Cm = SimilarityMatrix[H0, D0];
>>> err1 = Norm[H0.Cm-Cm.D0];
>>> err2 = Norm[H1.Cm-Cm.D1];
>>> Print[Max[err1, err2]];
4.286666800451802*^-15
>>> {H0, H1} = MinimalRepFromRAP[D0, D1, "obs"];
>>> Print[H0];
{{-4.407407407407407, 1.6931216931216935},
 {0.8425925925925922, -2.592592592592593}}
>>> Print[H1];
{{2.0370370370370363, 0.6772486772486779},
 {2.7870370370370363, -1.0370370370370368}}
>>> Cm = SimilarityMatrix[H0, D0];
>>> err1 = Norm[H0.Cm-Cm.D0];
>>> err2 = Norm[H1.Cm-Cm.D1];
>>> Print[Max[err1, err2]];
8.396702586553632*^-15
>>> {H0, H1} = MinimalRepFromRAP[D0, D1, "obscont"];
>>> Print[H0];
{{-4.407407407407407, 1.6931216931216935},
 {0.8425925925925922, -2.592592592592593}}
>>> Print[H1];
{{2.0370370370370363, 0.6772486772486779},
 {2.7870370370370363, -1.0370370370370368}}
>>> Cm = SimilarityMatrix[H0, D0];
>>> err1 = Norm[H0.Cm-Cm.D0];
>>> err2 = Norm[H1.Cm-Cm.D1];
>>> Print[Max[err1, err2]];
8.396702586553632*^-15
"=== MinimalRepFromMRAP ==="
>>> D0 = {{-5., 1., 0},{3., -3., 0},{1., 1., -5.}};
>>> D1 = {{0, 0, 0.8},{0, 0, 0},{0.2, 0.2, 0.2}};
>>> D2 = {{0, 0, 3.2},{0, 0, 0},{0.8, 0.8, 0.8}};
>>> Dm = {D0, D1, D2};
>>> H = MinimalRepFromMRAP[Dm, "cont"];
>>> Print[H[[1]]];
{{-5., 1., 0.},
 {3., -3., 0.},
 {1., 1., -5.}}
>>> Print[H[[2]]];
{{0., 0., 0.8},
 {0., 0., 0.},
 {0.2, 0.2, 0.2}}
>>> Print[H[[3]]];
{{0., 0., 3.2},
 {0., 0., 0.},
 {0.8, 0.8, 0.8}}
>>> Cm = SimilarityMatrix[H[[1]], Dm[[1]]];
>>> err = Norm[H[[1]].Cm-Cm.Dm[[1]]]+Norm[H[[2]].Cm-Cm.Dm[[2]]]+Norm[H[[3]].Cm-Cm.Dm[[3]]];
>>> Print[err];
5.717834399042951*^-15
>>> H = MinimalRepFromMRAP[Dm, "obs"];
>>> Print[H[[1]]];
{{-4.407407407407407, 1.6931216931216932},
 {0.8425925925925922, -2.592592592592593}}
>>> Print[H[[2]]];
{{0.40740740740740733, 0.13544973544973554},
 {0.5574074074074076, -0.20740740740740737}}
>>> Print[H[[3]]];
{{1.6296296296296293, 0.5417989417989422},
 {2.2296296296296303, -0.8296296296296295}}
>>> Cm = SimilarityMatrix[H[[1]], Dm[[1]]];
>>> err = Norm[H[[1]].Cm-Cm.Dm[[1]]]+Norm[H[[2]].Cm-Cm.Dm[[2]]]+Norm[H[[3]].Cm-Cm.Dm[[3]]];
>>> Print[err];
8.2600373258031*^-15
>>> H = MinimalRepFromMRAP[Dm, "obscont"];
>>> Print[H[[1]]];
{{-4.407407407407407, 1.6931216931216932},
 {0.8425925925925922, -2.592592592592593}}
>>> Print[H[[2]]];
{{0.40740740740740733, 0.13544973544973554},
 {0.5574074074074076, -0.20740740740740737}}
>>> Print[H[[3]]];
{{1.6296296296296293, 0.5417989417989422},
 {2.2296296296296303, -0.8296296296296295}}
>>> Cm = SimilarityMatrix[H[[1]], Dm[[1]]];
>>> err = Norm[H[[1]].Cm-Cm.Dm[[1]]]+Norm[H[[2]].Cm-Cm.Dm[[2]]]+Norm[H[[3]].Cm-Cm.Dm[[3]]];
>>> Print[err];
8.2600373258031*^-15
"=== SamplesFromMAP ==="
>>> D0 = {{-0.17, 0, 0, 0.07},{0.01, -0.78, 0.03, 0.08},{0.22, 0.17, -1.1, 0.02},{0.04, 0.12, 0, -0.42}};
>>> D1 = {{0, 0.06, 0, 0.04},{0.04, 0.19, 0.21, 0.22},{0.22, 0.13, 0.15, 0.19},{0.05, 0, 0.17, 0.04}};
>>> x = SamplesFromMAP[D0, D1, 10000];
>>> mt = MarginalMomentsFromTrace[x, 3];
>>> Print[mt];
{3.3718719889533686, 32.5716366965651, 550.1144972948015}
>>> mm = MarginalMomentsFromMAP[D0, D1, 3];
>>> Print[mm];
{3.44334737542053, 34.03035343496073, 592.0769859317294}
"=== SamplesFromMMAP ==="
>>> D0 = {{-1.78, 0.29},{0.07, -0.92}};
>>> D1 = {{0.15, 0.49},{0.23, 0.36}};
>>> D2 = {{0.11, 0.2},{0.01, 0}};
>>> D3 = {{0.14, 0.4},{0.11, 0.14}};
>>> Dm = {D0, D1, D2, D3};
>>> x = SamplesFromMMAP[Dm, 10000];
>>> mt = MarginalMomentsFromTrace[x[[1;;-1, 1]], 3];
>>> Print[mt];
{0.9922207868979519, 2.0916288580876965, 7.085666983629913}
>>> mm = MarginalMomentsFromMMAP[Dm, 3];
>>> Print[mm];
{1.000667111407605, 2.1044966311760755, 6.827688149434602}
