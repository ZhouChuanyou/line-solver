<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of pfqn_panacea</title>
  <meta name="keywords" content="pfqn_panacea">
  <meta name="description" content="K = population vector">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="#">src</a> &gt; <a href="../../index.html">solvers</a> &gt; <a href="../index.html">NC</a> &gt; <a href="index.html">lib</a> &gt; pfqn_panacea.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for src\solvers\NC\lib&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>pfqn_panacea
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>K = population vector</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function [Gn,lGn]=pfqn_pnc(L,K,Z) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> K = population vector</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="pfqn_ca.html" class="code" title="function [Gn,lGn]=pfqn_ca(L,N,Z)">pfqn_ca</a>	PFQN_CA Exact solution of closed product-form queueing networks by the</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="pfqn_nc.html" class="code" title="function [lGn] = pfqn_nc(L,N,Z,varargin)">pfqn_nc</a>	</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [Gn,lGn]=pfqn_pnc(L,K,Z)</a>
0002 <span class="comment">% K = population vector</span>
0003 [q,p]=size(L);
0004 <span class="keyword">if</span> nargin==2 || isempty(Z)
0005     Z=K*0+1e-8; 
0006 <span class="keyword">end</span>
0007 <span class="keyword">if</span> isempty(L) | sum(L,1)==zeros(1,p)
0008     lGn = - sum(factln(K)) + sum(K.*log(sum(Z,1)));
0009     Gn=exp(lGn);
0010     <span class="keyword">return</span>
0011 <span class="keyword">end</span>
0012 r = L./repmat(Z,q,1);
0013 N = max(1./r(:));
0014 beta = K/N;
0015 gamma = r * N;
0016 alpha = 1-K*r';
0017 gammatilde = gamma ./ repmat(alpha',1,p);
0018 <span class="keyword">if</span> min(alpha)&lt;0
0019 <span class="comment">%    warning('Model is not in normal usage');</span>
0020     Gn=NaN;
0021     lGn=NaN;
0022     <span class="keyword">return</span>
0023 <span class="keyword">end</span>
0024 
0025 A0 = 1;
0026 A1 = 0;
0027 <span class="keyword">for</span> j=1:p
0028     m = zeros(1,p); m(j)=2;
0029     A1 = A1 -beta(j) * <a href="pfqn_ca.html" class="code" title="function [Gn,lGn]=pfqn_ca(L,N,Z)">pfqn_ca</a>(gammatilde,m);
0030 <span class="keyword">end</span>
0031 
0032 A2 = 0;
0033 <span class="keyword">for</span> j=1:p
0034     m = zeros(1,p); m(j)=3;
0035     A2 = A2 + 2 * beta(j) * <a href="pfqn_ca.html" class="code" title="function [Gn,lGn]=pfqn_ca(L,N,Z)">pfqn_ca</a>(gammatilde,m);
0036     m = zeros(1,p); m(j)=4;
0037     A2 = A2 + 3 * beta(j)^2 * <a href="pfqn_ca.html" class="code" title="function [Gn,lGn]=pfqn_ca(L,N,Z)">pfqn_ca</a>(gammatilde,m);
0038     <span class="keyword">for</span> k=setdiff(1:p,j)
0039         m = zeros(1,p); m(j)=2; m(k)=2;
0040         A2 = A2 + 0.5 * beta(j) * beta(k) * <a href="pfqn_ca.html" class="code" title="function [Gn,lGn]=pfqn_ca(L,N,Z)">pfqn_ca</a>(gammatilde,m);
0041     <span class="keyword">end</span>
0042 <span class="keyword">end</span>
0043 
0044 <span class="keyword">if</span> 0
0045     A3 = 0;
0046     <span class="keyword">for</span> j=1:p
0047         m = zeros(1,p); m(j)=4;
0048         A3 = A3 - 6 * beta(j) * <a href="pfqn_ca.html" class="code" title="function [Gn,lGn]=pfqn_ca(L,N,Z)">pfqn_ca</a>(gammatilde,m);
0049         m = zeros(1,p); m(j)=5;
0050         A3 = A3 - 20 * beta(j)^2 * <a href="pfqn_ca.html" class="code" title="function [Gn,lGn]=pfqn_ca(L,N,Z)">pfqn_ca</a>(gammatilde,m);
0051         m = zeros(1,p); m(j)=6;
0052         A3 = A3 - 15 * beta(j)^3 * <a href="pfqn_ca.html" class="code" title="function [Gn,lGn]=pfqn_ca(L,N,Z)">pfqn_ca</a>(gammatilde,m);
0053         <span class="keyword">for</span> k=setdiff(1:p,j)
0054             m = zeros(1,p); m(j)=4; m(k)=2;
0055             A3 = A3 - 2 * beta(j) * beta(k) * <a href="pfqn_ca.html" class="code" title="function [Gn,lGn]=pfqn_ca(L,N,Z)">pfqn_ca</a>(gammatilde,m);
0056             m = zeros(1,p); m(j)=2; m(k)=3;
0057             A3 = A3 - 3 * beta(j)^2 * beta(k) * <a href="pfqn_ca.html" class="code" title="function [Gn,lGn]=pfqn_ca(L,N,Z)">pfqn_ca</a>(gammatilde,m);
0058             <span class="keyword">for</span> l=setdiff(1:p,[j,k])
0059                 m = zeros(1,p); m(j)=2; m(k)=2; m(l)=2;
0060                 A3 = A3 - (1/6) * beta(j) * beta(k) * beta(l) * <a href="pfqn_ca.html" class="code" title="function [Gn,lGn]=pfqn_ca(L,N,Z)">pfqn_ca</a>(gammatilde,m);
0061             <span class="keyword">end</span>
0062         <span class="keyword">end</span>
0063     <span class="keyword">end</span>
0064 <span class="keyword">end</span>
0065 I = [A0, A1/N, A2/N^2];<span class="comment">%, A3/N^3*0];</span>
0066 
0067 lGn = - sum(factln(K)) + sum(K.*log(sum(Z,1))) + log(sum(I)) - sum(log(alpha));
0068 Gn = prod(Z.^K) / prod(factorial(K)) * sum(I) / prod(alpha);
0069 <span class="keyword">if</span> ~isfinite(lGn)
0070     Gn=NaN;
0071     lGn=NaN;
0072 <span class="keyword">end</span>
0073 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Tue 19-Mar-2019 19:15:18 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>