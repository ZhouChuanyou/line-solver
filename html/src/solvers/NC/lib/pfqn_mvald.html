<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of pfqn_mvald</title>
  <meta name="keywords" content="pfqn_mvald">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="#">src</a> &gt; <a href="../../index.html">solvers</a> &gt; <a href="../index.html">NC</a> &gt; <a href="index.html">lib</a> &gt; pfqn_mvald.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for src\solvers\NC\lib&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>pfqn_mvald
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function [XN,QN,UN,CN,lGN]=pfqn_mvald(L,N,Z,mu) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function i=hashpop(n,N)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [XN,QN,UN,CN,lGN]=pfqn_mvald(L,N,Z,mu)</a>
0002 [M,R]=size(L); <span class="comment">% get number of queues (M) and classes (R)</span>
0003 Xs=zeros(R,prod(N+1)); <span class="comment">% throughput for a model with station i less</span>
0004 pi=ones(M,sum(N)+1,prod(N+1)); <span class="comment">% marginal queue-length probabilities pi(k)</span>
0005 WN=zeros(M,R);
0006 n=pprod(N); <span class="comment">% initialize the current population</span>
0007 lGN = 0;
0008 <span class="keyword">while</span> n~=-1
0009     WN=0*WN;
0010     <span class="keyword">for</span> s=1:R
0011         <span class="keyword">if</span> n(s)&gt;0
0012             <span class="keyword">for</span> i=1:M
0013                 WN(i,s)=0;
0014                 <span class="keyword">for</span> k=1:sum(n)
0015                     WN(i,s)=WN(i,s)+(L(i,s)/mu(i,k))*k*pi(i,(k-1)+1,<a href="#_sub1" class="code" title="subfunction i=hashpop(n,N)">hashpop</a>(oner(n,s),N));
0016                 <span class="keyword">end</span>
0017             <span class="keyword">end</span>
0018             Xs(s,<a href="#_sub1" class="code" title="subfunction i=hashpop(n,N)">hashpop</a>(n,N))=n(s)/(Z(s)+sum(WN(:,s)));
0019         <span class="keyword">end</span>
0020     <span class="keyword">end</span>
0021     
0022     <span class="comment">% compute pi(k|n)</span>
0023     <span class="keyword">for</span> k=1:sum(n)
0024         <span class="keyword">for</span> i=1:M
0025             pi(i,(k)+1,<a href="#_sub1" class="code" title="subfunction i=hashpop(n,N)">hashpop</a>(n,N))=0;
0026         <span class="keyword">end</span>
0027         <span class="keyword">for</span> s=1:R
0028             <span class="keyword">if</span> n(s)&gt;0
0029                 <span class="keyword">for</span> i=1:M
0030                     pi(i,(k)+1,<a href="#_sub1" class="code" title="subfunction i=hashpop(n,N)">hashpop</a>(n,N)) = pi(i,(k)+1,<a href="#_sub1" class="code" title="subfunction i=hashpop(n,N)">hashpop</a>(n,N)) + (L(i,s)/mu(i,k))*Xs(s,<a href="#_sub1" class="code" title="subfunction i=hashpop(n,N)">hashpop</a>(n,N))*pi(i,(k-1)+1,<a href="#_sub1" class="code" title="subfunction i=hashpop(n,N)">hashpop</a>(oner(n,s),N));
0031                 <span class="keyword">end</span>
0032             <span class="keyword">end</span>
0033         <span class="keyword">end</span>
0034     <span class="keyword">end</span>
0035     
0036     <span class="comment">% compute pi(0|n)</span>
0037     <span class="keyword">for</span> i=1:M
0038         pi(i,(0)+1,<a href="#_sub1" class="code" title="subfunction i=hashpop(n,N)">hashpop</a>(n,N))=1-sum(pi(i,(1:sum(n))+1,<a href="#_sub1" class="code" title="subfunction i=hashpop(n,N)">hashpop</a>(n,N)));
0039     <span class="keyword">end</span>
0040     
0041     
0042     last_nnz = max(find(n&gt;0));
0043     <span class="keyword">if</span> sum(n(1:last_nnz-1)) == sum(N(1:last_nnz-1)) &amp; sum(n((last_nnz+1):R))==0                
0044         logX = log(Xs(last_nnz,<a href="#_sub1" class="code" title="subfunction i=hashpop(n,N)">hashpop</a>(n,N)));
0045         <span class="keyword">if</span> ~isempty(logX)
0046             lGN = lGN - logX;
0047         <span class="keyword">end</span>
0048     <span class="keyword">end</span>
0049     
0050     n=pprod(n,N); <span class="comment">% get the next population</span>
0051 <span class="keyword">end</span>
0052 X=Xs(:,<a href="#_sub1" class="code" title="subfunction i=hashpop(n,N)">hashpop</a>(N,N));
0053 XN=X';
0054 <span class="comment">%pi=pi(:,:,hashpop(N,N));</span>
0055 QN = WN./repmat(XN,M,1);
0056 UN = repmat(XN,M,1) .* L;
0057 CN = N./XN; <span class="comment">% cycle time inclusive of think time</span>
0058 <span class="keyword">end</span>
0059 
0060 <a name="_sub1" href="#_subfunctions" class="code">function i=hashpop(n,N)</a>
0061 i=1; <span class="comment">% index of the empty population</span>
0062 <span class="keyword">for</span> r=1:length(N)
0063     i=i+prod(N(1:r-1)+1)*n(r);
0064 <span class="keyword">end</span>
0065 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Tue 19-Mar-2019 19:15:18 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>