<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of Cox2</title>
  <meta name="keywords" content="Cox2">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">src</a> &gt; <a href="../index.html">lang</a> &gt; <a href="index.html">distributions</a> &gt; Cox2.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for src\lang\distributions&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>Cox2
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="Cox2.html" class="code" title="">Cox2</a>	</li><li><a href="Exp.html" class="code" title="">Exp</a>	</li><li><a href="PhaseType.html" class="code" title="">PhaseType</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="Cox2.html" class="code" title="">Cox2</a>	</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function self = Cox2(mu1, mu2, phi1)</a></li><li><a href="#_sub2" class="code">function phases = getNumberOfPhases(self)</a></li><li><a href="#_sub3" class="code">function ex = getMean(self)</a></li><li><a href="#_sub4" class="code">function SCV = getSCV(self)</a></li><li><a href="#_sub5" class="code">function Ft = evalCDF(self, t)</a></li><li><a href="#_sub6" class="code">function PH = getRenewalProcess(self)</a></li><li><a href="#_sub7" class="code">function cx = fit(MEAN,SCV)</a></li><li><a href="#_sub8" class="code">function cx = fitMeanAndSCV(MEAN, SCV)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 classdef <a href="Cox2.html" class="code" title="">Cox2</a> &lt; <a href="PhaseType.html" class="code" title="">PhaseType</a>
0002     <span class="comment">% Copyright (c) 2012-Present, Imperial College London</span>
0003     <span class="comment">% All rights reserved.</span>
0004     
0005     methods
0006         <span class="comment">%Constructor</span>
0007         <a name="_sub0" href="#_subfunctions" class="code">function self = Cox2(mu1, mu2, phi1)</a>
0008             self = self@<a href="PhaseType.html" class="code" title="">PhaseType</a>(<span class="string">'Coxian'</span>,3);
0009             setParam(self, 1, <span class="string">'lambda0'</span>, mu1, <span class="string">'java.lang.Double'</span>);
0010             setParam(self, 2, <span class="string">'lambda1'</span>, mu2, <span class="string">'java.lang.Double'</span>);
0011             setParam(self, 3, <span class="string">'phi0'</span>, phi1, <span class="string">'java.lang.Double'</span>); <span class="comment">% completion probability in phase 1</span>
0012             self.javaClass = <span class="string">'jmt.engine.random.CoxianDistr'</span>;
0013             self.javaParClass = <span class="string">'jmt.engine.random.CoxianPar'</span>;
0014         <span class="keyword">end</span>
0015         
0016         <a name="_sub1" href="#_subfunctions" class="code">function phases = getNumberOfPhases(self)</a>
0017             phases  = 2; <span class="comment">%r</span>
0018         <span class="keyword">end</span>
0019         
0020         <a name="_sub2" href="#_subfunctions" class="code">function ex = getMean(self)</a>
0021             mu1 = self.getParam(1).paramValue;
0022             mu2 = self.getParam(2).paramValue;
0023             phi1 = self.getParam(3).paramValue;
0024             ex = 1/mu1 + (1-phi1)/mu2;
0025         <span class="keyword">end</span>
0026         
0027         <a name="_sub3" href="#_subfunctions" class="code">function SCV = getSCV(self)</a>
0028             mu1 = self.getParam(1).paramValue;
0029             mu2 = self.getParam(2).paramValue;
0030             phi1 = self.getParam(3).paramValue;
0031             mean = 1/mu1 + (1-phi1)/mu2;
0032             var = ((2*mu2*(mu1 - mu1*phi1))/(mu1 + mu2 - mu1*phi1) + (2*mu1*mu2*phi1)/(mu1 + mu2 - mu1*phi1))/(mu1*mu1*((mu2*(mu1 - mu1*phi1))/(mu1 + mu2 - mu1*phi1) + (mu1*mu2*phi1)/(mu1 + mu2 - mu1*phi1))) - (1/mu1 - (phi1 - 1)/mu2)*(1/mu1 - (phi1 - 1)/mu2) - (((phi1 - 1)/(mu2*mu2) + (phi1 - 1)/(mu1*mu2))*((2*mu2*(mu1 - mu1*phi1))/(mu1 + mu2 - mu1*phi1) + (2*mu1*mu2*phi1)/(mu1 + mu2 - mu1*phi1)))/((mu2*(mu1 - mu1*phi1))/(mu1 + mu2 - mu1*phi1) + (mu1*mu2*phi1)/(mu1 + mu2 - mu1*phi1));
0033             SCV = var / mean^2;
0034         <span class="keyword">end</span>
0035                 
0036         <a name="_sub4" href="#_subfunctions" class="code">function Ft = evalCDF(self, t)</a>
0037             mu1 = self.getParam(1).paramValue;
0038             mu2 = self.getParam(2).paramValue;
0039             phi1 = self.getParam(3).paramValue;
0040             Ft = 1- exp(-mu1*t)-(mu1.*(exp(-t*mu1) - exp(-t*(mu2))).*(1-phi1))./(mu2 - mu1);
0041         <span class="keyword">end</span>
0042         
0043         <a name="_sub5" href="#_subfunctions" class="code">function PH = getRenewalProcess(self)</a>
0044             mu1 = self.getParam(1).paramValue;
0045             mu2 = self.getParam(2).paramValue;
0046             phi1 = self.getParam(3).paramValue;
0047             PH={[-mu1,(1-phi1)*mu1;0,-mu2],[phi1*mu1,0;mu2,0]};
0048         <span class="keyword">end</span>
0049         
0050     <span class="keyword">end</span>
0051     
0052     methods(Static)
0053         <a name="_sub6" href="#_subfunctions" class="code">function cx = fit(MEAN,SCV)</a>
0054             cx = Cox2.fitMeanAndSCV(MEAN,SCV);
0055         <span class="keyword">end</span>
0056         
0057         <a name="_sub7" href="#_subfunctions" class="code">function cx = fitMeanAndSCV(MEAN, SCV)</a>
0058             <span class="keyword">if</span> (SCV &lt;1 &amp;&amp; SCV &gt;=0.5)
0059                 p = 0.0;
0060                 l0 = 2/MEAN/(1+sqrt(1+2*(SCV-1)));
0061                 l1 = 2/MEAN/(1-sqrt(1+2*(SCV-1)));
0062             <span class="keyword">elseif</span> (SCV == 1.0)
0063                 p = 1.0;
0064                 l0 = 1/MEAN;
0065                 l1 = 1/MEAN;
0066                 cx = <a href="Exp.html" class="code" title="">Exp</a>(1/MEAN);
0067                 <span class="keyword">return</span>;
0068             <span class="keyword">else</span>
0069                 l0 = 2/MEAN;
0070                 l1 = l0/(2*SCV);
0071                 p = 1 - l1/l0;
0072             <span class="keyword">end</span>
0073             cx = <a href="Cox2.html" class="code" title="">Cox2</a>(l0,l1,p);
0074         <span class="keyword">end</span>
0075         
0076     <span class="keyword">end</span>
0077     
0078 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Tue 19-Mar-2019 19:15:18 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>