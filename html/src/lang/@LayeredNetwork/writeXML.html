<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of writeXML</title>
  <meta name="keywords" content="writeXML">
  <meta name="description" content="Copyright (c) 2012-2019, Imperial College London">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../index.html">Home</a> &gt;  <a href="#">src</a> &gt; <a href="../index.html">lang</a> &gt; <a href="index.html">@LayeredNetwork</a> &gt; writeXML.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../index.html"><img alt="<" border="0" src="../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for src\lang\@LayeredNetwork&nbsp;<img alt=">" border="0" src="../../../right.png"></a></td></tr></table>-->

<h1>writeXML
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>Copyright (c) 2012-2019, Imperial College London</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function writeXML(self,filename) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Copyright (c) 2012-2019, Imperial College London
 All rights reserved.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="LayeredNetwork.html" class="code" title="">LayeredNetwork</a>	</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function writeXML(self,filename)</a>
0002 <span class="comment">% Copyright (c) 2012-2019, Imperial College London</span>
0003 <span class="comment">% All rights reserved.</span>
0004 import javax.xml.parsers.DocumentBuilderFactory;
0005 import javax.xml.parsers.DocumentBuilder;
0006 import org.w3c.dom.Document;
0007 import org.w3c.dom.NodeList;
0008 import org.w3c.dom.Node;
0009 import org.w3c.dom.Element;
0010 import java.io.File;
0011 import javax.xml.transform.Transformer;
0012 import javax.xml.transform.TransformerFactory;
0013 import javax.xml.transform.dom.DOMSource;
0014 import javax.xml.transform.stream.StreamResult;
0015 import javax.xml.transform.OutputKeys;
0016 
0017 precision = <span class="string">'%10.15e'</span>; <span class="comment">%precision for doubles</span>
0018 docFactory = DocumentBuilderFactory.newInstance();
0019 docBuilder = docFactory.newDocumentBuilder();
0020 doc = docBuilder.newDocument();
0021 
0022 <span class="comment">%Root Element</span>
0023 rootElement = doc.createElement(<span class="string">'lqn-model'</span>);
0024 doc.appendChild(rootElement);
0025 rootElement.setAttribute(<span class="string">'xmlns:xsi'</span>, <span class="string">'http://www.w3.org/2001/XMLSchema-instance'</span>);
0026 rootElement.setAttribute(<span class="string">'xsi:noNamespaceSchemaLocation'</span>, <span class="string">'lqn.xsd'</span>);
0027 rootElement.setAttribute(<span class="string">'name'</span>, self.getName());
0028 
0029 <span class="keyword">for</span> p = 1:length(self.processors)
0030     <span class="comment">%processor</span>
0031     curProc = self.processors(p);
0032     procElement = doc.createElement(<span class="string">'processor'</span>);
0033     rootElement.appendChild(procElement);
0034     procElement.setAttribute(<span class="string">'name'</span>, curProc.name);
0035     <span class="keyword">if</span> isfinite(curProc.multiplicity)
0036         procElement.setAttribute(<span class="string">'multiplicity'</span>, num2str(curProc.multiplicity));
0037     <span class="keyword">end</span>
0038     procElement.setAttribute(<span class="string">'scheduling'</span>, num2str(curProc.scheduling));
0039     <span class="keyword">if</span> ~isnan(curProc.quantum)
0040         procElement.setAttribute(<span class="string">'quantum'</span>, num2str(curProc.quantum));
0041     <span class="keyword">end</span>
0042     <span class="keyword">if</span> ~isnan(curProc.speedFactor)
0043         procElement.setAttribute(<span class="string">'speed-factor'</span>, num2str(curProc.speedFactor));
0044     <span class="keyword">end</span>
0045     <span class="keyword">for</span> t=1:length(curProc.tasks)
0046         curTask = self.processors(p).tasks(t);
0047         taskElement = doc.createElement(<span class="string">'task'</span>);
0048         procElement.appendChild(taskElement);
0049         taskElement.setAttribute(<span class="string">'name'</span>, curTask.name);
0050         taskElement.setAttribute(<span class="string">'scheduling'</span>, curTask.scheduling);
0051         <span class="keyword">if</span> isfinite(curTask.multiplicity)
0052         taskElement.setAttribute(<span class="string">'multiplicity'</span>, num2str(curTask.multiplicity));
0053         <span class="keyword">end</span>
0054         <span class="keyword">if</span> ~isnan(curTask.thinkTimeMean)
0055             taskElement.setAttribute(<span class="string">'think-time'</span>, num2str(curTask.thinkTimeMean));
0056         <span class="keyword">end</span>
0057         <span class="keyword">for</span> e=1:length(curTask.entries)
0058             curEntry = self.processors(p).tasks(t).entries(e);
0059             entryElement = doc.createElement(<span class="string">'entry'</span>);
0060             taskElement.appendChild(entryElement);
0061             entryElement.setAttribute(<span class="string">'name'</span>, curEntry.name);
0062             entryElement.setAttribute(<span class="string">'type'</span>, curEntry.type);
0063         <span class="keyword">end</span>
0064         taskActElement = doc.createElement(<span class="string">'task-activities'</span>);
0065         taskElement.appendChild(taskActElement);
0066         <span class="keyword">for</span> a=1:length(curTask.activities)
0067             curAct = self.processors(p).tasks(t).activities(a);
0068             actElement = doc.createElement(<span class="string">'activity'</span>);
0069             taskActElement.appendChild(actElement);
0070             actElement.setAttribute(<span class="string">'host-demand-mean'</span>, num2str(curAct.hostDemandMean));
0071             actElement.setAttribute(<span class="string">'host-demand-cvsq'</span>, num2str(curAct.hostDemandSCV));
0072             <span class="keyword">if</span> ~isempty(curAct.boundToEntry)
0073                 actElement.setAttribute(<span class="string">'bound-to-entry'</span>, curAct.boundToEntry);
0074             <span class="keyword">end</span>            
0075             actElement.setAttribute(<span class="string">'name'</span>, curAct.name);
0076             <span class="keyword">for</span> s=1:length(curAct.synchCallDests)
0077                 syncCallElement = doc.createElement(<span class="string">'synch-call'</span>);
0078                 actElement.appendChild(syncCallElement);
0079                 syncCallElement.setAttribute(<span class="string">'dest'</span>,curAct.synchCallDests(s));
0080                 syncCallElement.setAttribute(<span class="string">'calls-mean'</span>,num2str(curAct.synchCallMeans(s)));
0081             <span class="keyword">end</span>
0082         <span class="keyword">end</span>
0083         <span class="keyword">for</span> ap=1:length(curTask.precedences)
0084             actPrecedence = doc.createElement(<span class="string">'precedence'</span>);
0085             taskActElement.appendChild(actPrecedence);
0086             curActPrec = self.processors(p).tasks(t).precedences(ap);
0087 
0088             precPreElement = doc.createElement(<span class="string">'pre'</span>);
0089             actPrecedence.appendChild(precPreElement);
0090             precAct = doc.createElement(<span class="string">'activity'</span>);
0091             precAct.setAttribute(<span class="string">'name'</span>,curActPrec.pres{1});
0092             precPreElement.appendChild(precAct);                        
0093 
0094             precPostElement = doc.createElement(<span class="string">'post'</span>);
0095             actPrecedence.appendChild(precPostElement);
0096             precAct = doc.createElement(<span class="string">'activity'</span>);
0097             precAct.setAttribute(<span class="string">'name'</span>,curActPrec.posts{1});
0098             precPostElement.appendChild(precAct);                        
0099         <span class="keyword">end</span>
0100         <span class="keyword">for</span> e=1:length(curTask.entries)
0101             curEntry = self.processors(p).tasks(t).entries(e);
0102             <span class="keyword">if</span> ~isempty(curEntry.replyActivity)
0103                 entryReplyElement = doc.createElement(<span class="string">'reply-entry'</span>);
0104                 taskActElement.appendChild(entryReplyElement);
0105                 entryReplyElement.setAttribute(<span class="string">'name'</span>, curEntry.name);
0106                 <span class="keyword">for</span> r=1:length(curEntry.replyActivity)
0107                     entryReplyActElement = doc.createElement(<span class="string">'reply-activity'</span>);
0108                     entryReplyElement.appendChild(entryReplyActElement);
0109                     entryReplyActElement.setAttribute(<span class="string">'name'</span>, curEntry.replyActivity{r});
0110                 <span class="keyword">end</span>
0111             <span class="keyword">end</span>
0112         <span class="keyword">end</span>
0113     <span class="keyword">end</span>
0114 <span class="keyword">end</span>
0115 
0116 <span class="comment">%write the content into xml file</span>
0117 transformerFactory = TransformerFactory.newInstance();
0118 transformer = transformerFactory.newTransformer();
0119 transformer.setOutputProperty(OutputKeys.INDENT, <span class="string">'yes'</span>);
0120 source = DOMSource(doc);
0121 result =  StreamResult(File(filename));
0122 transformer.transform(source, result);
0123 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Tue 19-Mar-2019 14:07:48 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>